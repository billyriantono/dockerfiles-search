MetaArgs: null
Stages:
- BaseName: debian
  Commands:
  - Maintainer: danielguerra, https://github.com/danielguerra/packetbroker
    Name: maintainer
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - CmdLine:
    - apt-get -yq update && apt-get -yq upgrade && apt-get install -yq libnet-pcap-perl
      wget make gcc libmath-int64-perl supervisor xinetd && cd /tmp && wget http://search.cpan.org/CPAN/authors/id/M/MA/MARKELLIS/Net-AMQP-RabbitMQ-2.200000.tar.gz
      && tar xvfz Net-AMQP-RabbitMQ-2.200000.tar.gz && cd /tmp/Net-AMQP-RabbitMQ-2.200000
      && perl Makefile.PL && make && make install && apt-get remove -y make gcc &&
      apt-get -y autoremove && apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/*
      /var/tmp/*
    Name: run
    PrependShell: true
  - CmdLine:
    - 'echo "packetbroker             1969/tcp                        # pcap amqp
      feed" >> /etc/services'
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - supervisord.conf
    - /etc/supervisor/conf.d/supervisord.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - packetbroker
    - /etc/xinetd.d/packetbroker
  - Chown: ""
    Name: add
    SourcesAndDest:
    - initamqp
    - /bin/initamqp
  - Chown: ""
    Name: add
    SourcesAndDest:
    - pcap2amqp
    - /bin/pcap2amqp
  - Chown: ""
    Name: add
    SourcesAndDest:
    - broker
    - /bin/broker
  - Chown: ""
    Name: add
    SourcesAndDest:
    - amqp2pcap
    - /bin/amqp2pcap
  - Chown: ""
    Name: add
    SourcesAndDest:
    - consumer
    - /bin/consumer
  - Name: expose
    Ports:
    - "1969"
  - CmdLine:
    - /bin/bash
    Name: cmd
    PrependShell: false
  From:
    Image: debian
  Name: ""
  Platform: ""
  SourceCode: FROM debian
