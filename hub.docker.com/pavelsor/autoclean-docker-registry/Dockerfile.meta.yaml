MetaArgs: null
Stages:
- BaseName: ruby:2.5-alpine3.7
  Commands:
  - CmdLine:
    - set -ex     && apk add --no-cache ca-certificates apache2-utils supervisor
    Name: run
    PrependShell: true
  - CmdLine:
    - bundle config --global frozen 1
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./distribution-library-image/amd64/registry
    - /bin/registry
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./distribution-library-image/amd64/config-example.yml
    - /etc/docker/registry/config.yml
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./run_registry.sh
    - /run_registry.sh
  - CmdLine:
    - chmod +x /run_registry.sh
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - cleaner
    - /cleaner
  - Name: workdir
    Path: cleaner
  - CmdLine:
    - bundle install
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod +x cron.rb
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./supervisord.conf
    - /etc/supervisord.conf
  - Name: volume
    Volumes:
    - /var/lib/registry
  - Name: expose
    Ports:
    - "5000"
  - CmdLine:
    - supervisord
    - --nodaemon
    - --configuration
    - /etc/supervisord.conf
    Name: entrypoint
    PrependShell: false
  From:
    Image: ruby:2.5-alpine3.7
  Name: ""
  Platform: ""
  SourceCode: FROM ruby:2.5-alpine3.7
