MetaArgs: null
Stages:
- BaseName: php:5.6-apache
  Commands:
  - Maintainer: Olaxe
    Name: maintainer
  - Env:
    - Key: BOOKED_DL_URL
      Value: '"https://sourceforge.net/projects/phpscheduleit/files/Booked/2.7/booked-2.7.2.zip"'
    Name: env
  - Env:
    - Key: BOOKED_DL_FILE
      Value: '"booked-2.7.2.zip"'
    Name: env
  - Env:
    - Key: BOOKED_APP_TITLE
      Value: '"Booked Scheduler"'
    Name: env
  - Env:
    - Key: BOOKED_DEFAULT_TIMEZONE
      Value: '"Europe/Paris"'
    Name: env
  - Env:
    - Key: TZ
      Value: $BOOKED_DEFAULT_TIMEZONE
    Name: env
  - Env:
    - Key: BOOKED_ALLOW_SELF_REGISTRATION
      Value: '"true"'
    Name: env
  - Env:
    - Key: BOOKED_ADMIN_EMAIL
      Value: '"admin@example.com"'
    Name: env
  - Env:
    - Key: BOOKED_ADMIN_EMAIL_NAME
      Value: '"Booked Administrator"'
    Name: env
  - Env:
    - Key: BOOKED_DEFAULT_PAGE_SIZE
      Value: '"50"'
    Name: env
  - Env:
    - Key: BOOKED_ENABLE_EMAIL
      Value: '"true"'
    Name: env
  - Env:
    - Key: BOOKED_DEFAULT_LANGUAGE
      Value: '"en_us"'
    Name: env
  - Env:
    - Key: BOOKED_WEB_URL
      Value: '"http://localhost/Web"'
    Name: env
  - Env:
    - Key: BOOKED_DEFAULT_HOMEPAGE
      Value: '"1"'
    Name: env
  - Env:
    - Key: BOOKED_REGISTRATION_CAPTCHA_ENABLED
      Value: '"true"'
    Name: env
  - Env:
    - Key: BOOKED_REGISTRATION_REQUIRE_EMAIL_ACTIVATION
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_REGISTRATION_AUTO_SUBSCRIBE_EMAIL
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_REGISTRATION_NOTIFY_ADMIN
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_HOME_URL
      Value: '"$BOOKED_WEB_URL/dashboard.php"'
    Name: env
  - Env:
    - Key: BOOKED_SCHEDULE_USE_PER_USER_COLORS
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_SCHEDULE_SHOW_INACCESSIBLE_RESOURCES
      Value: '"true"'
    Name: env
  - Env:
    - Key: BOOKED_SCHEDULE_RESERVATION_LABEL
      Value: '"{name}"'
    Name: env
  - Env:
    - Key: BOOKED_SCHEDULE_HIDE_BLOCKED_PERIODS
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_ICS_SUBSCRIPTION_KEY
      Value: '""'
    Name: env
  - Env:
    - Key: BOOKED_PRIVACY_VIEW_SCHEDULES
      Value: '"true"'
    Name: env
  - Env:
    - Key: BOOKED_PRIVACY_VIEW_RESERVATIONS
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_PRIVACY_HIDE_USER_DETAILS
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_PRIVACY_HIDE_RESERVATION_DETAILS
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_PRIVACY_ALLOW_GUEST_RESERVATIONS
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_ENABLE_REMINDERS
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_ALLOW_GUEST_PARTICIPATION
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_ALLOW_WAIT_LIST
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_CHECKIN_MINUTES_PRIOR
      Value: '"5"'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_TITLE_REQUIRED
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_DESCRIPTION_REQUIRED
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_UPLOADS_ENABLE_RESERVATION_ATTACHMENTS
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_UPLOADS_RESERVATION_ATTACHMENT_PATH
      Value: '"uploads/reservation"'
    Name: env
  - Env:
    - Key: BOOKED_UPLOADS_RESERVATION_ATTACHMENT_EXTENSIONS
      Value: '"txt,jpg,gif,png,doc,docx,pdf,xls,xlsx,ppt,pptx,csv"'
    Name: env
  - Env:
    - Key: BOOKED_DATABASE_TYPE
      Value: '"mysql"'
    Name: env
  - Env:
    - Key: BOOKED_DATABASE_USER
      Value: '"booked_user"'
    Name: env
  - Env:
    - Key: BOOKED_DATABASE_PASSWORD
      Value: '"password"'
    Name: env
  - Env:
    - Key: BOOKED_DATABASE_HOSTSPEC
      Value: '"ttmysqldb"'
    Name: env
  - Env:
    - Key: BOOKED_DATABASE_NAME
      Value: '"bookedscheduler"'
    Name: env
  - Env:
    - Key: BOOKED_PHPMAILER_MAILER
      Value: '"mail"'
    Name: env
  - Env:
    - Key: BOOKED_PHPMAILER_SMTP_HOST
      Value: '""'
    Name: env
  - Env:
    - Key: BOOKED_PHPMAILER_SMTP_PORT
      Value: '"25"'
    Name: env
  - Env:
    - Key: BOOKED_PHPMAILER_SMTP_SECURE
      Value: '""'
    Name: env
  - Env:
    - Key: BOOKED_PHPMAILER_SMTP_AUTH
      Value: '"true"'
    Name: env
  - Env:
    - Key: BOOKED_PHPMAILER_SMTP_USERNAME
      Value: '""'
    Name: env
  - Env:
    - Key: BOOKED_PHPMAILER_SMTP_PASSWORD
      Value: '""'
    Name: env
  - Env:
    - Key: BOOKED_PHPMAILER_SENDMAIL_PATH
      Value: '"/usr/sbin/sendmail"'
    Name: env
  - Env:
    - Key: BOOKED_PHPMAILER_SMTP_DEBUG
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_INSTALL_PASSWORD
      Value: '""'
    Name: env
  - Env:
    - Key: BOOKED_API_ENABLED
      Value: '"true"'
    Name: env
  - Env:
    - Key: BOOKED_EMAIL_DEFAULT_FROM_ADDRESS
      Value: '""'
    Name: env
  - Env:
    - Key: BOOKED_EMAIL_DEFAULT_FROM_NAME
      Value: '""'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_LABELS_ICS_SUMMARY
      Value: '"{title}"'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_LABELS_ICS_MY_SUMMARY
      Value: '"{title}"'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_LABELS_RSS_DESCRIPTION
      Value: '"<div><span>Start</span> {startdate}</div><div><span>End</span> {enddate}</div><div><span>Organizer</span>
        {name}</div><div><span>Description</span> {description}</div>"'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_LABELS_MY_CALENDAR
      Value: '"{resourcename} {title}"'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_LABELS_RESOURCE_CALENDAR
      Value: '"{name}"'
    Name: env
  - Env:
    - Key: BOOKED_RESERVATION_LABELS_RESERVATION_POPUP
      Value: '""'
    Name: env
  - Env:
    - Key: BOOKED_CREDITS_ENABLED
      Value: '"false"'
    Name: env
  - Env:
    - Key: BOOKED_CREDITS_ALLOW_PURCHASE
      Value: '"false"'
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - php.ini
    - /usr/local/etc/php/
  - CmdLine:
    - apt-get update &&     apt-get install -y vim     curl     unzip     mysql-client     libpng-dev     libfreetype6-dev     libjpeg62-turbo-dev     zlib1g-dev     libicu-dev     g++
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone
    Name: run
    PrependShell: true
  - CmdLine:
    - docker-php-ext-configure intl     && docker-php-ext-install intl
    Name: run
    PrependShell: true
  - CmdLine:
    - docker-php-ext-install -j$(nproc) mysql mysqli pdo pdo_mysql     && docker-php-ext-configure
      gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/     && docker-php-ext-install
      -j$(nproc) gd
    Name: run
    PrependShell: true
  - CmdLine:
    - cd /var/www && curl -L -Os $BOOKED_DL_URL &&     unzip $BOOKED_DL_FILE &&     cp
      booked/config/config.dist.php booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/app.title/ s/=.*/= getenv('BOOKED_APP_TITLE');/' /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/default.timezone/ s/=.*/= getenv('BOOKED_DEFAULT_TIMEZONE');/' /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/allow.self.registration/ s/=.*/= getenv('BOOKED_ALLOW_SELF_REGISTRATION');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/admin.email/ s/=.*/= getenv('BOOKED_ADMIN_EMAIL');/' /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/admin.email.name/ s/=.*/= getenv('BOOKED_ADMIN_EMAIL_NAME');/' /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/default.page.size/ s/=.*/= getenv('BOOKED_DEFAULT_PAGE_SIZE');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/enable.email/ s/=.*/= getenv('BOOKED_ENABLE_EMAIL');/' /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/default.language/ s/=.*/= getenv('BOOKED_DEFAULT_LANGUAGE');/' /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/script.url/ s/=.*/= getenv('BOOKED_WEB_URL');/' /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/registration.captcha.enabled/ s/=.*/= getenv('BOOKED_REGISTRATION_CAPTCHA_ENABLED');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/registration.require.email.activation/ s/=.*/= getenv('BOOKED_REGISTRATION_REQUIRE_EMAIL_ACTIVATION');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/registration.auto.subscribe.email/ s/=.*/= getenv('BOOKED_REGISTRATION_AUTO_SUBSCRIBE_EMAIL');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/registration.notify.admin/ s/=.*/= getenv('BOOKED_REGISTRATION_NOTIFY_ADMIN');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/home.url/ s/=.*/= getenv('BOOKED_HOME_URL');/' /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/logout.url/ s/=.*/= getenv('BOOKED_WEB_URL');/' /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/default.homepage/ s/=.*/= getenv('BOOKED_DEFAULT_HOMEPAGE');/' /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/schedule'\''\]\['\''use.per.user.colors/ s/=.*/= getenv('BOOKED_SCHEDULE_USE_PER_USER_COLORS');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/schedule'\''\]\['\''show.inaccessible.resources/ s/=.*/= getenv('BOOKED_SCHEDULE_SHOW_INACCESSIBLE_RESOURCES');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/schedule'\''\]\['\''reservation.label/ s/=.*/= getenv('BOOKED_SCHEDULE_RESERVATION_LABEL');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/schedule'\''\]\['\''hide.blocked.periods/ s/=.*/= getenv('BOOKED_SCHEDULE_HIDE_BLOCKED_PERIODS');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/ics'\''\]\['\''subscription.key/ s/=.*/= getenv('BOOKED_ICS_SUBSCRIPTION_KEY');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/privacy'\''\]\['\''view.schedules/ s/=.*/= getenv('BOOKED_PRIVACY_VIEW_SCHEDULES');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/privacy'\''\]\['\''view.reservations/ s/=.*/= getenv('BOOKED_PRIVACY_VIEW_RESERVATIONS');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/privacy'\''\]\['\''hide.user.details/ s/=.*/= getenv('BOOKED_PRIVACY_HIDE_USER_DETAILS');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/privacy'\''\]\['\''hide.reservation.details/ s/=.*/= getenv('BOOKED_PRIVACY_HIDE_RESERVATION_DETAILS');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/privacy'\''\]\['\''allow.guest.reservations/ s/=.*/= getenv('BOOKED_PRIVACY_ALLOW_GUEST_RESERVATIONS');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation'\''\]\['\''enable.reminders/ s/=.*/= getenv('BOOKED_RESERVATION_ENABLE_REMINDERS');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation'\''\]\['\''allow.guest.reservations/ s/=.*/= getenv('BOOKED_RESERVATION_ALLOW_GUEST_PARTICIPATION');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation'\''\]\['\''allow.wait.list/ s/=.*/= getenv('BOOKED_RESERVATION_ALLOW_WAIT_LIST');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation'\''\]\['\''checkin.minutes.prior/ s/=.*/= getenv('BOOKED_RESERVATION_CHECKIN_MINUTES_PRIOR');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation'\''\]\['\''title.required/ s/=.*/= getenv('BOOKED_RESERVATION_TITLE_REQUIRED');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation'\''\]\['\''description.required/ s/=.*/= getenv('BOOKED_RESERVATION_DESCRIPTION_REQUIRED');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/uploads'\''\]\['\''enable.reservation.attachments/ s/=.*/= getenv('BOOKED_UPLOADS_ENABLE_RESERVATION_ATTACHMENTS');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/uploads'\''\]\['\''reservation.attachment.path/ s/=.*/= getenv('BOOKED_UPLOADS_RESERVATION_ATTACHMENT_PATH');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/uploads'\''\]\['\''reservation.attachment.extensions/ s/=.*/= getenv('BOOKED_UPLOADS_RESERVATION_ATTACHMENT_EXTENSIONS');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/database'\''\]\['\''type/ s/=.*/= getenv('BOOKED_DATABASE_TYPE');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/database'\''\]\['\''user/ s/=.*/= getenv('BOOKED_DATABASE_USER');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/database'\''\]\['\''password/ s/=.*/= getenv('BOOKED_DATABASE_PASSWORD');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/database'\''\]\['\''hostspec/ s/=.*/= getenv('BOOKED_DATABASE_HOSTSPEC');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/database'\''\]\['\''name/ s/=.*/= getenv('BOOKED_DATABASE_NAME');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/phpmailer'\''\]\['\''mailer/ s/=.*/= getenv('BOOKED_PHPMAILER_MAILER');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/phpmailer'\''\]\['\''smtp.host/ s/=.*/= getenv('BOOKED_PHPMAILER_SMTP_HOST');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/phpmailer'\''\]\['\''smtp.port/ s/=.*/= getenv('BOOKED_PHPMAILER_SMTP_PORT');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/phpmailer'\''\]\['\''smtp.secure/ s/=.*/= getenv('BOOKED_PHPMAILER_SMTP_SECURE');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/phpmailer'\''\]\['\''smtp.auth/ s/=.*/= getenv('BOOKED_PHPMAILER_SMTP_AUTH');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/phpmailer'\''\]\['\''smtp.username/ s/=.*/= getenv('BOOKED_PHPMAILER_SMTP_USERNAME');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/phpmailer'\''\]\['\''smtp.password/ s/=.*/= getenv('BOOKED_PHPMAILER_SMTP_PASSWORD');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/phpmailer'\''\]\['\''sendmail.path/ s/=.*/= getenv('BOOKED_PHPMAILER_SENDMAIL_PATH');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/phpmailer'\''\]\['\''smtp.debug/ s/=.*/= getenv('BOOKED_PHPMAILER_SMTP_DEBUG');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/install.password/ s/=.*/= getenv('BOOKED_INSTALL_PASSWORD');/' /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/api'\''\]\['\''enabled/ s/=.*/= getenv('BOOKED_API_ENABLED');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/email'\''\]\['\''default.from.address/ s/=.*/= getenv('BOOKED_EMAIL_DEFAULT_FROM_ADDRESS');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/email'\''\]\['\''default.from.name/ s/=.*/= getenv('BOOKED_EMAIL_DEFAULT_FROM_NAME');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation.labels'\''\]\['\''ics.summary/ s/=.*/= getenv('BOOKED_RESERVATION_LABELS_ICS_SUMMARY');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation.labels'\''\]\['\''ics.my.summary/ s/=.*/= getenv('BOOKED_RESERVATION_LABELS_ICS_MY_SUMMARY');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation.labels'\''\]\['\''rss.description/ s/=.*/= getenv('BOOKED_RESERVATION_LABELS_RSS_DESCRIPTION');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation.labels'\''\]\['\''my.calendary/ s/=.*/= getenv('BOOKED_RESERVATION_LABELS_MY_CALENDAR');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation.labels'\''\]\['\''resource.calendar/ s/=.*/= getenv('BOOKED_RESERVATION_LABELS_RESOURCE_CALENDAR');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/reservation.labels'\''\]\['\''reservation.popup/ s/=.*/= getenv('BOOKED_RESERVATION_LABELS_RESERVATION_POPUP');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/credits'\''\]\['\''enable/ s/=.*/= getenv('BOOKED_CREDITS_ENABLED');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e '/credits'\''\]\['\''allow.purchase/ s/=.*/= getenv('BOOKED_CREDITS_ALLOW_PURCHASE');/'
      /var/www/booked/config/config.php
    Name: run
    PrependShell: true
  - CmdLine:
    - 'chown www-data: /var/www/booked -R &&     chmod 0755 /var/www/booked -R'
    Name: run
    PrependShell: true
  - CmdLine:
    - cp /etc/apache2/sites-available/000-default.conf /etc/apache2/sites-available/booked.conf
      &&     sed -i 's,/var/www/html,/var/www/booked,g' /etc/apache2/sites-available/booked.conf
      &&     sed -i 's,${APACHE_LOG_DIR},/var/log/apache2,g' /etc/apache2/sites-available/booked.conf
      &&     a2ensite booked.conf && a2dissite 000-default.conf && a2enmod rewrite
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /var/www/booked
  - Name: expose
    Ports:
    - "443"
    - "80"
  - CmdLine:
    - apache2-foreground
    Name: cmd
    PrependShell: false
  From:
    Image: php:5.6-apache
  Name: ""
  Platform: ""
  SourceCode: FROM php:5.6-apache
