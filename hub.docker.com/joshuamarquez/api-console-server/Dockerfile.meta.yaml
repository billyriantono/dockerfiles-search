MetaArgs: null
Stages:
- BaseName: nginx:alpine
  Commands:
  - Maintainer: Joshua Marquez "joshua.marquezn@gmail.com"
    Name: maintainer
  - Env:
    - Key: API_CONSOLE_VERSION
      Value: 3.0.19
    Name: env
  - CmdLine:
    - apk --no-cache add openssl
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://github.com/mulesoft/api-console/archive/v$API_CONSOLE_VERSION.tar.gz
      -O console.tar.gz
    Name: run
    PrependShell: true
  - CmdLine:
    - tar -xvf console.tar.gz  && rm -rf console.tar.gz  && mv -f api-console-$API_CONSOLE_VERSION/dist
      /api-console-server  && rm -rf api-console-$API_CONSOLE_VERSION  && mkdir api-console-server/raml  &&
      cp api-console-server/examples/simple.raml api-console-server/raml/api.raml  &&
      rm -rf api-console-server/examples
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /api-console-server
  - CmdLine:
    - sed -i 's/<raml-initializer><\/raml-initializer>/<raml-console-loader src="raml\/api.raml"><\/raml-console-loader>/g'
      /api-console-server/index.html
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i 's/src="/src="\//g' /api-console-server/index.html
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i 's/href="/href="\//g' /api-console-server/index.html
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - nginx.conf
    - /etc/nginx/conf.d/api_console_server.conf
  - Name: expose
    Ports:
    - "80"
  From:
    Image: nginx:alpine
  Name: ""
  Platform: ""
  SourceCode: FROM nginx:alpine
