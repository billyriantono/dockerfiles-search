MetaArgs: null
Stages:
- BaseName: rigoford/alpine-java-newrelic:3.33.0.1
  Commands:
  - Maintainer: Martin Ford <ford.j.martin@gmail.com>
    Name: maintainer
  - Key: SONAR_USER
    Name: arg
    Value: sonar
  - Key: SONAR_VERSION
    Name: arg
    Value: "6.7"
  - Key: SONARQUBE_HOME
    Name: arg
    Value: /opt/sonarqube
  - Key: SONARQUBE_DATA
    Name: arg
    Value: $SONARQUBE_HOME/data
  - Key: SONARQUBE_EXTENSIONS
    Name: arg
    Value: $SONARQUBE_HOME/extensions
  - Key: SONARQUBE_PLUGINS
    Name: arg
    Value: $SONARQUBE_EXTENSIONS/plugins
  - Env:
    - Key: SONAR_VERSION
      Value: $SONAR_VERSION
    - Key: SONARQUBE_HOME
      Value: $SONARQUBE_HOME
    - Key: SONARQUBE_JDBC_USERNAME
      Value: sonar
    - Key: SONARQUBE_JDBC_PASSWORD
      Value: sonar
    - Key: SONARQUBE_JDBC_URL
      Value: ""
    Name: env
  - CmdLine:
    - apk --no-cache add curl unzip
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /tmp &&     curl -o /tmp/sonarqube.zip -fSL       https://sonarsource.bintray.com/Distribution/sonarqube/sonarqube-$SONAR_VERSION.zip
      &&     unzip /tmp/sonarqube.zip -d /opt &&     mv /opt/sonarqube-$SONAR_VERSION
      $SONARQUBE_HOME &&     rm /tmp/sonarqube.zip
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - files/run.sh
    - $SONARQUBE_HOME/bin
  - Key: SONAR_CHECKSTYLE_PLUGIN
    Name: arg
    Value: checkstyle-sonar-plugin
  - Key: SONAR_CHECKSTYLE_PLUGIN_VERSION
    Name: arg
    Value: "3.7"
  - Key: SONAR_DEPENDENCY_CHECK_PLUGIN
    Name: arg
    Value: sonar-dependency-check-plugin
  - Key: SONAR_DEPENDENCY_CHECK_PLUGIN_VERSION
    Name: arg
    Value: 1.0.2
  - Key: SONAR_FINDBUGS_PLUGIN
    Name: arg
    Value: sonar-findbugs-plugin
  - Key: SONAR_FINDBUGS_PLUGIN_VERSION
    Name: arg
    Value: 3.5.0
  - Key: SONAR_GIT_PLUGIN
    Name: arg
    Value: sonar-scm-git-plugin
  - Key: SONAR_GIT_PLUGIN_VERSION
    Name: arg
    Value: "1.2"
  - Key: SONAR_GROOVY_PLUGIN
    Name: arg
    Value: sonar-groovy-plugin
  - Key: SONAR_GROOVY_PLUGIN_VERSION
    Name: arg
    Value: "1.5"
  - Key: SONAR_JAVA_PLUGIN
    Name: arg
    Value: sonar-java-plugin
  - Key: SONAR_JAVA_PLUGIN_VERSION
    Name: arg
    Value: 4.12.0.11033
  - Key: SONAR_JAVA_RULES
    Name: arg
    Value: sonar-java-rules
  - Key: SONAR_JAVA_RULES_VERSION
    Name: arg
    Value: 0.3.0
  - Key: SONAR_JAVASCRIPT_PLUGIN
    Name: arg
    Value: sonar-javascript-plugin
  - Key: SONAR_JAVASCRIPT_PLUGIN_VERSION
    Name: arg
    Value: 3.1.1.5128
  - Key: SONAR_LDAP_PLUGIN
    Name: arg
    Value: sonar-ldap-plugin
  - Key: SONAR_LDAP_PLUGIN_VERSION
    Name: arg
    Value: 2.2.0.608
  - Key: SONAR_PMD_PLUGIN
    Name: arg
    Value: sonar-pmd-plugin
  - Key: SONAR_PMD_PLUGIN_VERSION
    Name: arg
    Value: "2.6"
  - Key: SONAR_XML_PLUGIN
    Name: arg
    Value: sonar-xml-plugin
  - Key: SONAR_XML_PLUGIN_VERSION
    Name: arg
    Value: 1.4.3.1027
  - CmdLine:
    - curl -o $SONARQUBE_PLUGINS/$SONAR_CHECKSTYLE_PLUGIN-$SONAR_CHECKSTYLE_PLUGIN_VERSION.jar
      -fSL       https://github.com/checkstyle/sonar-checkstyle/releases/download/$SONAR_CHECKSTYLE_PLUGIN_VERSION/$SONAR_CHECKSTYLE_PLUGIN-$SONAR_CHECKSTYLE_PLUGIN_VERSION.jar
      &&     curl -o $SONARQUBE_PLUGINS/$SONAR_DEPENDENCY_CHECK_PLUGIN-$SONAR_DEPENDENCY_CHECK_PLUGIN_VERSION.jar
      -fSL       https://github.com/stevespringett/dependency-check-sonar-plugin/releases/download/sonar-dependency-check-$SONAR_DEPENDENCY_CHECK_PLUGIN_VERSION/$SONAR_DEPENDENCY_CHECK_PLUGIN-$SONAR_DEPENDENCY_CHECK_PLUGIN_VERSION.jar
      &&     curl -o $SONARQUBE_PLUGINS/$SONAR_FINDBUGS_PLUGIN-$SONAR_FINDBUGS_PLUGIN_VERSION.jar
      -fSL       https://github.com/SonarQubeCommunity/sonar-findbugs/releases/download/$SONAR_FINDBUGS_PLUGIN_VERSION/$SONAR_FINDBUGS_PLUGIN.jar
      &&     curl -o $SONARQUBE_PLUGINS/$SONAR_GIT_PLUGIN-$SONAR_GIT_PLUGIN_VERSION.jar
      -fSL       https://sonarsource.bintray.com/Distribution/$SONAR_GIT_PLUGIN/$SONAR_GIT_PLUGIN-$SONAR_GIT_PLUGIN_VERSION.jar
      &&     curl -o $SONARQUBE_PLUGINS/$SONAR_GROOVY_PLUGIN-$SONAR_GROOVY_PLUGIN_VERSION.jar
      -fSL       https://github.com/SonarQubeCommunity/sonar-groovy/releases/download/$SONAR_GROOVY_PLUGIN_VERSION/$SONAR_GROOVY_PLUGIN-$SONAR_GROOVY_PLUGIN_VERSION.jar
      &&     curl -o $SONARQUBE_PLUGINS/$SONAR_JAVA_PLUGIN-$SONAR_JAVA_PLUGIN_VERSION.jar
      -fSL       https://sonarsource.bintray.com/Distribution/$SONAR_JAVA_PLUGIN/$SONAR_JAVA_PLUGIN-$SONAR_JAVA_PLUGIN_VERSION.jar
      &&     curl -o $SONARQUBE_PLUGINS/$SONAR_JAVA_RULES-$SONAR_JAVA_RULES_VERSION.jar
      -fSL       https://oss.sonatype.org/content/repositories/releases/com/github/rigoford/$SONAR_JAVA_RULES/$SONAR_JAVA_RULES_VERSION/$SONAR_JAVA_RULES-$SONAR_JAVA_RULES_VERSION.jar
      &&     curl -o $SONARQUBE_PLUGINS/$SONAR_JAVASCRIPT_PLUGIN-$SONAR_JAVASCRIPT_PLUGIN_VERSION.jar
      -fSL       https://sonarsource.bintray.com/Distribution/$SONAR_JAVASCRIPT_PLUGIN/$SONAR_JAVASCRIPT_PLUGIN-$SONAR_JAVASCRIPT_PLUGIN_VERSION.jar
      &&     curl -o $SONARQUBE_PLUGINS/$SONAR_LDAP_PLUGIN-$SONAR_LDAP_PLUGIN_VERSION.jar
      -fSL       https://sonarsource.bintray.com/Distribution/$SONAR_LDAP_PLUGIN/$SONAR_LDAP_PLUGIN-$SONAR_LDAP_PLUGIN_VERSION.jar
      &&     curl -o $SONARQUBE_PLUGINS/$SONAR_PMD_PLUGIN-$SONAR_PMD_PLUGIN_VERSION.jar
      -fSL       https://github.com/SonarQubeCommunity/sonar-pmd/releases/download/$SONAR_PMD_PLUGIN_VERSION/$SONAR_PMD_PLUGIN-$SONAR_PMD_PLUGIN_VERSION.jar
      &&     curl -o $SONARQUBE_PLUGINS/$SONAR_XML_PLUGIN-$SONAR_XML_PLUGIN_VERSION.jar
      -fSL       http://sonarsource.bintray.com/Distribution/$SONAR_XML_PLUGIN/$SONAR_XML_PLUGIN-$SONAR_XML_PLUGIN_VERSION.jar
    Name: run
    PrependShell: true
  - CmdLine:
    - apk del curl unzip
    Name: run
    PrependShell: true
  - CmdLine:
    - addgroup $SONAR_USER &&     adduser -h $SONARQUBE_HOME -s /bin/sh -D -G $SONAR_USER
      -H $SONAR_USER &&     chown -R $SONAR_USER:$SONAR_USER $SONARQUBE_HOME
    Name: run
    PrependShell: true
  - Name: user
    User: $SONAR_USER
  - Name: expose
    Ports:
    - "9000"
  - Name: volume
    Volumes:
    - $SONARQUBE_DATA
    - $SONARQUBE_EXTENSIONS
  - Name: workdir
    Path: $SONARQUBE_HOME
  - CmdLine:
    - ./bin/run.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: rigoford/alpine-java-newrelic:3.33.0.1
  Name: ""
  Platform: ""
  SourceCode: FROM rigoford/alpine-java-newrelic:3.33.0.1
