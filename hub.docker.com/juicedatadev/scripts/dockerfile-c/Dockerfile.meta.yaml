MetaArgs: null
Stages:
- BaseName: php:7.0-fpm
  Commands:
  - Maintainer: themoroccan09 <themoroccan@github>
    Name: maintainer
  - CmdLine:
    - apt-get update         && apt-get install -y                 zip                 unzip                 wget                 curl                 git                 nano                 openssl                 cron                 supervisor                 htop         &&
      rm -rf /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - CmdLine:
    - buildRequirements="libpng-dev libjpeg-dev libfreetype6-dev"         && apt-get
      update && apt-get install -y ${buildRequirements}         && docker-php-ext-configure
      gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/lib         && docker-php-ext-install
      gd         && apt-get purge -y ${buildRequirements}         && rm -rf /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - CmdLine:
    - docker-php-ext-install pdo_mysql
    Name: run
    PrependShell: true
  - CmdLine:
    - docker-php-ext-install mysqli
    Name: run
    PrependShell: true
  - CmdLine:
    - runtimeRequirements="re2c libmcrypt-dev"         && apt-get update && apt-get
      install -y ${runtimeRequirements}         && docker-php-ext-install mcrypt         &&
      rm -rf /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - CmdLine:
    - docker-php-ext-install mbstring
    Name: run
    PrependShell: true
  - CmdLine:
    - buildRequirements="zlib1g-dev"         && apt-get update && apt-get install
      -y ${buildRequirements}         && docker-php-ext-install zip         && apt-get
      purge -y ${buildRequirements}         && rm -rf /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - CmdLine:
    - "apt-get update \t&& apt-get install -y \tlibxml2-dev \tlibxslt-dev \t&& docker-php-ext-install
      \t\tdom \t\txmlrpc \t\txsl"
    Name: run
    PrependShell: true
  - CmdLine:
    - "php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\"
      \t&& php -r \"if (hash_file('SHA384', 'composer-setup.php') === '544e09ee996cdf60ece3804abc52599c22b1f40f4323403c44d44fdfdd586475ca9813a858088ffbc1f233e9b180f061')
      { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php');
      } echo PHP_EOL;\" \t&& php composer-setup.php  \t&& php -r \"unlink('composer-setup.php');\"
      \t&& mv composer.phar /usr/local/bin/composer"
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -s /usr/local/bin/php /usr/bin/php
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./cron-kpi
    - /home
  - CmdLine:
    - crontab /home/cron-kpi
    Name: run
    PrependShell: true
  - CmdLine:
    - touch /var/log/cron.log
    Name: run
    PrependShell: true
  - CmdLine:
    - rm /home/cron-kpi
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - my-configuration.conf
    - /usr/local/etc/php-fpm.d/
  - CmdLine:
    - chsh www-data -s /bin/bash
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - laravel-worker.conf
    - /etc/supervisor/conf.d/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./entrypoint.sh
    - /
  - Name: workdir
    Path: /var/www
  - Name: expose
    Ports:
    - "9000"
  - CmdLine:
    - /entrypoint.sh
    Name: entrypoint
    PrependShell: true
  From:
    Image: php:7.0-fpm
  Name: ""
  Platform: ""
  SourceCode: FROM php:7.0-fpm
