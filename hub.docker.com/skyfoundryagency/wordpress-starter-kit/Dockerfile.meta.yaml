MetaArgs: null
Stages:
- As: static-build
  BaseName: node:11-alpine
  Commands:
  - Name: workdir
    Path: /usr/src/app
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - package.json
    - ./
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - yarn.lock
    - ./
  - CmdLine:
    - yarn install     && yarn cache clean
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./web/app/themes
    - ./web/app/themes
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - postcss.config.js
    - ./
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - webpack.config.js
    - ./
  - CmdLine:
    - yarn run build
    Name: run
    PrependShell: true
  From:
    Image: node:11-alpine
  Name: static-build
  Platform: ""
  SourceCode: FROM node:11-alpine as static-build
- BaseName: skyfoundryagency/docker-nginx-php:latest
  Commands:
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - composer.json
    - .
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - composer.lock
    - .
  - CmdLine:
    - composer install --prefer-dist --no-scripts --no-autoloader --no-progress --no-suggest     &&
      composer clear-cache
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - .
  - Chown: ""
    From: static-build
    Name: copy
    SourcesAndDest:
    - /usr/src/app/web/app/themes/default-theme/dist
    - /var/www/html/web/app/themes/default-theme/dist
  - CmdLine:
    - composer dump-autoload --no-scripts --optimize
    Name: run
    PrependShell: true
  From:
    Image: skyfoundryagency/docker-nginx-php:latest
  Name: ""
  Platform: ""
  SourceCode: FROM skyfoundryagency/docker-nginx-php:latest
