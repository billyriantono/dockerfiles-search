MetaArgs: null
Stages:
- BaseName: starwarsfan/edomi-baseimage:6.8.2
  Commands:
  - Maintainer: Yves Schumann <y.schumann@yetnet.ch>
    Name: maintainer
  - Key: EDOMI_VERSION
    Name: arg
    Value: EDOMI-Beta_164.zip
  - Key: ROOT_PASS
    Name: arg
    Value: "123456"
  - Env:
    - Key: EDOMI_VERSION
      Value: ${EDOMI_VERSION}
    - Key: EDOMI_ZIP
      Value: /tmp/edomi.zip
    - Key: EDOMI_INSTALL_PATH
      Value: /tmp/edomi/Install/
    - Key: START_SCRIPT
      Value: /root/start.sh
    - Key: ROOT_PASS
      Value: ${ROOT_PASS}
    - Key: EDOMI_BACKUP_DIR
      Value: /var/edomi-backups
    - Key: EDOMI_DB_DIR
      Value: /var/lib/mysql
    - Key: EDOMI_INSTALL_DIR
      Value: /usr/local/edomi
    Name: env
  - CmdLine:
    - mkdir -p /root/patch_1.62
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - root/patch_1.62.sh
    - /root/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - root/patch_1.62/cmd1.php
    - /root/patch_1.62/
  - CmdLine:
    - chmod +x /root/patch_1.62.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - echo -e "${ROOT_PASS}\n${ROOT_PASS}" | (passwd --stdin root)  && mv /sbin/shutdown
      /sbin/shutdown_  && mv /sbin/reboot /sbin/reboot_
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - bin/start.sh
    - ${START_SCRIPT}
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - sbin/reboot
    - sbin/shutdown
    - /sbin/
  - CmdLine:
    - chmod +x ${START_SCRIPT} /sbin/reboot /sbin/shutdown
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - http://edomi.de/download/install/${EDOMI_VERSION}
    - ${EDOMI_ZIP}
  - CmdLine:
    - unzip -q ${EDOMI_ZIP} -d /tmp/
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - bin/install.sh
    - ${EDOMI_INSTALL_PATH}
  - CmdLine:
    - cd ${EDOMI_INSTALL_PATH}  && ./install.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e "\$aLoadModule log_config_module modules/mod_log_config.so"            -e
      "\$aLoadModule setenvif_module modules/mod_setenvif.so" /etc/httpd/conf.d/ssl.conf
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - ${EDOMI_BACKUP_DIR}
    - ${EDOMI_DB_DIR}
    - ${EDOMI_INSTALL_DIR}
  - CmdLine:
    - /root/start.sh
    Name: cmd
    PrependShell: false
  From:
    Image: starwarsfan/edomi-baseimage:6.8.2
  Name: ""
  Platform: ""
  SourceCode: FROM starwarsfan/edomi-baseimage:6.8.2
