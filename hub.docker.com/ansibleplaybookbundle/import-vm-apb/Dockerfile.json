{
  "MetaArgs": null,
  "Stages": [
    {
      "Name": "",
      "BaseName": "ansibleplaybookbundle/apb-base",
      "SourceCode": "FROM ansibleplaybookbundle/apb-base",
      "Platform": "",
      "From": {
        "Image": "ansibleplaybookbundle/apb-base"
      },
      "Commands": [
        {
          "Labels": [
            {
              "Key": "\"com.redhat.apb.spec\"",
              "Value": "\"dmVyc2lvbjogMS4wCm5hbWU6IGltcG9ydC12bS1hcGIKZGVzY3JpcHRpb246IEltcG9ydCBWaXJ0dWFsIE1hY2hpbmUKYmluZGFibGU6IEZhbHNlCmFzeW5jOiBvcHRpb25hbAp0YWdzOgogIC0gdmlydHVhbG1hY2hpbmUKbWV0YWRhdGE6CiAgZGlzcGxheU5hbWU6IEltcG9ydCBWaXJ0dWFsIE1hY2hpbmUKICBpbWFnZVVybDogaHR0cHM6Ly9jZG4ucGJyZC5jby9pbWFnZXMvSDVHdXRkNy5wbmcKICBsb25nRGVzY3JpcHRpb246IHwKICAgICBJbXBvcnQgVmlydHVhbCBNYWNoaW5lIGZyb20gYW4gZXhpc3RpbmcgaW1hZ2Ugb3IgYSBWTXdhcmUgZW52aXJvbm1lbnQuCnBsYW5zOgogIC0gbmFtZTogdm13YXJlCiAgICBkZXNjcmlwdGlvbjogSW1wb3J0IGEgdmlydHVhbCBtYWNoaW5lIGZyb20gVk13YXJlIHZDZW50ZXIuCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IGMuIEltcG9ydCBmcm9tIFZNd2FyZS4KICAgIHBhcmFtZXRlcnM6CiAgICAgIC0gdGl0bGU6IE9wZW5TaGlmdCBBZG1pbiBVc2VybmFtZQogICAgICAgIG5hbWU6IGFkbWluX3VzZXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIHRpdGxlOiBPcGVuU2hpZnQgQWRtaW4gUGFzc3dvcmQKICAgICAgICBuYW1lOiBhZG1pbl9wYXNzd29yZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAtIHRpdGxlOiBWTXdhcmUgVVJMIHRvIEVYU2kKICAgICAgICBuYW1lOiB1cmwKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIHRpdGxlOiBWaXJ0dWFsIE1hY2hpbmUgTmFtZQogICAgICAgIG5hbWU6IHZtX25hbWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIHBhdHRlcm46ICJeW2EtejAtOS4tXSokIgogICAgICAtIHRpdGxlOiBWTXdhcmUgQWRtaW4gVXNlcm5hbWUKICAgICAgICBuYW1lOiB1c2VybmFtZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGlzcGxheV90eXBlOiB1c2VybmFtZQogICAgICAtIHRpdGxlOiBWTXdhcmUgQWRtaW4gUGFzc3dvcmQKICAgICAgICBuYW1lOiBwYXNzd29yZAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgZGlzcGxheV90eXBlOiBwYXNzd29yZAogICAgICAtIHRpdGxlOiBPcGVyYXRpbmcgU3lzdGVtIFR5cGUKICAgICAgICBuYW1lOiBvc190eXBlCiAgICAgICAgZGVmYXVsdDogbGludXgKICAgICAgICBlbnVtOiBbJ2xpbnV4JywgJ3dpbmRvd3MnXQogICAgICAgIHR5cGU6IGVudW0KICAtIG5hbWU6IHZtd2FyZS10ZW1wbGF0ZQogICAgZGVzY3JpcHRpb246IEltcG9ydCBhIHZpcnR1YWwgbWFjaGluZSBhcyBhIHRlbXBsYXRlIGZyb20gVk13YXJlIHZDZW50ZXIuCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YToKICAgICAgZGlzcGxheU5hbWU6IGQuIEltcG9ydCBhcyBhIHRlbXBsYXRlIGZyb20gVk13YXJlLgogICAgcGFyYW1ldGVyczoKICAgICAgLSB0aXRsZTogT3BlblNoaWZ0IEFkbWluIFVzZXJuYW1lCiAgICAgICAgbmFtZTogYWRtaW5fdXNlcgogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gdGl0bGU6IE9wZW5TaGlmdCBBZG1pbiBQYXNzd29yZAogICAgICAgIG5hbWU6IGFkbWluX3Bhc3N3b3JkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBkaXNwbGF5X3R5cGU6IHBhc3N3b3JkCiAgICAgIC0gdGl0bGU6IFZNd2FyZSBVUkwgdG8gRVhTaQogICAgICAgIG5hbWU6IHVybAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gdGl0bGU6IFRlbXBsYXRlIE5hbWUKICAgICAgICBuYW1lOiB2bV9uYW1lCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICBwYXR0ZXJuOiAiXlthLXowLTkuLV0qJCIKICAgICAgLSB0aXRsZTogVk13YXJlIEFkbWluIFVzZXJuYW1lCiAgICAgICAgbmFtZTogdXNlcm5hbWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRpc3BsYXlfdHlwZTogdXNlcm5hbWUKICAgICAgLSB0aXRsZTogVk13YXJlIEFkbWluIFBhc3N3b3JkCiAgICAgICAgbmFtZTogcGFzc3dvcmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgLSB0aXRsZTogT3BlcmF0aW5nIFN5c3RlbSBUeXBlCiAgICAgICAgbmFtZTogb3NfdHlwZQogICAgICAgIGRlZmF1bHQ6IGxpbnV4CiAgICAgICAgZW51bTogWydsaW51eCcsICd3aW5kb3dzJ10KICAgICAgICB0eXBlOiBlbnVtCiAgLSBuYW1lOiB1cmwKICAgIGRlc2NyaXB0aW9uOiBDcmVhdGUgYSB2aXJ0dWFsIG1hY2hpbmUgZnJvbSBhIGRvd25sb2FkZWQgZGlzayBpbWFnZS4KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogYS4gSW1wb3J0IGZyb20gVVJMLgogICAgcGFyYW1ldGVyczoKICAgICAgLSB0aXRsZTogRGlzayBJbWFnZSBVUkwKICAgICAgICBuYW1lOiBkaXNrX2ltYWdlX3VybAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gdGl0bGU6IE9wZXJhdGluZyBzeXN0ZW0gdHlwZQogICAgICAgIG5hbWU6IG9zX3R5cGUKICAgICAgICBkZWZhdWx0OiBsaW51eAogICAgICAgIGVudW06IFsnbGludXgnLCAnd2luZG93cyddCiAgICAgICAgdHlwZTogZW51bQogICAgICAtIHRpdGxlOiBWaXJ0dWFsIE1hY2hpbmUgTmFtZQogICAgICAgIG5hbWU6IHZtX25hbWUKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIHBhdHRlcm46ICJeW2EtejAtOS4tXSokIgogICAgICAtIHRpdGxlOiBOdW1iZXIgb2YgQ29yZXMKICAgICAgICBuYW1lOiBucl9jb3JlcwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgdHlwZTogaW50CiAgICAgICAgZGVmYXVsdDogMQogICAgICAtIHRpdGxlOiBNZW1vcnkgKE1pQikKICAgICAgICBuYW1lOiBtZW0KICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIHR5cGU6IGludAogICAgICAgIGRlZmF1bHQ6IDEwMjQKICAgICAgLSB0aXRsZTogRGlzayBTaXplIChHaUIpIChsZWF2ZSBhdCAwIHRvIGF1dG8gZGV0ZWN0IHNpemUpCiAgICAgICAgbmFtZTogZGlza19zaXplX2diCiAgICAgICAgdHlwZTogaW50CiAgICAgICAgZGVmYXVsdDogMAogICAgICAtIHRpdGxlOiBTdG9yYWdlIENsYXNzIChsZWF2ZSBlbXB0eSB0byB1c2UgdGhlIGRlZmF1bHQgc3RvcmFnZSBjbGFzcykKICAgICAgICBuYW1lOiBzdG9yYWdlX2NsYXNzCiAgICAgICAgdHlwZTogc3RyaW5nCiAgLSBuYW1lOiB1cmwtdGVtcGxhdGUKICAgIGRlc2NyaXB0aW9uOiBDcmVhdGUgYSB2aXJ0dWFsIG1hY2hpbmUgdGVtcGxhdGUgZnJvbSBhIGRvd25sb2FkZWQgZGlzayBpbWFnZS4KICAgIGZyZWU6IFRydWUKICAgIG1ldGFkYXRhOgogICAgICBkaXNwbGF5TmFtZTogYi4gSW1wb3J0IGFzIGEgdGVtcGxhdGUgZnJvbSBVUkwuCiAgICBwYXJhbWV0ZXJzOgogICAgICAtIHRpdGxlOiBPcGVuU2hpZnQgQWRtaW4gVXNlcm5hbWUKICAgICAgICBuYW1lOiBhZG1pbl91c2VyCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSB0aXRsZTogT3BlblNoaWZ0IEFkbWluIFBhc3N3b3JkCiAgICAgICAgbmFtZTogYWRtaW5fcGFzc3dvcmQKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAgIGRpc3BsYXlfdHlwZTogcGFzc3dvcmQKICAgICAgLSB0aXRsZTogRGlzayBJbWFnZSBVUkwKICAgICAgICBuYW1lOiBkaXNrX2ltYWdlX3VybAogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgIC0gdGl0bGU6IE9wZXJhdGluZyBzeXN0ZW0gdHlwZQogICAgICAgIG5hbWU6IG9zX3R5cGUKICAgICAgICBkZWZhdWx0OiBsaW51eAogICAgICAgIGVudW06IFsnbGludXgnLCAnd2luZG93cyddCiAgICAgICAgdHlwZTogZW51bQogICAgICAtIHRpdGxlOiBUZW1wbGF0ZSBOYW1lCiAgICAgICAgbmFtZTogdm1fbmFtZQogICAgICAgIHR5cGU6IHN0cmluZwogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgcGF0dGVybjogIl5bYS16MC05Li1dKiQiCiAgICAgIC0gdGl0bGU6IE51bWJlciBvZiBDb3JlcwogICAgICAgIG5hbWU6IG5yX2NvcmVzCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgICB0eXBlOiBpbnQKICAgICAgICBkZWZhdWx0OiAxCiAgICAgIC0gdGl0bGU6IE1lbW9yeSAoTWlCKQogICAgICAgIG5hbWU6IG1lbQogICAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICAgICAgdHlwZTogaW50CiAgICAgICAgZGVmYXVsdDogMTAyNAogICAgICAtIHRpdGxlOiBEaXNrIFNpemUgKEdpQikgKGxlYXZlIGF0IDAgdG8gYXV0byBkZXRlY3Qgc2l6ZSkKICAgICAgICBuYW1lOiBkaXNrX3NpemVfZ2IKICAgICAgICB0eXBlOiBpbnQKICAgICAgICBkZWZhdWx0OiAwCiAgICAgIC0gdGl0bGU6IFN0b3JhZ2UgQ2xhc3MgKGxlYXZlIGVtcHR5IHRvIHVzZSB0aGUgZGVmYXVsdCBzdG9yYWdlIGNsYXNzKQogICAgICAgIG5hbWU6IHN0b3JhZ2VfY2xhc3MKICAgICAgICB0eXBlOiBzdHJpbmcK\""
            }
          ],
          "Name": "label"
        },
        {
          "CmdLine": [
            "chmod -R g=u /opt/{ansible,apb}"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "yum -y install libvirt-client curl qemu-img wget \u0026\u0026 yum clean all"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "wget https://github.com/openshift/origin/releases/download/v3.9.0/openshift-origin-client-tools-v3.9.0-191fece-linux-64bit.tar.gz"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "tar zxvf openshift-origin-client-tools-v3.9.0-191fece-linux-64bit.tar.gz"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "mv openshift-origin-client-tools-v3.9.0-191fece-linux-64bit/oc /usr/bin"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "rm -rf openshift-origin-client-tools-v3.9.0-191fece-linux-64bit"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "chmod u+x /usr/bin/oc"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "Chown": "",
          "From": "",
          "Name": "copy",
          "SourcesAndDest": [
            "bin/run-v2v.sh",
            "/v2v.d/"
          ]
        },
        {
          "CmdLine": [
            "setfacl -Rm u:apb:rwx /v2v.d"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "Chown": "",
          "From": "",
          "Name": "copy",
          "SourcesAndDest": [
            "playbooks",
            "/opt/apb/actions"
          ]
        },
        {
          "Chown": "",
          "From": "",
          "Name": "copy",
          "SourcesAndDest": [
            "roles",
            "/opt/apb/actions/roles"
          ]
        },
        {
          "Chown": "",
          "From": "",
          "Name": "copy",
          "SourcesAndDest": [
            "templates",
            "/opt/apb/actions/templates"
          ]
        },
        {
          "Name": "user",
          "User": "apb"
        }
      ]
    }
  ]
}