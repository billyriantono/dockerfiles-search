MetaArgs: null
Stages:
- BaseName: boot2docker/boot2docker
  Commands:
  - Env:
    - Key: VBOXVER
      Value: 4.3.14
    Name: env
  - Env:
    - Key: VBOXSHARENAME
      Value: home
    Name: env
  - Env:
    - Key: VBOXSHAREGUESTPATH
      Value: /home/docker/code
    Name: env
  - CmdLine:
    - apt-get install p7zip-full
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /vboxguest &&     cd /vboxguest &&     curl -L -o vboxguest.iso http://download.virtualbox.org/virtualbox/$VBOXVER/VBoxGuestAdditions_$VBOXVER.iso
      &&     7z x vboxguest.iso -ir'!VBoxLinuxAdditions.run' &&     sh VBoxLinuxAdditions.run
      --noexec --target . &&     mkdir x86 && cd x86 && tar xvjf ../VBoxGuestAdditions-x86.tar.bz2
      && cd .. &&     mkdir amd64 && cd amd64 && tar xvjf ../VBoxGuestAdditions-amd64.tar.bz2
      && cd .. &&     cd amd64/src/vboxguest-$VBOXVER && KERN_DIR=/linux-kernel/ make
      && cd ../../.. &&     cp amd64/src/vboxguest-$VBOXVER/*.ko $ROOTFS/lib/modules/$KERNEL_VERSION-tinycore64
      &&     mkdir -p $ROOTFS/sbin && cp x86/lib/VBoxGuestAdditions/mount.vboxsf $ROOTFS/sbin/
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "" >> $ROOTFS/etc/motd;     echo "  boot2docker with VirtualBox guest additions
      version $VBOXVER with Fig 0.5.2" >> $ROOTFS/etc/motd;     echo "" >> $ROOTFS/etc/motd
    Name: run
    PrependShell: true
  - CmdLine:
    - echo '#!/bin/sh' >> $ROOTFS/etc/rc.d/vbox-guest-additions-permanent-mount;     echo
      'sudo modprobe vboxsf && sudo mkdir $VBOXSHAREGUESTPATH && sudo mount -t vboxsf
      $VBOXSHARENAME $VBOXSHAREGUESTPATH' >> $ROOTFS/etc/rc.d/vbox-guest-additions-permanent-mount
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod +x $ROOTFS/etc/rc.d/vbox-guest-additions-permanent-mount
    Name: run
    PrependShell: true
  - CmdLine:
    - echo '/etc/rc.d/vbox-guest-additions-permanent-mount' >> $ROOTFS/opt/bootsync.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - tczex="python python-distribute" &&    for dep in $tczex; do       echo "Download
      $TCL_REPO_BASE/tcz/$dep.tcz" &&      curl -L -o /tmp/$dep.tcz $TCL_REPO_BASE/tcz/$dep.tcz
      &&       unsquashfs -f -d $ROOTFS /tmp/$dep.tcz &&       rm -f /tmp/$dep.tcz;    done
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - python/site-packages/
    - $ROOTFS/usr/local/lib/python2.7/site-packages/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - python/bin/
    - $ROOTFS/usr/local/bin/
  - CmdLine:
    - sed -i "s#append loglevel=3 user=docker console=ttyS0 console=tty0 noembed nomodeset
      norestore waitusb=10:LABEL=boot2docker-data base#append tz=CST-8 loglevel=3
      user=docker console=ttyS0 console=tty0 noembed nomodeset norestore waitusb=10:LABEL=boot2docker-data
      base#g" /isolinux/isolinux.cfg
    Name: run
    PrependShell: true
  - CmdLine:
    - depmod -a -b $ROOTFS $KERNEL_VERSION-tinycore64
    Name: run
    PrependShell: true
  - CmdLine:
    - /make_iso.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - cat
    - boot2docker.iso
    Name: cmd
    PrependShell: false
  From:
    Image: boot2docker/boot2docker
  Name: ""
  Platform: ""
  SourceCode: FROM boot2docker/boot2docker
