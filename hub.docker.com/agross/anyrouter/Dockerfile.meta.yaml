MetaArgs: null
Stages:
- As: server
  BaseName: node:12-alpine
  Commands:
  - Name: workdir
    Path: /server
  - CmdLine:
    - apk add         --no-cache         python         make         g++
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - server/package.json
    - server/yarn.lock
    - ./
  - CmdLine:
    - yarn install          --production          --frozen-lockfile
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - server/
    - .
  - CmdLine:
    - yarn run build
    Name: run
    PrependShell: true
  From:
    Image: node:12-alpine
  Name: server
  Platform: ""
  SourceCode: FROM node:12-alpine AS server
- As: client
  BaseName: node:12-alpine
  Commands:
  - Name: workdir
    Path: /client
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - client/package.json
    - client/yarn.lock
    - ./
  - CmdLine:
    - yarn install          --frozen-lockfile
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - client/
    - .
  - CmdLine:
    - yarn run build &&     yarn run favicon
    Name: run
    PrependShell: true
  From:
    Image: node:12-alpine
  Name: client
  Platform: ""
  SourceCode: FROM node:12-alpine AS client
- BaseName: node:12-alpine
  Commands:
  - Labels:
    - Key: name
      Value: '''anyrouter'''
    Name: label
  - Labels:
    - Key: version
      Value: '''1.0.0'''
    Name: label
  - Labels:
    - Key: maintainer
      Value: '''Alexander Gro√ü <agross@therightstuff.de>'''
    Name: label
  - Name: expose
    Ports:
    - "3000"
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - docker-entypoint
    - /
  - Env:
    - Key: NODE_ENV
      Value: production
    Name: env
  - CmdLine:
    - /docker-entypoint
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - run
    Name: cmd
    PrependShell: false
  - Health:
      StartPeriod: 5000000000
      Test:
      - CMD-SHELL
      - wget -O /dev/null http://localhost:3000 || exit 1
      Timeout: 2000000000
    Name: healthcheck
  - CmdLine:
    - apk add         --no-cache         iptables
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /app
  - Chown: ""
    From: server
    Name: copy
    SourcesAndDest:
    - /server
    - ./
  - Chown: ""
    From: client
    Name: copy
    SourcesAndDest:
    - /client/dist
    - ./client/
  From:
    Image: node:12-alpine
  Name: ""
  Platform: ""
  SourceCode: FROM node:12-alpine
