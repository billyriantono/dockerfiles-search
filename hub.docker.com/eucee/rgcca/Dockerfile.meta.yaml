MetaArgs:
- DefaultValue: latest
  Key: U_VERSION
  ProvidedValue: null
  Value: latest
Stages:
- BaseName: ubuntu:${U_VERSION}
  Commands:
  - Maintainer: Etienne CAMENEN ( iconics@icm-institute.org )
    Name: maintainer
  - Env:
    - Key: TOOL_VERSION
      Value: hotfix/3.1
    Name: env
  - Env:
    - Key: TOOL_NAME
      Value: rgcca_Rpackage
    Name: env
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - Env:
    - Key: PKGS
      Value: libxml2-dev libcurl4-openssl-dev libssl-dev liblapack-dev git texlive-latex-base
        texlive-latex-extra texlive-fonts-recommended texlive-fonts-extra texlive-science
        r-base
    Name: env
  - Env:
    - Key: RPKGS
      Value: RGCCA ggplot2 optparse scales plotly visNetwork igraph devtools rmarkdown
        pander shiny shinyjs
    Name: env
  - Env:
    - Key: _R_CHECK_FORCE_SUGGESTS_
      Value: "FALSE"
    Name: env
  - Labels:
    - Key: Description
      Value: '"Performs multi-variate analysis (PCA, CCA, PLS, RGCCA) and projects
        the variables and samples into a bi-dimensional space."'
    Name: label
  - Labels:
    - Key: tool.version
      Value: '"{TOOL_VERSION}"'
    Name: label
  - Labels:
    - Key: tool
      Value: '"{TOOL_NAME}"'
    Name: label
  - Labels:
    - Key: docker.version
      Value: "1.0"
    Name: label
  - Labels:
    - Key: tags
      Value: '"omics,RGCCA,multi-block"'
    Name: label
  - Labels:
    - Key: EDAM.operation
      Value: '"analysis,correlation,visualisation"'
    Name: label
  - CmdLine:
    - apt-get update -qq &&     apt-get install -y ${PKGS}
    Name: run
    PrependShell: true
  - CmdLine:
    - Rscript -e 'install.packages(commandArgs(TRUE),repos = "http://cran.us.r-project.org")'
      ${RPKGS}
    Name: run
    PrependShell: true
  - CmdLine:
    - "git clone --depth 1 --single-branch --branch $TOOL_VERSION https://github.com/BrainAndSpineInstitute/$TOOL_NAME
      &&     cd $TOOL_NAME && \tgit checkout $TOOL_VERSION &&     R -e 'devtools::document()'
      &&     cd / &&     R -e 'devtools::build_vignettes(\"rgcca_Rpackage\")' &&     R
      CMD build --no-build-vignettes $TOOL_NAME &&     R CMD check rgccaLauncher_1.0.tar.gz
      &&     R -e \"install.packages('rgccaLauncher_1.0.tar.gz', repos = NULL, type
      = 'source')\" && \tapt-get purge -y git g++ && \tapt-get autoremove --purge
      -y && \tapt-get clean && \tmkdir -p /inst/shiny && \tcp -r $TOOL_NAME/inst/extdata/
      $TOOL_NAME/R/ / && \tmv $TOOL_NAME/inst/shiny inst/ && \tmv extdata/ data &&
      \trm -rf /var/lib/{cache,log}/ /tmp/* /var/tmp/* $TOOL_NAME"
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - functional_tests.sh
    - /functional_tests.sh
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - data/
    - /data/
  - CmdLine:
    - chmod +x /functional_tests.sh &&     ./functional_tests.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - Rscript
    - R/launcher.R
    - -h
    Name: entrypoint
    PrependShell: false
  From:
    Image: ubuntu:${U_VERSION}
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:${U_VERSION}
