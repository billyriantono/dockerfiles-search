{
  "MetaArgs": null,
  "Stages": [
    {
      "Name": "lua-builder",
      "BaseName": "alpine:edge",
      "SourceCode": "FROM alpine:edge as lua-builder",
      "Platform": "",
      "As": "lua-builder",
      "From": {
        "Image": "alpine:edge"
      },
      "Commands": [
        {
          "CmdLine": [
            "apk update \u0026\u0026 apk upgrade \u0026\u0026 apk add git gcc luajit-dev make musl-dev"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "mkdir -p /buildroot/usr/lib/lua/5.1 /buildroot/usr/share/lua/5.1"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "Name": "workdir",
          "Path": "/usr/src"
        },
        {
          "CmdLine": [
            "git clone https://github.com/openresty/lua-cjson \u0026\u0026 cd lua-cjson  \u0026\u0026 git reset --hard a03094c5473d9a9764bb486fbe5e99a62d166dae # 2.1.0.6"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "make -C lua-cjson LUA_INCLUDE_DIR=/usr/include/luajit-2.1  \u0026\u0026 cp -v lua-cjson/cjson.so /buildroot/usr/lib/lua/5.1/"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "git clone https://github.com/openresty/lua-resty-string \u0026\u0026 cd lua-resty-string  \u0026\u0026 git reset --hard 2ac7c3bdba55e06bbfd8d76aa981611ffb2cb321 # v0.11"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "git clone https://github.com/pintsized/lua-resty-http \u0026\u0026 cd lua-resty-http  \u0026\u0026 git reset --hard 607ef6b2fbff5112b9acc47d9163635c2fbd8f59 # v0.12"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "git clone https://github.com/bungle/lua-resty-session \u0026\u0026 cd lua-resty-session  \u0026\u0026 git reset --hard 4429a06ffac1724a056fafa954c0394d437b261f # v2.22"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "git clone https://github.com/SkyLothar/lua-resty-jwt \u0026\u0026 cd lua-resty-jwt  \u0026\u0026 git reset --hard ee1d024071f872e2b5a66eaaf9aeaf86c5bab3ed # v0.1.11"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "git clone https://github.com/jkeys089/lua-resty-hmac \u0026\u0026 cd lua-resty-hmac  \u0026\u0026 git reset --hard 989f601acbe74dee71c1a48f3e140a427f2d03ae"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "git clone https://github.com/pingidentity/lua-resty-openidc \u0026\u0026 cd lua-resty-openidc  \u0026\u0026 git reset --hard adbf5093373aea3bf34e1aa25fc273a2d3753bd1 # v1.6.0"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "cp -rv         lua-resty-string/lib/*         lua-resty-http/lib/*         lua-resty-session/lib/*         lua-resty-jwt/lib/*         lua-resty-hmac/lib/*         lua-resty-openidc/lib/*         /buildroot/usr/share/lua/5.1/"
          ],
          "Name": "run",
          "PrependShell": true
        }
      ]
    },
    {
      "Name": "",
      "BaseName": "ilianaw/nginx",
      "SourceCode": "FROM ilianaw/nginx",
      "Platform": "",
      "From": {
        "Image": "ilianaw/nginx"
      },
      "Commands": [
        {
          "Chown": "",
          "From": "lua-builder",
          "Name": "copy",
          "SourcesAndDest": [
            "/buildroot/",
            "/"
          ]
        }
      ]
    }
  ]
}