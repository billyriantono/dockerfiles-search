MetaArgs: null
Stages:
- BaseName: ubuntu:xenial
  Commands:
  - Env:
    - Key: PLATFORM_VERSION
      Value: "83"
    Name: env
  - Env:
    - Key: SERVER_VERSION
      Value: 8.3.9-2170
    Name: env
  - Env:
    - Key: GOSU_VERSION
      Value: "1.7"
    Name: env
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - CmdLine:
    - apt-get -qq update   && apt-get -qq install --yes --no-install-recommends ca-certificates
      wget locales   && `#----- Install the dependencies -----`   && apt-get -qq install
      --yes --no-install-recommends fontconfig imagemagick   && `#----- Deal with
      ttf-mscorefonts-installer -----`   && apt-get -qq install --yes --no-install-recommends
      xfonts-utils cabextract   && wget --quiet --output-document /tmp/ttf-mscorefonts-installer_3.6_all.deb
      http://ftp.us.debian.org/debian/pool/contrib/m/msttcorefonts/ttf-mscorefonts-installer_3.6_all.deb   &&
      dpkg --install /tmp/ttf-mscorefonts-installer_3.6_all.deb   && rm /tmp/ttf-mscorefonts-installer_3.6_all.deb   &&
      `#----- Install gosu -----`   && wget --quiet --output-document /usr/local/bin/gosu
      "https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$(dpkg
      --print-architecture)"   && chmod +x /usr/local/bin/gosu   && gosu nobody true
    Name: run
    PrependShell: true
  - CmdLine:
    - localedef --inputfile ru_RU --force --charmap UTF-8 --alias-file /usr/share/locale/locale.alias
      ru_RU.UTF-8
    Name: run
    PrependShell: true
  - Env:
    - Key: LANG
      Value: ru_RU.utf8
    Name: env
  - Chown: ""
    Name: add
    SourcesAndDest:
    - '*.deb'
    - /tmp/
  - CmdLine:
    - dpkg --install /tmp/1c-enterprise$PLATFORM_VERSION-common_${SERVER_VERSION}_amd64.deb  &&
      dpkg --install /tmp/1c-enterprise$PLATFORM_VERSION-server_${SERVER_VERSION}_amd64.deb  &&
      dpkg --install /tmp/1c-enterprise$PLATFORM_VERSION-ws_${SERVER_VERSION}_amd64.deb  &&
      rm /tmp/*.deb  && mkdir --parent /var/log/1C /home/usr1cv8/.1cv8/1C/1cv8/conf  &&
      chown --recursive usr1cv8:grp1cv8 /var/log/1C /home/usr1cv8
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - container/docker-entrypoint.sh
    - /
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - container/logcfg.xml
    - /home/usr1cv8/.1cv8/1C/1cv8/conf
  - CmdLine:
    - /docker-entrypoint.sh
    Name: entrypoint
    PrependShell: false
  - Name: volume
    Volumes:
    - /home/usr1cv8
  - Name: volume
    Volumes:
    - /var/log/1C
  - Name: expose
    Ports:
    - 1540-1541
    - 1560-1591
  - CmdLine:
    - ragent
    Name: cmd
    PrependShell: false
  From:
    Image: ubuntu:xenial
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:xenial
