MetaArgs: null
Stages:
- BaseName: centos:7
  Commands:
  - Maintainer: Marc Villacorta Morera <marc.villacorta@gmail.com>
    Name: maintainer
  - CmdLine:
    - rpm --import http://mirror.centos.org/centos/7/os/x86_64/RPM-GPG-KEY-CentOS-7
      &&     yum update -y && yum clean all
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - rootfs/etc/yum.repos.d/grafana.repo
    - /etc/yum.repos.d/grafana.repo
  - CmdLine:
    - rpm --import https://packagecloud.io/gpg.key &&     rpm --import https://grafanarel.s3.amazonaws.com/RPM-GPG-KEY-grafana
      &&     yum install -y git grafana && yum clean all
    Name: run
    PrependShell: true
  - CmdLine:
    - git clone https://github.com/grafana/grafana-plugins.git /tmp/grafana-plugins
      &&     cp -r /tmp/grafana-plugins/datasources/prometheus /usr/share/grafana/public/app/plugins/datasource/
      &&     rm -rf /tmp/grafana-plugins
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - rootfs
    - /
  - Name: workdir
    Path: /usr/share/grafana
  - Name: expose
    Ports:
    - "3000"
  - CmdLine:
    - /init
    - /usr/sbin/grafana-server
    - --config=/etc/grafana/grafana.ini
    - cfg:default.paths.logs=/var/log/grafana
    - cfg:default.paths.data=/var/lib/grafana
    - LimitNOFILE=10000
    Name: entrypoint
    PrependShell: false
  From:
    Image: centos:7
  Name: ""
  Platform: ""
  SourceCode: FROM centos:7
