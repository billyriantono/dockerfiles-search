MetaArgs: null
Stages:
- As: tomcat
  BaseName: tomcat:9-jre11-slim
  Commands: null
  From:
    Image: tomcat:9-jre11-slim
  Name: tomcat
  Platform: ""
  SourceCode: FROM tomcat:9-jre11-slim AS tomcat
- BaseName: buzzxu/java:11-slim
  Commands:
  - Labels:
    - Key: MAINTAINER
      Value: buzzxu <downloadxu@163.com>
    Name: label
  - Env:
    - Key: CATALINA_HOME
      Value: /usr/local/tomcat
    Name: env
  - Env:
    - Key: PATH
      Value: $CATALINA_HOME/bin:$PATH
    Name: env
  - Env:
    - Key: TOMCAT_NATIVE_LIBDIR
      Value: $CATALINA_HOME/native-jni-lib
    Name: env
  - Env:
    - Key: LD_LIBRARY_PATH
      Value: ${LD_LIBRARY_PATH:+$LD_LIBRARY_PATH:}$TOMCAT_NATIVE_LIBDIR
    Name: env
  - Chown: ""
    From: tomcat
    Name: copy
    SourcesAndDest:
    - $CATALINA_HOME
    - $CATALINA_HOME
  - Name: workdir
    Path: $CATALINA_HOME
  - CmdLine:
    - apt-get update -qq &&     apt-get upgrade -y &&     apt-get install -qq -y --no-install-recommends
      libapr1 &&     chmod -R +rX . &&     chmod 777 logs work &&     rm -rf /var/lib/apt/lists/*;
    Name: run
    PrependShell: true
  - CmdLine:
    - "set -e \t&& nativeLines=\"$(catalina.sh configtest 2>&1)\" \t&& nativeLines=\"$(echo
      \"$nativeLines\" | grep 'Apache Tomcat Native')\" \t&& nativeLines=\"$(echo
      \"$nativeLines\" | sort -u)\" \t&& if ! echo \"$nativeLines\" | grep 'INFO:
      Loaded APR based Apache Tomcat Native library' >&2; then \t\techo >&2 \"$nativeLines\";
      \t\texit 1; \tfi"
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "8080"
  - CmdLine:
    - catalina.sh
    - run
    Name: cmd
    PrependShell: false
  From:
    Image: buzzxu/java:11-slim
  Name: ""
  Platform: ""
  SourceCode: FROM buzzxu/java:11-slim
