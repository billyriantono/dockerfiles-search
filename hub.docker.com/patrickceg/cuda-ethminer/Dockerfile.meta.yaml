MetaArgs: null
Stages:
- BaseName: nvidia/cuda:8.0-devel-ubuntu16.04
  Commands:
  - CmdLine:
    - apt-get -qq update     && apt-get -yqq --no-install-recommends install software-properties-common     &&
      add-apt-repository -y ppa:ethereum/ethereum
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get -qq update &&     apt-get -yqq --no-install-recommends install     git
      cmake libcryptopp-dev libleveldb-dev libjsoncpp-dev libjsonrpccpp-dev     libboost-all-dev
      libgmp-dev libreadline-dev libcurl4-gnutls-dev     ocl-icd-libopencl1 opencl-headers
      mesa-common-dev libmicrohttpd-dev     build-essential
    Name: run
    PrependShell: true
  - CmdLine:
    - groupadd -r miner --gid=1001     && useradd -r -g miner --uid=1001 miner
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /minerbuild     && chown miner.miner /minerbuild
    Name: run
    PrependShell: true
  - Name: user
    User: miner
  - CmdLine:
    - cd /minerbuild &&     git clone https://github.com/Genoil/cpp-ethereum/
    Name: run
    PrependShell: true
  - CmdLine:
    - cd /minerbuild/cpp-ethereum &&     mkdir build &&     cd build &&     cmake
      -DBUNDLE=cudaminer .. &&     make
    Name: run
    PrependShell: true
  - Name: user
    User: root
  - CmdLine:
    - mkdir /app &&     mkdir /app/lib &&     chown -R miner.miner /app
    Name: run
    PrependShell: true
  - Name: user
    User: miner
  - CmdLine:
    - /bin/bash
    Name: cmd
    PrependShell: false
  - CmdLine:
    - mv /minerbuild/cpp-ethereum/build/ethminer/ethminer /app &&     mv /minerbuild/cpp-ethereum/build/**/*.so
      /app/lib
    Name: run
    PrependShell: true
  - Name: user
    User: root
  - CmdLine:
    - rm -rf /minerbuild
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "/app/lib" > /etc/ld.so.conf.d/app.conf &&     ldconfig
    Name: run
    PrependShell: true
  - Name: user
    User: miner
  - CmdLine:
    - /app/ethminer
    Name: entrypoint
    PrependShell: false
  From:
    Image: nvidia/cuda:8.0-devel-ubuntu16.04
  Name: ""
  Platform: ""
  SourceCode: FROM nvidia/cuda:8.0-devel-ubuntu16.04
