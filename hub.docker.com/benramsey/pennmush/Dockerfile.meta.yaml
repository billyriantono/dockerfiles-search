MetaArgs:
- DefaultValue: '"9.6-slim"'
  Key: debian_tag
  ProvidedValue: null
  Value: '"9.6-slim"'
Stages:
- BaseName: debian:${debian_tag}
  Commands:
  - Env:
    - Key: GAME_DIR
      Value: '"/mush/game"'
    Name: env
  - CmdLine:
    - set -ex     && export DEBIAN_FRONTEND=noninteractive     && mkdir -p /usr/share/man/man1     &&
      mkdir -p /usr/share/man/man7     && apt-get update     && apt-get upgrade -y     &&
      apt-get install -y         autoconf         binutils-dev         build-essential         ca-certificates         ed         gawk         gettext         git         gperf         icu-devtools         libc6-dev         libevent-dev         libgettextpo-dev         libgnutls28-dev         libicu-dev         libidn2-0-dev         libldap2-dev         libmariadbclient-dev         libmariadbclient-dev-compat         libnghttp2-dev         libpcre3-dev         libpq-dev         libpsl-dev         libsqlite3-dev         libssh2-1-dev         libssl-dev         libuptimed-dev         locales-all         mariadb-client         perl-base         pkg-config         postgresql-client         sendmail         wamerican         zlib1g-dev
    Name: run
    PrependShell: true
  - Key: curl_version
    Name: arg
    Value: '"7.64.0"'
  - CmdLine:
    - set -ex     && curl -L -o /tmp/curl-${curl_version}.tar.gz https://curl.haxx.se/download/curl-${curl_version}.tar.gz     &&
      apt-get remove -y curl     && apt-get autoremove -y     && cd /tmp && tar zxf
      curl-${curl_version}.tar.gz && cd /tmp/curl-${curl_version}     && ./configure         --prefix=/usr         --enable-ipv6         --with-gnutls         --with-ldap         --with-ldaps         --with-libidn2         --with-libssh2         --with-nghttp2         --with-zlib     &&
      make     && make install     && ldconfig
    Name: run
    PrependShell: true
  - Key: pennmush_version
    Name: arg
    Value: '"187p0"'
  - CmdLine:
    - set -ex     && adduser --disabled-password --gecos '' mush     && mkdir -p /mush
      && chown mush.mush /mush     && su -c 'git clone https://github.com/pennmush/pennmush.git
      /mush' mush     && su -c 'cd /mush && git checkout ${pennmush_version}' mush     &&
      su -c 'cd /mush         &&         CFLAGS=-Wno-pragmas         SENDMAIL=/usr/sbin/sendmail         ./configure             --enable-ssl_slave             --enable-nls             --with-pcre'
      mush     && su -c 'cd /mush         && make update all install         && make
      portmsg' mush     && su -c 'mv /mush/game /mush/game.original' mush
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /mush
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - '*.sh'
    - /usr/bin/
  - CmdLine:
    - set -ex     && ln -s /usr/bin/reboot.sh /usr/bin/reboot     && ln -s /usr/bin/reboot.sh
      /usr/bin/restart     && ln -s /usr/bin/shutdown.sh /usr/bin/shutdown
    Name: run
    PrependShell: true
  - CmdLine:
    - entrypoint.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: debian:${debian_tag}
  Name: ""
  Platform: ""
  SourceCode: FROM debian:${debian_tag}
