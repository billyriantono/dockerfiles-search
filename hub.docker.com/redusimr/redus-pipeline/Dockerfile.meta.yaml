MetaArgs: null
Stages:
- BaseName: redusimr/rstox:edge
  Commands:
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./misc/run.sh
    - ./misc/filebrowser.json
    - ./misc/allrevproxy.conf
    - /etc/
  - CmdLine:
    - "apk add --no-cache --virtual builddep    R-dev     g++     cmake     json-c-dev
      \    bsd-compat-headers     openssl-dev     libwebsockets-dev     vim     zlib-dev
      \   build-base     bash     curl   && apk add --no-cache     gcompat     json-c
      \    libssl1.1     libcrypto1.1     libwebsockets     nginx     bash     make
      \    screen   && curl -fsSL https://filebrowser.xyz/get.sh | bash   && cd /tmp
      \  && wget https://github.com/tsl0922/ttyd/archive/1.5.2.tar.gz   && tar -zxvf
      1.5.2.tar.gz   && cd ttyd-1.5.2   && mkdir -p build   && cd build   && cmake
      .. \t\t-DCMAKE_BUILD_TYPE=MinSizeRel \t\t-DCMAKE_INSTALL_PREFIX=/usr \t\t-DCMAKE_VERBOSE_MAKEFILE=TRUE
      \  && make   && make install   && cd /   && wget https://github.com/mthenw/frontail/releases/download/v4.8.0/frontail-alpine
      -O /usr/local/bin/frontail   && chmod +x /usr/local/bin/frontail   && chmod
      +x /etc/run.sh   && mv /etc/allrevproxy.conf /etc/nginx/conf.d/   && mkdir -p
      /root/workspace   && mkdir -p /run/nginx   && Rscript -e 'install.packages(c(\"icesTAF\",
      \"areaplot\"))'              -e 'install.packages(c(\"config\", \"memisc\",
      \"knitr\", \"httr\"))'              -e 'install.packages(c(\"TMB\", \"ellipse\",
      \"RcppEigen\"))'              -e 'install.packages(c(\"desc\", \"filelock\"))'
      \  && cd /tmp   && curl -O https://codeload.github.com/REDUS-IMR/REDUStools/tar.gz/master
      \  && tar -zxvf master   && R CMD INSTALL REDUStools-master   && apk del --no-cache
      builddep   && rm -rf /tmp/*"
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "8888"
  - CmdLine:
    - /etc/run.sh
    Name: cmd
    PrependShell: false
  From:
    Image: redusimr/rstox:edge
  Name: ""
  Platform: ""
  SourceCode: FROM redusimr/rstox:edge
