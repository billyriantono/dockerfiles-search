MetaArgs: null
Stages:
- BaseName: openjdk:8
  Commands:
  - Maintainer: vitalcode
    Name: maintainer
  - CmdLine:
    - apt-get update &&     apt-get -y install jq
    Name: run
    PrependShell: true
  - Env:
    - Key: ZK_VERSION
      Value: 3.4.10
    Name: env
  - Env:
    - Key: ZK_FILE
      Value: '"zookeeper-${ZK_VERSION}"'
    Name: env
  - Env:
    - Key: ZK_ARCHIVE_PATH
      Value: '"/tmp/${ZK_FILE}.tar.gz"'
    Name: env
  - Env:
    - Key: ZK_HOME
      Value: '"/opt/zookeeper"'
    Name: env
  - CmdLine:
    - APACHE_MIRROR=$(curl --stderr /dev/null https://www.apache.org/dyn/closer.cgi\?as_json\=1
      | jq -r ".preferred") &&     ZK_URL="${APACHE_MIRROR}/zookeeper/zookeeper-${ZK_VERSION}/zookeeper-${ZK_VERSION}.tar.gz"
      &&     wget "${ZK_URL}" -O ${ZK_ARCHIVE_PATH} &&     tar xfz ${ZK_ARCHIVE_PATH}
      -C /opt &&     ln -s /opt/${ZK_FILE} ${ZK_HOME}
    Name: run
    PrependShell: true
  - CmdLine:
    - mv ${ZK_HOME}/conf/zoo_sample.cfg ${ZK_HOME}/conf/zoo.cfg
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i "s|/tmp/zookeeper|$ZK_HOME/data|g" $ZK_HOME/conf/zoo.cfg; mkdir $ZK_HOME/data
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -r 's|#(log4j.appender.ROLLINGFILE.MaxBackupIndex.*)|\1|g' $ZK_HOME/conf/log4j.properties
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -r 's|#autopurge|autopurge|g' $ZK_HOME/conf/zoo.cfg
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - start-zk.sh
    - /usr/bin/
  - CmdLine:
    - chmod +x /usr/bin/start-zk.sh
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "2181"
    - "2888"
    - "3888"
  - CmdLine:
    - start-zk.sh
    Name: cmd
    PrependShell: false
  From:
    Image: openjdk:8
  Name: ""
  Platform: ""
  SourceCode: FROM openjdk:8
