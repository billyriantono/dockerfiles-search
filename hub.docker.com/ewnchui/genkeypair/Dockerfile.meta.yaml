MetaArgs: null
Stages:
- BaseName: node
  Commands:
  - Env:
    - Key: VER
      Value: ${VER:-master}
    - Key: REPO
      Value: https://github.com/ewnchui/genKeyPair
    - Key: APP
      Value: /usr/src/app
    Name: env
  - CmdLine:
    - apt-get update &&  apt-get -y install git openssl &&  apt-get clean &&  git
      clone -b $VER $REPO $APP
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /usr/src/app
  - CmdLine:
    - sed 's/^emailAddress.*=.*optional$/emailAddress = match/g' < /etc/ssl/openssl.cnf
      | sed 's/^stateOrProvinceName.*=.*match$/stateOrProvinceName = optional/g' >/tmp/$$
      &&  mv /tmp/$$ /etc/ssl/openssl.cnf &&  npm install &&  node_modules/.bin/bower
      install --allow-root
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "1337"
  - CmdLine:
    - ./entrypoint.sh
    Name: entrypoint
    PrependShell: true
  From:
    Image: node
  Name: ""
  Platform: ""
  SourceCode: FROM node
