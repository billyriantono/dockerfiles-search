MetaArgs: null
Stages:
- BaseName: centos:7
  Commands:
  - CmdLine:
    - yum install -y     openldap     openldap-clients     openldap-servers   && yum
      clean all
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./samba.schema
    - /etc/openldap/schema/samba.schema
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./schema.conf
    - /schema.conf
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./setup.ldif
    - /setup.ldif
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./DB_CONFIG
    - /var/lib/ldap/DB_CONFIG
  - CmdLine:
    - slaptest -f /schema.conf -F /etc/openldap/slapd.d   && chown -R ldap:ldap /etc/openldap/slapd.d   &&
      chown -R ldap:ldap /var/lib/ldap   && slapd -u ldap -h ldapi:///   && sleep
      10   && ldapmodify -H ldapi:/// -f /setup.ldif   && rm -f /schema.conf /setup.ldif
    Name: run
    PrependShell: true
  - CmdLine:
    - slapd
    - -d
    - "32768"
    - -u
    - ldap
    - -h
    - ldapi:/// ldap:///
    Name: cmd
    PrependShell: false
  - Name: expose
    Ports:
    - "389"
    - "636"
  - Name: volume
    Volumes:
    - /var/lib/ldap
    - /etc/openldap
  From:
    Image: centos:7
  Name: ""
  Platform: ""
  SourceCode: FROM centos:7
