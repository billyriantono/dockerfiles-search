MetaArgs: null
Stages:
- BaseName: php:7.4-fpm-alpine
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"Engenharia Arquivei <engenharia@arquivei.com.br>"'
    Name: label
  - Key: RDKAFKA_VERSION
    Name: arg
    Value: '"1.1.0"'
  - Key: RDKAFKA_PECL_VERSION
    Name: arg
    Value: '"3.1.2"'
  - CmdLine:
    - set -xe     && apk update     && apk --no-cache --virtual .build-deps add         autoconf
      bash build-base pcre-dev python     && apk --no-cache add libzip-dev libxml2-dev
      postgresql-dev libstdc++     && docker-php-ext-install bcmath pdo_pgsql pdo_mysql
      soap zip
    Name: run
    PrependShell: true
  - CmdLine:
    - pecl install grpc && docker-php-ext-enable grpc     && pecl install redis &&
      docker-php-ext-enable redis
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /tmp/librdkafka     && cd /tmp     && curl -L https://github.com/edenhill/librdkafka/archive/v${RDKAFKA_VERSION}.tar.gz
      | tar xz -C /tmp/librdkafka --strip-components=1     && cd librdkafka     &&
      ./configure     && make     && make install     && pecl install rdkafka-${RDKAFKA_PECL_VERSION}     &&
      docker-php-ext-enable rdkafka     && rm -rf /tmp/librdkafka     && apk del .build-deps
    Name: run
    PrependShell: true
  From:
    Image: php:7.4-fpm-alpine
  Name: ""
  Platform: ""
  SourceCode: FROM php:7.4-fpm-alpine
