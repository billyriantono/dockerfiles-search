{
  "MetaArgs": null,
  "Stages": [
    {
      "Name": "",
      "BaseName": "debian:stable-slim",
      "SourceCode": "FROM debian:stable-slim",
      "Platform": "",
      "From": {
        "Image": "debian:stable-slim"
      },
      "Commands": [
        {
          "Labels": [
            {
              "Key": "name",
              "Value": "\"pkg-cacher\""
            },
            {
              "Key": "version",
              "Value": "\"1.1.1\""
            },
            {
              "Key": "maintainer",
              "Value": "\"Reto Gantenbein \u003creto.gantenbein@linuxmonk.ch\u003e\""
            }
          ],
          "Name": "label"
        },
        {
          "CmdLine": [
            "apt-get update         \u0026\u0026 apt-get install -y --no-install-recommends --no-install-suggests             bzip2             libwww-curl-perl             libwww-perl             libdigest-sha-perl             libclass-accessor-perl             libdbi-perl             libdbd-sqlite3-perl             libxml-simple-perl             libxml-twig-perl             libio-compress-lzma-perl         \u0026\u0026 apt-get clean         \u0026\u0026 rm -rf /var/lib/apt/lists/*"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "install -m 755 -d /etc/pkg-cacher         \u0026\u0026 install -m 755 -d /usr/share/pkg-cacher/Repos         \u0026\u0026 install -m 755 -d /var/cache/pkg-cacher         \u0026\u0026 install -m 755 -d /var/log/pkg-cacher"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "Chown": "",
          "From": "",
          "Name": "copy",
          "SourcesAndDest": [
            "pkg-cacher.conf",
            "/etc/pkg-cacher/"
          ]
        },
        {
          "Chown": "",
          "From": "",
          "Name": "copy",
          "SourcesAndDest": [
            "pkg-cacher",
            "pkg-cacher.pl",
            "pkg-cacher-cleanup.pl",
            "pkg-cacher-fetch.pl",
            "pkg-cacher-lib.pl",
            "pkg-cacher-report.pl",
            "pkg-cacher-request.pl",
            "Repos.pm",
            "index_files.regexp",
            "static_files.regexp",
            "/usr/share/pkg-cacher/"
          ]
        },
        {
          "Chown": "",
          "From": "",
          "Name": "copy",
          "SourcesAndDest": [
            "Repos/Debian.pm",
            "Repos/Fedora.pm",
            "/usr/share/pkg-cacher/Repos/"
          ]
        },
        {
          "CmdLine": [
            "ln -sf /usr/share/pkg-cacher/pkg-cacher /usr/sbin/pkg-cacher"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "ln -sf /dev/stdout /var/log/pkg-cacher/access.log         \u0026\u0026 ln -sf /dev/stderr /var/log/pkg-cacher/error.log"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "Name": "volume",
          "Volumes": [
            "/var/cache/pkg-cacher"
          ]
        },
        {
          "Name": "expose",
          "Ports": [
            "8080"
          ]
        },
        {
          "CmdLine": [
            "/usr/sbin/pkg-cacher user=$(id -un) group=$(id -gn) daemon_port=8080"
          ],
          "Name": "cmd",
          "PrependShell": true
        }
      ]
    }
  ]
}