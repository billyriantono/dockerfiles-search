MetaArgs: null
Stages:
- BaseName: debian:stable
  Commands:
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - sources.list.d/
    - /etc/apt/sources.list.d
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - preferences.d/
    - /etc/apt/preferences.d
  - CmdLine:
    - apt-get update     && apt-get install -y         gcc         git         wget         maven         bzip2         python         python-dev         openjdk-8-jdk     &&
      rm -rf /var/lib/apt/lists
    Name: run
    PrependShell: true
  - Env:
    - Key: JAVA_HOME
      Value: /usr/lib/jvm/java-1.8.0-openjdk-amd64/
    Name: env
  - CmdLine:
    - wget http://www.apache.org/dist/ambari/ambari-2.7.3/apache-ambari-2.7.3-src.tar.gz     &&
      tar xfvz apache-ambari-2.7.3-src.tar.gz     && cd apache-ambari-2.7.3-src     &&
      sed -i -re "s/http:(.*nexus-private.*)/https:\1/" ambari-metrics/pom.xml     &&
      mvn versions:set -DnewVersion=2.7.3.0.0     && cd ambari-metrics     && mvn
      versions:set -DnewVersion=2.7.3.0.0     && cd -     && mvn -B clean install
      jdeb:jdeb -DnewVersion=2.7.3.0.0 -DbuildNumber=4295bb16c439cbc8fb0e7362f19768dde1477868
      -DskipTests -Dpython.ver="python >= 2.6"     && apt-get update     && apt-get
      install -y expect ./ambari-server/target/*.deb     && rm -rf /var/lib/apt/lists     &&
      cd /     && rm -rf apache-ambari-2.7.3-src
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - setup-server
    - setup-server
  - CmdLine:
    - ./setup-server     && rm setup-server     && echo "ambari-server.user=root"
      >> /etc/ambari-server/conf/ambari.properties
    Name: run
    PrependShell: true
  - CmdLine:
    - ambari-server start     && PID=$(cat /var/run/ambari-server/ambari-server.pid);        if
      [ -z "$PID" ]; then          tail -f --pid=$PID /var/log/ambari-server/ambari-server.out;        fi
    Name: entrypoint
    PrependShell: true
  From:
    Image: debian:stable
  Name: ""
  Platform: ""
  SourceCode: FROM debian:stable
