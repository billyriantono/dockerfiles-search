MetaArgs: null
Stages:
- BaseName: jameseckersall/alpine-base
  Commands:
  - Maintainer: James Eckersall <james.eckersall@gmail.com>
    Name: maintainer
  - CmdLine:
    - echo -e "@edge http://nl.alpinelinux.org/alpine/edge/main\n@testing http://nl.alpinelinux.org/alpine/edge/testing\n"
      >> /etc/apk/repositories &&   echo -e "@community http://nl.alpinelinux.org/alpine/edge/community"
      >> /etc/apk/repositories &&   apk update &&   apk add bash curl gettext inotify-tools
      vlc nginx php5 php5-common php5-fpm php5-gd php5-phar php5-gettext php5-curl
      php5-iconv php5-json php5-openssl libressl2.4-libcrypto@edge libressl2.4-libssl@edge
      php5-pdo php5-pdo_mysql php5-xml php5-zlib pwgen lame libvorbis-dev flac libtheora-dev
      libvpx-dev git
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -o /tmp/composer-setup.php https://getcomposer.org/installer &&   cd /tmp
      &&   php -r "if (hash_file('SHA384', '/tmp/composer-setup.php') === 'aa96f26c2b67226a324c27919f1eb05f21c248b987e6195cad9690d5c1ff713d53020a02ac8c217dbf90a7eacc9d141d')
      { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('/tmp/composer-setup.php');
      } echo PHP_EOL;" &&   php /tmp/composer-setup.php &&   rm /tmp/composer-setup.php
      &&   git clone https://github.com/ampache/ampache /www &&   /tmp/composer.phar
      -d=/www install --prefer-source --no-interaction
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - files
    - /
  - CmdLine:
    - mkdir -p /run /run/nginx /www /var/log/ampache &&   chmod 0644 /etc/crontabs/root
      &&   chmod 0755 -R /mediawatch.sh /etc/periodic &&   chmod 0777 -R /run /var/log
      /var/log/ampache /var/log/nginx /var/lib/nginx /www &&   sed -i     -e '/^listen\.owner
      =.*/d'     -e '/^listen\.group =.*/d'     /etc/php5/php-fpm.conf
    Name: run
    PrependShell: true
  - Env:
    - Key: AMPACHE_TAG
      Value: 3.8.2
    - Key: AMPACHE_USER
      Value: admin
    - Key: AMPACHE_PASS
      Value: changeme
    - Key: AMPACHE_USER_EMAIL
      Value: admin@example.com
    - Key: AMPACHE_USER_NAME
      Value: admin
    - Key: HTTP_HOST
      Value: localhost
    - Key: HTTP_PORT
      Value: "8080"
    - Key: MYSQL_HOST
      Value: localhost
    - Key: MYSQL_PORT
      Value: "3306"
    - Key: MYSQL_DB
      Value: ampache
    - Key: MYSQL_USER
      Value: ampache
    - Key: MYSQL_PASS
      Value: ampache
    Name: env
  - Name: expose
    Ports:
    - "8080"
  - Name: volume
    Volumes:
    - /media
  From:
    Image: jameseckersall/alpine-base
  Name: ""
  Platform: ""
  SourceCode: FROM jameseckersall/alpine-base
