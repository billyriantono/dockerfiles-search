MetaArgs: null
Stages:
- BaseName: tomcat:7.0.69-jre8
  Commands:
  - Maintainer: Thomas Steinbach (@aikq.de)
    Name: maintainer
  - CmdLine:
    - apt-get update &&             DEBIAN_FRONTEND=noninteractive apt-get install
      -y               texlive-binaries               dvipsk-ja               imagemagick-common
      &&             apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - rm -rf /usr/local/tomcat/webapps/ROOT &&     rm -rf /usr/local/tomcat/webapps/docs
      &&     rm -rf /usr/local/tomcat/webapps/manager &&     rm -rf /usr/local/tomcat/webapps/examples
      &&     rm -rf /usr/local/tomcat/webapps/host-manager
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -o /tmp/xwiki.war -SL 'http://download.forge.ow2.org/xwiki/xwiki-enterprise-web-7.4.5.war'
      &&     unzip -qq /tmp/xwiki.war -d /usr/local/tomcat/webapps/ROOT &&     rm
      /tmp/xwiki.war
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -SL 'https://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-5.1.39.tar.gz'
      |       tar xzf - --strip=1 -C /usr/local/tomcat/lib mysql-connector-java-5.1.39/mysql-connector-java-5.1.39-bin.jar
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - files/tomcat_conf/context.xml
    - /usr/local/tomcat/conf/context.xml
  - CmdLine:
    - echo 'export JAVA_OPTS="${JAVA_OPTS} -Djava.awt.headless=true"' >> /usr/local/tomcat/bin/setenv.sh
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - files/xwiki_cfg/hibernate.cfg.xml
    - /usr/local/tomcat/webapps/ROOT/WEB-INF/hibernate.cfg.xml
  - Chown: ""
    Name: add
    SourcesAndDest:
    - files/system/xwiki-config-replace.sh
    - /usr/local/bin/xwiki-config-replace.sh
  - Chown: ""
    Name: add
    SourcesAndDest:
    - files/system/xwiki-set-cfg
    - /usr/local/bin/xwiki-set-cfg
  - Chown: ""
    Name: add
    SourcesAndDest:
    - files/system/xwiki-set-property
    - /usr/local/bin/xwiki-set-property
  - CmdLine:
    - cd /usr/local/bin && chmod 0755 xwiki-config-replace.sh xwiki-set-cfg xwiki-set-property
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /xwiki_data
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /xwiki_data
  - Chown: ""
    Name: add
    SourcesAndDest:
    - files/system/start.sh
    - /usr/local/bin/start.sh
  - CmdLine:
    - chmod 0755 /usr/local/bin/start.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - start.sh
    Name: cmd
    PrependShell: false
  From:
    Image: tomcat:7.0.69-jre8
  Name: ""
  Platform: ""
  SourceCode: FROM tomcat:7.0.69-jre8
