MetaArgs: null
Stages:
- BaseName: patricol/gui_base_initial:arch
  Commands:
  - Env:
    - Key: RESOLUTION
      Value: '"1920x1080"'
    Name: env
  - Env:
    - Key: PASSWORD
      Value: '"Password"'
    Name: env
  - Env:
    - Key: RDP_OR_VNC
      Value: '"RDP"'
    Name: env
  - CmdLine:
    - sudo touch /scripts/vnc_start /scripts/rdp_start /scripts/startapp  && sudo
      chown user:users /scripts/*  && chmod +x /scripts/*  && sort-mirrors  && addpackages
      tigervnc  && mkdir -p ~/.vnc  && touch ~/.vnc/passwd  && echo '#!/bin/bash'
      >> ~/.vnc/xstartup  && echo 'exec i3' >> ~/.vnc/xstartup  && chmod -R go-rwx
      ~/.vnc  && chmod 755 ~/.vnc/xstartup  && echo "echo \"\$PASSWORD\" | vncpasswd
      -f >> ~/.vnc/passwd" >> /scripts/vnc_start  && echo "sudo rm -f /tmp/.X0-lock
      /tmp/.X11-unix/X0" >> /scripts/vnc_start  && echo "vncserver :0 -fg -geometry
      \$RESOLUTION" >> /scripts/vnc_start  && addpackages xrdp  && echo "i3" > ~/.xsession  &&
      echo 'export QT_XKB_CONFIG_ROOT=/usr/share/X11/locale' | sudo tee -a /etc/profile  &&
      echo 'echo "user:$PASSWORD" | sudo chpasswd' >> /scripts/rdp_start  && echo
      "sudo xrdp-sesman" >> /scripts/rdp_start  && echo "sudo xrdp --nodaemon" >>
      /scripts/rdp_start  && echo 'case "$RDP_OR_VNC" in "RDP") rdp_start;; "VNC")
      vnc_start;; "DEBUG") bash;; *) rdp_start;; esac' > /scripts/start  && clearcache
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "3389"
  - Name: expose
    Ports:
    - "5900"
  From:
    Image: patricol/gui_base_initial:arch
  Name: ""
  Platform: ""
  SourceCode: FROM patricol/gui_base_initial:arch
