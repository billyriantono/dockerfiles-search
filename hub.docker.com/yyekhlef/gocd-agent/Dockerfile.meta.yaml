MetaArgs: null
Stages:
- BaseName: centos:7
  Commands:
  - Maintainer: '"GoCD" <gocd-dev@googlegroups.com>'
    Name: maintainer
  - Maintainer: Youcef Yekhlef <youcef.yekhlef@zenika.com>
    Name: maintainer
  - Key: GO_VERSION
    Name: arg
    Value: '"16.8.0-3929"'
  - Key: DOWNLOAD_URL
    Name: arg
    Value: '"https://download.go.cd/binaries"'
  - Env:
    - Key: TINI_VERSION
      Value: v0.9.0
    Name: env
  - CmdLine:
    - 'yum update -y &&     yum install -y wget &&     wget --no-cookies --no-check-certificate     --header
      "Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie"     "http://download.oracle.com/otn-pub/java/jdk/8u102-b14/jdk-8u102-linux-x64.rpm"
      &&     yum localinstall -y jdk-8u102-linux-x64.rpm &&     rm -f jdk-8u102-linux-x64.rpm
      &&     yum clean all'
    Name: run
    PrependShell: true
  - CmdLine:
    - (cd /lib/systemd/system/sysinit.target.wants/; for i in *; do [ $i == systemd-tmpfiles-setup.service
      ] || rm -f $i; done); rm -f /lib/systemd/system/multi-user.target.wants/*;rm
      -f /etc/systemd/system/*.wants/*;rm -f /lib/systemd/system/local-fs.target.wants/*;
      rm -f /lib/systemd/system/sockets.target.wants/*udev*; rm -f /lib/systemd/system/sockets.target.wants/*initctl*;
      rm -f /lib/systemd/system/basic.target.wants/*;rm -f /lib/systemd/system/anaconda.target.wants/*;
      yum install -y java-1.8.0-openjdk-headless git;
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /sys/fs/cgroup
  - Chown: ""
    Name: add
    SourcesAndDest:
    - https://github.com/krallin/tini/releases/download/${TINI_VERSION}/tini
    - /tini
  - CmdLine:
    - chmod +x /tini
    Name: run
    PrependShell: true
  - CmdLine:
    - /tini
    - --
    Name: entrypoint
    PrependShell: false
  - Chown: ""
    Name: add
    SourcesAndDest:
    - $DOWNLOAD_URL/$GO_VERSION/rpm/go-agent-$GO_VERSION.noarch.rpm
    - /tmp/go-agent.rpm
  - Name: workdir
    Path: /tmp
  - CmdLine:
    - yum install -y /tmp/go-agent.rpm; yum clean all; rm -f /etc/default/go-server
    Name: run
    PrependShell: true
  - Env:
    - Key: JAVA_HOME
      Value: /usr/lib/jvm/java-8-oracle/
    Name: env
  - CmdLine:
    - PRODUCTION_MODE=N /usr/share/go-agent/agent.sh
    Name: cmd
    PrependShell: true
  From:
    Image: centos:7
  Name: ""
  Platform: ""
  SourceCode: FROM centos:7
