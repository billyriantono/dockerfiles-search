MetaArgs:
- DefaultValue: alpine
  Key: BASE_DIST
  ProvidedValue: null
  Value: alpine
- DefaultValue: 0.0.6-customAF
  Key: BASE_TAG
  ProvidedValue: null
  Value: 0.0.6-customAF
- DefaultValue: ""
  Key: BASE_TEST
  ProvidedValue: null
  Value: ""
Stages:
- BaseName: wongwill86/air-tasks:base-${BASE_DIST}-${BASE_TAG}${BASE_TEST}
  Commands:
  - Maintainer: wongwill86
    Name: maintainer
  - Key: BASE_DIST
    Name: arg
    Value: null
  - Key: BASE_TAG
    Name: arg
    Value: null
  - Key: AIRFLOW_HOME
    Name: arg
    Value: /usr/local/airflow
  - Env:
    - Key: AIRFLOW_HOME
      Value: ${AIRFLOW_HOME}
    Name: env
  - Key: AIRFLOW_USER
    Name: arg
    Value: airflow
  - Env:
    - Key: AIRFLOW_USER
      Value: ${AIRFLOW_USER}
    Name: env
  - Name: workdir
    Path: ${AIRFLOW_HOME}
  - CmdLine:
    - mkdir -p ${AIRFLOW_HOME}/version
    Name: run
    PrependShell: true
  - CmdLine:
    - cp -r /version ${AIRFLOW_HOME}
    Name: run
    PrependShell: true
  - CmdLine:
    - "groupadd -r ${AIRFLOW_USER}     && useradd -r -d ${AIRFLOW_HOME} -g ${AIRFLOW_USER}
      -s /bin/bash ${AIRFLOW_USER}     && chown -R ${AIRFLOW_USER}: ${AIRFLOW_HOME}
      \    && usermod -aG docker ${AIRFLOW_USER}     && echo \"${AIRFLOW_USER} ALL=NOPASSWD:
      ALL\" >> /etc/sudoers \t&& pip install chunkblocks"
    Name: run
    PrependShell: true
  - CmdLine:
    - cp /.docker/ .docker -r
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - .
  - CmdLine:
    - 'cat .git/refs/$(cat .git/HEAD | sed -e''s/ref: refs\///g'') > version/COMMIT     &&
      grep $(cat version/COMMIT) .git/refs/tags/* -l | xargs -n 1 -r basename > version/TAGS     &&
      mv version/COMMIT version/air-tasks.COMMIT.${BASE_DIST}-${BASE_TAG}     && mv
      version/TAGS version/air-tasks.TAGS.${BASE_DIST}-${BASE_TAG}'
    Name: run
    PrependShell: true
  - Name: user
    User: ${AIRFLOW_USER}
  - Name: workdir
    Path: ${AIRFLOW_HOME}
  - CmdLine:
    - scripts/entrypoint-dood.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: wongwill86/air-tasks:base-${BASE_DIST}-${BASE_TAG}${BASE_TEST}
  Name: ""
  Platform: ""
  SourceCode: FROM wongwill86/air-tasks:base-${BASE_DIST}-${BASE_TAG}${BASE_TEST}
