MetaArgs: null
Stages:
- BaseName: ubuntu:18.04
  Commands:
  - Maintainer: lion <lion.net@163.com>
    Name: maintainer
  - Key: DEBIAN_FRONTEND
    Name: arg
    Value: noninteractive
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - files/
    - /
  - CmdLine:
    - "apt-get update -y \t&& apt-get -y upgrade \t&& apt-get -o Dpkg::Options::=--force-confdef
      -y install software-properties-common \t&& add-apt-repository ppa:apt-fast/stable
      \t&& apt-get update -y \t&& apt-get -y install apt-fast axel"
    Name: run
    PrependShell: true
  - CmdLine:
    - "apt-fast -o Dpkg::Options::=--force-confdef -y install curl netcat wget telnet
      vim bzip2 ssmtp locales python-pip  bash-completion net-tools iputils-ping \t&&
      locale-gen en_US.utf8 \t&& localedef -i en_US -c -f UTF-8 -A /usr/share/locale/locale.alias
      en_US.UTF-8 \t&& chmod -R 777 /var/run /var/log /etc/passwd /etc/group \t&&
      pip --no-cache install --upgrade pip"
    Name: run
    PrependShell: true
  - CmdLine:
    - "apt-fast install -y tzdata \t&& ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
      \t&& echo \"Asia/Shanghai\" > /etc/timezone \t&& dpkg-reconfigure -f noninteractive
      tzdata"
    Name: run
    PrependShell: true
  - CmdLine:
    - useradd -r -m work     && echo "work:123456" | chpasswd     && echo "root:123456"
      | chpasswd
    Name: run
    PrependShell: true
  - CmdLine:
    - "apt-fast install -y supervisor \t&& mkdir -p /home/work/_app/supervisord/conf.d/
      /home/work/_logs/supervisord/ \t&& echo_supervisord_conf > /home/work/_app/supervisord/supervisord.ini
      \t&& echo \"[include]\" >> /home/work/_app/supervisord/supervisord.ini     &&
      echo \"files = /home/work/_app/supervisord/conf.d/*.ini\" >> /home/work/_app/supervisord/supervisord.ini
      \    && sed -i \"s/\\/tmp\\/supervisord.pid/\\/var\\/run\\/supervisord.pid/\"
      /home/work/_app/supervisord/supervisord.ini     && sed -i \"s/logfile=\\/tmp\\/supervisord.log/logfile=\\/home\\/work\\/_logs\\/supervisord\\/supervisord.log/\"
      /home/work/_app/supervisord/supervisord.ini     && sed -i \"s/\\/etc\\/supervisor\\/supervisord.conf/\\/home\\/work\\/_app\\/supervisord\\/supervisord.ini/\"
      /etc/init.d/supervisor"
    Name: run
    PrependShell: true
  - CmdLine:
    - "chmod 755 /hooks \t&& chown -R work:work /home/work/* \t&& apt-get -y clean
      \  \t&& rm -rf /var/lib/apt/lists/*   \t&& rm -rf /var/cache/apt/archives/apt-fast/*
      \  \t&& rm -rf /home/work/_src/*"
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /home/work
  - Env:
    - Key: LC_ALL
      Value: en_US.UTF-8
    - Key: LANG
      Value: en_US.UTF-8
    - Key: LANGUAGE
      Value: en_US.UTF-8
    Name: env
  - CmdLine:
    - /bin/bash
    - -e
    - /init/entrypoint
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - run
    Name: cmd
    PrependShell: false
  From:
    Image: ubuntu:18.04
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:18.04
