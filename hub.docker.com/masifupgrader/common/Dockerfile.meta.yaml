MetaArgs: null
Stages:
- BaseName: debian:9
  Commands:
  - Name: shell
    Shell:
    - /bin/bash
    - -exo
    - pipefail
    - -c
  - CmdLine:
    - "apt-get update ;\tDEBIAN_FRONTEND=noninteractive apt-get install --no-install-{recommends,suggests}
      -y \t\tgit ca-certificates openssl ;\tpushd /opt ;\tgit clone https://github.com/OpenVPN/easy-rsa.git
      ;\tpushd easy-rsa ;\tgit checkout b38f65927c377c8bb55510229f0cbb8208c756a9 ;\tpopd
      ;\tpopd ;\tPATH=\"${PATH}:/opt/easy-rsa/easyrsa3\" ;\tmkdir /pki-master ;\tpushd
      /pki-master ;\teasyrsa --batch init-pki ;\teasyrsa --batch build-ca nopass ;\teasyrsa
      --batch --req-cn=172.17.0.1 gen-req 172.17.0.1 nopass ;\teasyrsa --batch --subject-alt-name=IP:172.17.0.1
      sign-req server 172.17.0.1 ;\tpopd ;\tmkdir /pki-agent ;\tpushd /pki-agent ;\teasyrsa
      --batch init-pki ;\teasyrsa --batch build-ca nopass ;\tfor i in {1..10}; do
      \teasyrsa --batch --req-cn=agent$i gen-req agent$i nopass ;\teasyrsa --batch
      sign-req client agent$i ;\tdone ;\tpopd ;\trm -rf /opt/easy-rsa ;\tDEBIAN_FRONTEND=noninteractive
      apt-get purge -y git ca-certificates openssl ;\tDEBIAN_FRONTEND=noninteractive
      apt-get autoremove --purge -y ;\tapt-get clean ;\trm -vrf /var/lib/apt/lists/*"
    Name: run
    PrependShell: true
  From:
    Image: debian:9
  Name: ""
  Platform: ""
  SourceCode: FROM debian:9
