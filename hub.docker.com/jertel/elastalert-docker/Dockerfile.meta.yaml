MetaArgs: null
Stages:
- BaseName: python:3.6-alpine
  Commands:
  - Labels:
    - Key: description
      Value: '"ElastAlert suitable for Kubernetes and Helm"'
    Name: label
  - Labels:
    - Key: maintainer
      Value: '"Jason Ertel (jertel at codesim.com)"'
    Name: label
  - Key: ELASTALERT_VERSION
    Name: arg
    Value: 0.2.1
  - CmdLine:
    - apk --update upgrade &&     apk add gcc libffi-dev musl-dev python-dev openssl-dev
      tzdata libmagic &&     rm -rf /var/cache/apk/*
    Name: run
    PrependShell: true
  - CmdLine:
    - pip install elastalert==${ELASTALERT_VERSION} &&     apk del gcc libffi-dev
      musl-dev python-dev openssl-dev
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /opt/elastalert/config &&     mkdir -p /opt/elastalert/rules &&     echo
      "#!/bin/sh" >> /opt/elastalert/run.sh &&     echo "set -e" >> /opt/elastalert/run.sh
      &&     echo "elastalert-create-index --config /opt/config/elastalert_config.yaml"
      >> /opt/elastalert/run.sh &&     echo "exec elastalert --config /opt/config/elastalert_config.yaml
      \"\$@\"" >> /opt/elastalert/run.sh &&     chmod +x /opt/elastalert/run.sh
    Name: run
    PrependShell: true
  - Env:
    - Key: TZ
      Value: '"UTC"'
    Name: env
  - Name: volume
    Volumes:
    - /opt/config
    - /opt/rules
  - Name: workdir
    Path: /opt/elastalert
  - CmdLine:
    - /opt/elastalert/run.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: python:3.6-alpine
  Name: ""
  Platform: ""
  SourceCode: FROM python:3.6-alpine
