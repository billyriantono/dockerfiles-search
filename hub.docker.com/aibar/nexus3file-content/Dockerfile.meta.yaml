MetaArgs: null
Stages:
- BaseName: centos:6
  Commands:
  - CmdLine:
    - yum -y upgrade && yum -y install wget file bison flex make gcc-c++ binutils
      && yum clean all
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - centos3.repo
    - /etc/yum.repos.d/
  - Key: platform
    Name: arg
    Value: x86_64-centos3-linux-gnu
  - Key: prefix
    Name: arg
    Value: /opt/toolchains
  - CmdLine:
    - "yum --disablerepo=\\* \t--enablerepo=\\*-centos3 \t--installroot $prefix/$platform/sys-root
      \tinstall -y XFree86-devel.x86_64 glibc-devel.x86_64 \t&& rm -fr $prefix/$platform/sys-root/{etc,bin,boot,root,home,initrd,mnt,sbin,opt,proc,dev,tmp,var,usr/{bin,dict,etc,games,libexec,local,sbin,share,src,tmp}}"
    Name: run
    PrependShell: true
  - Key: binutils
    Name: arg
    Value: "2.31"
  - CmdLine:
    - "(curl http://gnuftp.uib.no/binutils/binutils-$binutils.tar.gz | tar -xzf-)
      \t&& mkdir binutils-build \t&& pushd binutils-build \t&& ../binutils-$binutils/configure
      --prefix=$prefix --enable-gold --disable-nls --with-sysroot --target=$platform
      --host=x86_64-redhat-linux --build=x86_64-redhat-linux \t&& make -j$(nproc)
      \t&& make install-strip \t&& popd \t&& rm -fr binutils-build binutils-$binutils"
    Name: run
    PrependShell: true
  - Key: gcc
    Name: arg
    Value: 5.5.0
  - CmdLine:
    - "(curl http://gnuftp.uib.no/gcc/gcc-$gcc/gcc-$gcc.tar.gz | tar -xzf-) \t&& pushd
      gcc-$gcc \t&& ./contrib/download_prerequisites \t&& popd \t&& mkdir gcc-build
      \t&& pushd gcc-build \t&& ../gcc-$gcc/configure --prefix=$prefix --target=$platform
      --build=x86_64-redhat-linux --host=x86_64-redhat-linux --with-sysroot --disable-multilib
      --disable-libcilkrts --disable-libsanitizer --enable-languages=c,c++ --disable-nls
      \t&& make -j$(nproc) \t&& make install-strip \t&& popd \t&& rm -fr gcc-build
      gcc-$gcc"
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: $PATH:$prefix/bin
    Name: env
  - Key: cmake
    Name: arg
    Value: 3.12.3
  - CmdLine:
    - curl https://cmake.org/files/v3.12/cmake-$cmake-Linux-x86_64.tar.gz | tar --strip-components=1
      -C /usr -xzf-
    Name: run
    PrependShell: true
  - Key: ninja
    Name: arg
    Value: 1.8.2
  - CmdLine:
    - "yum -y install unzip \t&& yum clean all \t&& curl -L -o ninja.zip https://github.com/ninja-build/ninja/releases/download/v$ninja/ninja-linux.zip
      \t&& unzip -d /usr/bin ninja.zip \t&& rm ninja.zip"
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - $platform.cmake
    - $prefix
  From:
    Image: centos:6
  Name: ""
  Platform: ""
  SourceCode: FROM centos:6
