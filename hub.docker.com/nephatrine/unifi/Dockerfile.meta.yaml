MetaArgs: null
Stages:
- BaseName: nephatrine/base-alpine:latest
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"Daniel Wolf <nephatrine@gmail.com>"'
    Name: label
  - CmdLine:
    - echo "====== INSTALL PACKAGES ======"  && apk --update upgrade  && apk add libc6-compat
      mongodb openjdk8-jre   && echo "====== INSTALL UNIFI ======"  && cd /usr/src  &&
      wget "http://www.ubnt.com/downloads/unifi/$(wget -q -O- https://community.ubnt.com/ubnt/rss/board?board.id=Blog_UniFi
      | grep -Eo 'UniFi SDN Controller [0-9\.]+ LTS Stable has' | awk '{print $4}'
      | head -1)/UniFi.unix.zip"  && unzip /usr/src/UniFi.unix.zip -d /srv  && mv
      /srv/UniFi /srv/unifi   && echo "====== CONFIGURE SYSTEM ======"  && unlink
      /srv/unifi/bin/mongod  && ln -s /usr/bin/mongod_wrapper /srv/unifi/bin/mongod   &&
      echo "====== CLEANUP ======"  && cd /usr/src  && rm -rf /tmp/* /usr/src/* /var/cache/apk/*
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - 10001/udp
    - 3478/udp
    - 6789/tcp
    - 8080/tcp
    - 8443/tcp
    - 8843/tcp
    - 8880/tcp
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - override
    - /
  From:
    Image: nephatrine/base-alpine:latest
  Name: ""
  Platform: ""
  SourceCode: FROM nephatrine/base-alpine:latest
