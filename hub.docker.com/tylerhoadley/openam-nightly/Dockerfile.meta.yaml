MetaArgs: null
Stages:
- BaseName: tomcat:8-jre8
  Commands:
  - Maintainer: tyler.hoadley[AT]computersthatwork[DOT]ca
    Name: maintainer
  - CmdLine:
    - /bin/bash
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update && apt-get install -y wget openjdk-8-jdk --no-install-recommends     &&
      apt-get clean && rm -rf /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /tmp/openam_exploded
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /opt/openam/config
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /tmp/openam_exploded
  - CmdLine:
    - curl http://download.forgerock.org/downloads/openam/openam_link.js |    grep
      -o "http://.*\.war" | xargs curl -o /tmp/openam_exploded/openam-org.war
    Name: run
    PrependShell: true
  - CmdLine:
    - jar xvf /tmp/openam_exploded/openam-org.war
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "configuration.dir=/opt/openam/config" >> WEB-INF/classes/bootstrap.properties
    Name: run
    PrependShell: true
  - CmdLine:
    - rm -rf /tmp/openam_exploded/openam-org.war
    Name: run
    PrependShell: true
  - CmdLine:
    - jar cvf /usr/local/tomcat/webapps/openam.war ./*
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get remove --purge openjdk-8-jdk -y && apt-get -y autoremove  && apt-get
      clean && rm -rf /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - Env:
    - Key: CATALINA_HOME
      Value: /usr/local/tomcat
    Name: env
  - Env:
    - Key: PATH
      Value: $CATALINA_HOME/bin:$PATH
    Name: env
  - Name: workdir
    Path: $CATALINA_HOME
  - Name: expose
    Ports:
    - "8080"
  - Chown: ""
    Name: add
    SourcesAndDest:
    - run-openam.sh
    - /tmp/run-openam.sh
  - CmdLine:
    - chmod 777 /tmp/run-openam.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - /tmp/run-openam.sh
    Name: cmd
    PrependShell: false
  From:
    Image: tomcat:8-jre8
  Name: ""
  Platform: ""
  SourceCode: FROM tomcat:8-jre8
