MetaArgs: null
Stages:
- BaseName: debian:stretch
  Commands:
  - Maintainer: foxcris
    Name: maintainer
  - CmdLine:
    - apt-get update && DEBIAN_FRONTEND=noninteractive apt-get install -y locales
      && apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e 's/# en_US.UTF-8 UTF-8/en_US.UTF-8 UTF-8/' /etc/locale.gen &&     echo
      'LANG="en_US.UTF-8"'>/etc/default/locale &&     dpkg-reconfigure --frontend=noninteractive
      locales &&     update-locale LANG=en_US.UTF-8
    Name: run
    PrependShell: true
  - Env:
    - Key: LANG
      Value: en_US.UTF8
    Name: env
  - CmdLine:
    - apt-get update && apt-get -y upgrade && DEBIAN_FRONTEND=noninteractive apt-get
      install -y nano less wget gnupg anacron unattended-upgrades apt-transport-https
      crudini htop sudo&& apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo
      apt-key add -
    Name: run
    PrependShell: true
  - CmdLine:
    - echo 'deb http://apt.postgresql.org/pub/repos/apt/ stretch-pgdg main' > /etc/apt/sources.list.d/pgdg.list
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update && apt-get -y upgrade && DEBIAN_FRONTEND=noninteractive apt-get
      install -y barman  && apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update && apt-get -y upgrade && DEBIAN_FRONTEND=noninteractive apt-get
      install -y openssh-client rsync postgresql-client-9.4 postgresql-client-9.5
      postgresql-client-9.6  && apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update && apt-get -y upgrade && DEBIAN_FRONTEND=noninteractive apt-get
      install -y openvpn && apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i 's/.*#AUTOSTART="all".*/AUTOSTART="all"/' /etc/default/openvpn
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update && apt-get -y upgrade && DEBIAN_FRONTEND=noninteractive apt-get
      install -y rsyslog && apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update && apt-get -y upgrade && DEBIAN_FRONTEND=noninteractive apt-get
      install -y openssh-server && apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - mv /etc/barman.conf /etc/barman.conf_default
    Name: run
    PrependShell: true
  - CmdLine:
    - mv /etc/barman.d /etc/barman.d_default
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /etc/barman.d
    Name: run
    PrependShell: true
  - CmdLine:
    - mv /etc/openvpn /etc/openvpn_default
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /etc/openvpn
    Name: run
    PrependShell: true
  - CmdLine:
    - mv /etc/ssh /etc/ssh_default
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /etc/ssh
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /etc/barman.d
  - Name: volume
    Volumes:
    - /etc/openvpn
  - Name: volume
    Volumes:
    - /etc/ssh
  - Name: volume
    Volumes:
    - /var/log
  - Name: volume
    Volumes:
    - /var/lib/barman
  - Name: volume
    Volumes:
    - /var/spool/cron/crontabs
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - docker-entrypoint.sh
    - /
  - CmdLine:
    - chmod 755 /docker-entrypoint.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - /docker-entrypoint.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: debian:stretch
  Name: ""
  Platform: ""
  SourceCode: FROM debian:stretch
