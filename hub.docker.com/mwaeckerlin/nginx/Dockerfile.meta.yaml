MetaArgs: null
Stages:
- BaseName: mwaeckerlin/base
  Commands:
  - Maintainer: mwaeckerlin
    Name: maintainer
  - Key: wwwuser
    Name: arg
    Value: '"nginx"'
  - Env:
    - Key: WEB_ROOT_PATH
      Value: /app
    Name: env
  - Env:
    - Key: WEB_ROOT
      Value: /
    Name: env
  - Env:
    - Key: MAX_BODY_SIZE
      Value: "0"
    Name: env
  - Env:
    - Key: AUTOINDEX
      Value: "off"
    Name: env
  - Env:
    - Key: ERROR_PAGE
      Value: '""'
    Name: env
  - Env:
    - Key: LOCATION_ROOT_RULES
      Value: '""'
    Name: env
  - Env:
    - Key: LDAP_HOST
      Value: '""'
    Name: env
  - Env:
    - Key: LDAP_BASE_DN
      Value: '""'
    Name: env
  - Env:
    - Key: LDAP_BIND_DN
      Value: '""'
    Name: env
  - Env:
    - Key: LDAP_BIND_PASS
      Value: '""'
    Name: env
  - Env:
    - Key: LDAP_REALM
      Value: '"Restricted"'
    Name: env
  - Env:
    - Key: HTTP_PORT
      Value: "8080"
    Name: env
  - Env:
    - Key: WWWUSER
      Value: '"${wwwuser}"'
    Name: env
  - Env:
    - Key: CONTAINERNAME
      Value: '"nginx"'
    Name: env
  - Chown: ""
    Name: add
    SourcesAndDest:
    - default.conf
    - /etc/nginx/conf.d/default.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - config-nginx.sh
    - /config-nginx.sh
  - CmdLine:
    - ${PKG_INSTALL} nginx  && echo "daemon off;" >> /etc/nginx/nginx.conf  && sed
      -i '/error_log/d' /etc/nginx/nginx.conf  && echo "error_log stderr notice;"
      >> /etc/nginx/nginx.conf  && sed -i 's,access_log .*,access_log /dev/stdout
      combined;,' /etc/nginx/nginx.conf  && touch /var/lib/nginx/logs/error.log  &&
      mkdir -p /usr/share/nginx  && mkdir /run/nginx  && chown -R $WWWUSER /run/nginx
      /etc/nginx  && chgrp -R 0 /run/nginx /etc/nginx /var/tmp/nginx /var/lib/nginx  &&
      chmod -R g=u /run/nginx /etc/nginx /var/tmp/nginx /var/lib/nginx  && rm -r /var/log/nginx  &&
      mv /var/lib/nginx/html /app
    Name: run
    PrependShell: true
  - Name: user
    User: $WWWUSER
  - Name: expose
    Ports:
    - ${HTTP_PORT}
  From:
    Image: mwaeckerlin/base
  Name: ""
  Platform: ""
  SourceCode: FROM mwaeckerlin/base
