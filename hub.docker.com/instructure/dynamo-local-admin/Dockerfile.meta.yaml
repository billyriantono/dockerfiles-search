MetaArgs: null
Stages:
- BaseName: openjdk:11-jre-slim
  Commands:
  - Maintainer: Zach Wily <zach@instructure.com>
    Name: maintainer
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - CmdLine:
    - apt-get update && apt-get install -y --no-install-recommends       curl       dirmngr       gnupg2       nginx       supervisor  &&
      apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir ~/.gnupg && echo "disable-ipv6" >> ~/.gnupg/dirmngr.conf
    Name: run
    PrependShell: true
  - Env:
    - Key: NODE_VERSION
      Value: "10"
    Name: env
  - Env:
    - Key: NPM_CONFIG_LOGLEVEL
      Value: error
    Name: env
  - CmdLine:
    - set -ex &&   for key in      4ED778F539E3634C779C87C6D7062848A1AB005C      94AE36675C464D64BAFA68DD7434390BDBE9B9C5      B9AE9905FFD7803F25714661B63B535A4C206CA9      77984A986EBC2AA786BC0F66B01FBB92821C587A      71DCFD284A79C3B38668286BC97EC7A07EDE3FC1      FD3A5288F042B6850C66B31F09FE44734EB7990E      8FCCA13FEF1D0C2E91008E09770F7A9A5AE15600      C4F0DFFF4E8C1A8236409D08E73BC641CC11F4C8      DD8F2338BAE7501E3DD5AC78C273792F7D83545D      A48C2BEE680E841632CD4E44F07496B3EB3C1762      B9E2F5981AA6E0CD28160D9FF13993A75599653C      9554F04D7259F04124DE6B476D5A82AC7E37093B      93C7E9E91B49E432C2F75674B0A78B0A6C481CF6      56730D5401028683275BD23C23EFEFE93C4CFFFE      114F43EE0176B71C7BC219DD50A3051F888C628D      7937DFD2AB06298B2293C3187D33FF9D0246406D     ;
      do       gpg --batch --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys
      "$key" ||       gpg --batch --keyserver hkp://ipv4.pool.sks-keyservers.net --recv-keys
      "$key" ||       gpg --batch --keyserver hkp://pgp.mit.edu:80 --recv-keys "$key"
      ;     done
    Name: run
    PrependShell: true
  - CmdLine:
    - NODE_FILE="$(curl -sfS https://nodejs.org/dist/latest-v$NODE_VERSION.x/ | grep
      -oE node-v${NODE_VERSION}\.[0-9.]+-linux-x64.tar.xz | sort -r | head -n 1)"
      &&   NODE_LATEST_VERSION=$(echo $NODE_FILE | grep -oE "v[[:digit:]]+\.[[:digit:]]+\.[[:digit:]]+")
      &&   curl -fsSLO --compressed "https://nodejs.org/dist/$NODE_LATEST_VERSION/$NODE_FILE"
      &&   curl -fsSLO --compressed "https://nodejs.org/dist/$NODE_LATEST_VERSION/SHASUMS256.txt.asc"
      &&   gpg --batch --decrypt --output SHASUMS256.txt SHASUMS256.txt.asc &&   grep
      " $NODE_FILE\$" SHASUMS256.txt.asc | sha256sum -c - &&   tar -xJf "$NODE_FILE"
      --warning=no-unknown-keyword -C /usr/local --strip-components=1 --no-same-owner
      &&   ls -la /usr/local/bin/n* &&   rm "$NODE_FILE" SHASUMS256.txt.asc SHASUMS256.txt
    Name: run
    PrependShell: true
  - CmdLine:
    - npm install --no-optional --global dynamodb-admin@3.1.1  && npm cache clean
      --force
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /var/lib/dynamodb && cd /usr/lib &&     curl -L https://s3-us-west-2.amazonaws.com/dynamodb-local/dynamodb_local_latest.tar.gz
      | tar xz
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /var/lib/dynamodb
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - nginx-proxy.conf
    - /etc/nginx-proxy.conf
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - supervisord.conf
    - /etc/supervisord.conf
  - Env:
    - Key: JAVA_OPTS
      Value: '"-Xmx256m"'
    Name: env
  - Env:
    - Key: DYNAMO_ENDPOINT
      Value: http://localhost:8002/
    Name: env
  - Env:
    - Key: VIRTUAL_HOST
      Value: dynamo.docker
    Name: env
  - Env:
    - Key: VIRTUAL_PORT
      Value: "8000"
    Name: env
  - Name: expose
    Ports:
    - "8000"
    - "8001"
    - "8002"
  - CmdLine:
    - /usr/bin/supervisord
    - -c
    - /etc/supervisord.conf
    Name: cmd
    PrependShell: false
  From:
    Image: openjdk:11-jre-slim
  Name: ""
  Platform: ""
  SourceCode: FROM openjdk:11-jre-slim
