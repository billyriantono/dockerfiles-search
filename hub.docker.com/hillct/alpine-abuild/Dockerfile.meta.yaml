MetaArgs:
- DefaultValue: latest
  Key: VERSION
  ProvidedValue: null
  Value: latest
Stages:
- BaseName: alpine:${VERSION}
  Commands:
  - Key: BUILD_DATE
    Name: arg
    Value: null
  - Key: VCS_REF
    Name: arg
    Value: null
  - Key: VCS_URL
    Name: arg
    Value: null
  - Key: CODE_VERSION
    Name: arg
    Value: null
  - Labels:
    - Key: org.label-schema.build-date
      Value: $BUILD_DATE
    - Key: org.label-schema.name
      Value: '"Alpine Package Builder"'
    - Key: org.label-schema.url
      Value: '"https://github.org/hillct/docker-alpine-abuild"'
    - Key: org.label-schema.vcs-ref
      Value: $VCS_REF
    - Key: org.label-schema.vcs-url
      Value: $VCS_URL
    - Key: org.label-schema.vendor
      Value: '"Colin Hill"'
    - Key: org.label-schema.version
      Value: $CODE_VERSION
    - Key: org.label-schema.schema-version
      Value: '"1.0"'
    Name: label
  - CmdLine:
    - if [ "$linux_version" = "edge" ] ; then echo http://dl-cdn.alpinelinux.org/alpine/edge/testing
      >> /etc/apk/repositories  ; else echo NOT using Testing repo ; fi
    Name: run
    PrependShell: true
  - CmdLine:
    - apk --no-cache add alpine-sdk coreutils cmake   && adduser -G abuild -g "Alpine
      Package Builder" -s /bin/ash -D builder   && echo "builder ALL=(ALL) NOPASSWD:ALL"
      >> /etc/sudoers   && mkdir /packages   && chown builder:abuild /packages
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - /abuilder
    - /bin/
  - Name: user
    User: builder
  - CmdLine:
    - abuilder
    - -r
    Name: entrypoint
    PrependShell: false
  - Name: workdir
    Path: /home/builder/package
  - Env:
    - Key: RSA_PRIVATE_KEY_NAME
      Value: ssh.rsa
    Name: env
  - Env:
    - Key: PACKAGER_PRIVKEY
      Value: /home/builder/${RSA_PRIVATE_KEY_NAME}
    Name: env
  - Env:
    - Key: REPODEST
      Value: /packages
    Name: env
  From:
    Image: alpine:${VERSION}
  Name: ""
  Platform: ""
  SourceCode: FROM alpine:${VERSION}
