MetaArgs: null
Stages:
- BaseName: nginx:1.13.8
  Commands:
  - Maintainer: gaku3601
    Name: maintainer
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y supervisor cron
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y letsencrypt
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y apache2-utils
    Name: run
    PrependShell: true
  - Env:
    - Key: TZ
      Value: Asia/Tokyo
    Name: env
  - Chown: ""
    Name: add
    SourcesAndDest:
    - supervisord.conf
    - /etc/supervisord.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./cron-startup.sh
    - /cron-startup.sh
  - CmdLine:
    - mkdir /var/log/cron
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./renew.sh
    - /renew.sh
  - CmdLine:
    - echo '0 4 * * 1 root sh /renew.sh >> /var/log/cron/`date '+\\%Y-\\%m-\\%d'`.log
      2>&1' >> /etc/crontab
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./default.conf
    - /etc/nginx/conf.d/default.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./default.ssl.conf~
    - /etc/nginx/conf.d/default.ssl.conf~
  - CmdLine:
    - mkdir /usr/share/nginx/html/ssl
    Name: run
    PrependShell: true
  - CmdLine:
    - chown nginx.nginx /usr/share/nginx/html/ssl
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./start.sh
    - /start.sh
  - CmdLine:
    - /usr/bin/supervisord -c /etc/supervisord.conf
    Name: cmd
    PrependShell: true
  From:
    Image: nginx:1.13.8
  Name: ""
  Platform: ""
  SourceCode: FROM nginx:1.13.8
