MetaArgs: null
Stages:
- BaseName: alpine:latest
  Commands:
  - Labels:
    - Key: 'maintainer:'
      Value: xml@live.com
    Name: label
  - Env:
    - Key: NGINX_VER
      Value: 1.17.6
    Name: env
  - CmdLine:
    - "mkdir nginx && \tcd tmp && \tapk update && \tapk add --no-cache ffmpeg pcre-dev
      bash && \tapk add --no-cache --virtual .git git && \twget http://nginx.org/download/nginx-$NGINX_VER.tar.gz
      && \ttar -xzf nginx-$NGINX_VER.tar.gz && \tgit clone https://github.com/winshining/nginx-http-flv-module.git
      && \tapk add --no-cache --virtual .buildenv gcc libc-dev make linux-headers
      \topenssl-dev zlib-dev && \tcd nginx-$NGINX_VER && \t./configure --prefix=/nginx
      --with-http_ssl_module --add-module=../nginx-http-flv-module && \tmake && \tmake
      install && \tcd /nginx && \trm -r /tmp/* && \tapk del .git && \tapk del .buildenv
      && \trm conf/nginx.conf && \tcd html && \tmkdir hls hls/transcode dash dash/transcode
      vod record"
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /nginx
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - conf/*
    - ./conf/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - html/*
    - ./html/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - start.sh
    - .
  - CmdLine:
    - chmod +x ./start.sh
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "80"
  - Name: expose
    Ports:
    - "1935"
  - Name: volume
    Volumes:
    - /nginx
  - CmdLine:
    - bash
    - /nginx/start.sh
    Name: cmd
    PrependShell: false
  From:
    Image: alpine:latest
  Name: ""
  Platform: ""
  SourceCode: FROM alpine:latest
