MetaArgs: null
Stages:
- BaseName: php:7-apache
  Commands:
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - moodle-config.php
    - /var/www/html/config.php
  - Env:
    - Key: MYSQL_TYPE
      Value: mariadb
    - Key: MYSQL_DATABASE
      Value: moodle
    - Key: MYSQL_USER
      Value: moodleuser
    - Key: MYSQL_PASSWORD
      Value: your-database-password
    - Key: MYSQL_HOSTNAME
      Value: localhost
    - Key: MYSQL_PORT
      Value: "3306"
    - Key: MOODLE_URL
      Value: https://moodle.example.com
    Name: env
  - CmdLine:
    - chown -R $APACHE_RUN_USER:$APACHE_RUN_GROUP /var/www/html  && apt-get update  &&
      apt-get install -y zlib1g-dev libpng-dev libjpeg-dev libxml2-dev libicu-dev  &&
      docker-php-ext-configure gd --with-jpeg-dir=/usr/include/  && docker-php-ext-install
      -j$(nproc) mysqli pdo pdo_mysql zip gd xmlrpc soap intl opcache
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /var/www/html
  - Name: volume
    Volumes:
    - /var/moodledata
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - moodle.ini
    - /usr/local/etc/php/conf.d/
  From:
    Image: php:7-apache
  Name: ""
  Platform: ""
  SourceCode: FROM php:7-apache
