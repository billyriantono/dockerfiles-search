MetaArgs: null
Stages:
- BaseName: ubuntu:16.04
  Commands:
  - Maintainer: Achim Rohn <achim@rohn.eu>
    Name: maintainer
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - CmdLine:
    - apt-get update && apt-get -y upgrade && apt-get -y install nodejs-dev nodejs-legacy
      npm git ffmpeg libspeexdsp-dev libebur128-dev libsoundio-dev libchromaprint-dev
      libgroove-dev libgrooveplayer-dev libgrooveloudness-dev libgroovefingerprinter-dev
    Name: run
    PrependShell: true
  - CmdLine:
    - useradd -m groovebasin &&     mkdir /home/groovebasin/music &&     mkdir /home/groovebasin/groove
      &&     chown -R groovebasin:groovebasin /home/groovebasin
    Name: run
    PrependShell: true
  - Name: user
    User: groovebasin
  - CmdLine:
    - git clone --branch album-cover https://github.com/gorlug/groovebasin.git /home/groovebasin/groovebasin
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /home/groovebasin/groovebasin/
  - CmdLine:
    - npm run build
    Name: run
    PrependShell: true
  - CmdLine:
    - npm start ; exit 0
    Name: run
    PrependShell: true
  - CmdLine:
    - 'sed -i ''s/    "host": "127.0.0.1",/    "host": "0.0.0.0",/g'' config.json'
    Name: run
    PrependShell: true
  - CmdLine:
    - 'sed -i ''s/    "albumArt": false/    "albumArt": true/g''  config.json'
    Name: run
    PrependShell: true
  - CmdLine:
    - 'sed -i ''s|    "musicDirectory": "/home/groovebasin",|    "musicDirectory":
      "/home/groovebasin/music",|g'' config.json'
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -s /home/groovebasin/groove groovebasin.db
    Name: run
    PrependShell: true
  - Env:
    - Key: HOME
      Value: /home/groovebasin
    Name: env
  - Name: workdir
    Path: /home/groovebasin/groovebasin
  - Name: expose
    Ports:
    - "16242"
  - Name: expose
    Ports:
    - "6600"
  - CmdLine:
    - npm
    - start
    Name: entrypoint
    PrependShell: false
  From:
    Image: ubuntu:16.04
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:16.04
