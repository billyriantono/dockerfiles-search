MetaArgs: null
Stages:
- BaseName: jboss/wildfly:10.1.0.Final
  Commands:
  - Maintainer: Teiid-Komodo Community <http://teiiddesigner.jboss.org>
    Name: maintainer
  - Env:
    - Key: VDB_BUILDER_RELEASE_DIRECTORY
      Value: '"0.0.4-SNAPSHOT"'
    Name: env
  - Env:
    - Key: VDB_BUILDER_RELEASE_WAR
      Value: '"komodo-rest-0.0.4-20170406.085836-1.war"'
    Name: env
  - Env:
    - Key: VDB_BUILDER_WAR_URL
      Value: '"https://repository.jboss.org/nexus/service/local/repositories/snapshots/content/org/komodo/komodo-rest/$VDB_BUILDER_RELEASE_DIRECTORY/$VDB_BUILDER_RELEASE_WAR"'
    Name: env
  - Env:
    - Key: VDB_BUILDER_WAR_FILE
      Value: '"vdb-builder.war"'
    Name: env
  - Env:
    - Key: BIN_DIR
      Value: '"/usr/local/bin"'
    Name: env
  - Env:
    - Key: JBOSS_HOME
      Value: /opt/jboss/wildfly
    Name: env
  - Env:
    - Key: TEIID_VERSION
      Value: 9.1.0.Final
    Name: env
  - Name: user
    User: root
  - CmdLine:
    - cd $JBOSS_HOME     && curl -O https://repository.jboss.org/nexus/service/local/repositories/releases/content/org/jboss/teiid/teiid/$TEIID_VERSION/teiid-$TEIID_VERSION-wildfly-dist.zip     &&
      bsdtar -xf teiid-$TEIID_VERSION-wildfly-dist.zip     && chmod +x $JBOSS_HOME/bin/*.sh     &&
      rm teiid-$TEIID_VERSION-wildfly-dist.zip
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ssl
    - $JBOSS_HOME/standalone/configuration/ssl
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - bin/*
    - $JBOSS_HOME/bin/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - standalone.xml
    - $JBOSS_HOME/standalone/configuration/standalone-teiid.xml
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - application-users.properties
    - $JBOSS_HOME/standalone/configuration/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - application-roles.properties
    - $JBOSS_HOME/standalone/configuration/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - mgmt-users.properties
    - $JBOSS_HOME/standalone/configuration/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - $VDB_BUILDER_WAR_URL
    - $JBOSS_HOME/standalone/deployments/$VDB_BUILDER_WAR_FILE
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - wildfly-exec.sh
    - ${BIN_DIR}/
  - Name: user
    User: root
  - CmdLine:
    - chown -R jboss:0 ${JBOSS_HOME}     && chmod -R g+rw ${JBOSS_HOME}     && chmod
      +x ${BIN_DIR}/wildfly-exec.sh     && yum -y install --setopt=tsflags=nodocs
      bc
    Name: run
    PrependShell: true
  - Name: user
    User: jboss
  - Name: expose
    Ports:
    - "31000"
    - "35432"
    - "8080"
    - "8443"
    - "9990"
  - CmdLine:
    - /bin/sh
    - -c
    - ${BIN_DIR}/wildfly-exec.sh
    Name: cmd
    PrependShell: false
  From:
    Image: jboss/wildfly:10.1.0.Final
  Name: ""
  Platform: ""
  SourceCode: FROM jboss/wildfly:10.1.0.Final
