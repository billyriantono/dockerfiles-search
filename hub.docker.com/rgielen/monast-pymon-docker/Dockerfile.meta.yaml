MetaArgs: null
Stages:
- BaseName: ubuntu:17.10
  Commands:
  - Maintainer: '"Rene Gielen" <rgielen@apache.org>'
    Name: maintainer
  - CmdLine:
    - apt-get update && apt-get -y install python python-twisted python-zope.interface
      python-pip wget unzip gettext-base         && apt-get clean         && rm -rf
      /var/lib/apt/lists/*         && rm -rf /tmp/*
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://downloads.sourceforge.net/project/basicproperty/basicproperty/0.6.12a/basicproperty-0.6.12a.tar.gz         &&
      tar -xzf basicproperty-0.6.12a.tar.gz         && cd basicproperty-0.6.12a         &&
      python setup.py install         && cd ..         && rm basicproperty-0.6.12a.tar.gz         &&
      rm -rf basicproperty-0.6.12a
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://downloads.sourceforge.net/project/starpy/starpy/1.0.0a13/starpy-1.0.0a13.tar.gz         &&
      tar -xzf starpy-1.0.0a13.tar.gz         && cd starpy-1.0.0a13         && python
      setup.py install         && cd ..         && rm starpy-1.0.0a13.tar.gz         &&
      rm -rf starpy-1.0.0a13
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://github.com/dagmoller/monast/archive/master.zip         && unzip
      master.zip         && mv monast-master/pymon /         && rm -rf monast-master         &&
      echo "$PWD"         && rm master.zip
    Name: run
    PrependShell: true
  - CmdLine:
    - groupadd -r monast && useradd -r -g monast monast && mkdir /pymon/config &&
      chown monast.monast /pymon/config
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - monast.conf.template
    - /pymon/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - configure-and-start.sh
    - /pymon/
  - Env:
    - Key: BIND_HOST
      Value: 0.0.0.0
    Name: env
  - Env:
    - Key: BIND_PORT
      Value: "5039"
    Name: env
  - Env:
    - Key: ASTERISK_HOST
      Value: localhost
    Name: env
  - Env:
    - Key: ASTERISK_PORT
      Value: "5038"
    Name: env
  - Env:
    - Key: AMI_USERNAME
      Value: admin
    Name: env
  - Env:
    - Key: AMI_PASSWORD
      Value: admin
    Name: env
  - Env:
    - Key: DEFAULT_CONTEXT
      Value: default
    Name: env
  - Env:
    - Key: TRANSFER_CONTEXT
      Value: default
    Name: env
  - Env:
    - Key: MEETME_CONTEXT
      Value: default
    Name: env
  - Env:
    - Key: USER_ADMIN_SECRET
      Value: admin
    Name: env
  - Env:
    - Key: USER_AGENT_SECRET
      Value: agent
    Name: env
  - Env:
    - Key: ADDITIONAL_CONFIG_LINES
      Value: '""'
    Name: env
  - Name: expose
    Ports:
    - ${BIND_PORT}
  - Name: user
    User: monast
  - CmdLine:
    - /pymon/configure-and-start.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: ubuntu:17.10
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:17.10
