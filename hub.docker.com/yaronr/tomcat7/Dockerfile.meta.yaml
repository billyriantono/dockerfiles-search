MetaArgs: null
Stages:
- BaseName: yaronr/openjdk-7-jre
  Commands:
  - Maintainer: yaronr
    Name: maintainer
  - Env:
    - Key: TOMCATVER
      Value: 7.0.57
    Name: env
  - Env:
    - Key: MYSQL_CONNECTOR_JAVA_VER
      Value: 5.1.34
    Name: env
  - Env:
    - Key: TOMCAT_HOME
      Value: /opt/tomcat
    Name: env
  - CmdLine:
    - (wget --progress=bar:force --retry-connrefused -t 5 -O /tmp/tomcat7.tar.gz http://apache.mivzakim.net/tomcat/tomcat-7/v${TOMCATVER}/bin/apache-tomcat-${TOMCATVER}.tar.gz  &&     cd
      /opt &&     tar zxf /tmp/tomcat7.tar.gz &&     mv /opt/apache-tomcat* ${TOMCAT_HOME}
      &&     rm /tmp/tomcat7.tar.gz) &&     rm -rf ${TOMCAT_HOME}/webapps/ &&     mkdir
      ${TOMCAT_HOME}/webapps &&     wget --progress=bar:force --retry-connrefused
      -t 5 -O /tmp/mysql-connector-java.tar.gz http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-${MYSQL_CONNECTOR_JAVA_VER}.tar.gz
      &&     tar zxf /tmp/mysql-connector-java.tar.gz -C /tmp &&     rm /tmp/mysql-connector-java.tar.gz
      &&     mv /tmp/mysql-connector-java-${MYSQL_CONNECTOR_JAVA_VER}/mysql-connector-java-${MYSQL_CONNECTOR_JAVA_VER}-bin.jar
      /opt/tomcat/lib/ &&     rm -rf /tmp/mysql-connector-java-${MYSQL_CONNECTOR_JAVA_VER}
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./run.sh
    - /usr/local/bin/run
  - Chown: ""
    Name: add
    SourcesAndDest:
    - logrotate
    - /etc/logrotate.d/tomcat7
  - CmdLine:
    - chmod 644 /etc/logrotate.d/tomcat7
    Name: run
    PrependShell: true
  - CmdLine:
    - "sed -i.bak '/\\# End of file/ i\\\\# Following 2 lines added by Dockerfile'
      /etc/security/limits.conf && \tsed -i.bak '/\\# End of file/ i\\\\*                hard
      \   nofile          65536' /etc/security/limits.conf && \tsed -i.bak '/\\# End
      of file/ i\\\\*                soft    nofile          65536\\n' /etc/security/limits.conf"
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "8080"
  - CmdLine:
    - /bin/bash
    - -e
    - /usr/local/bin/run
    Name: cmd
    PrependShell: false
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./server.xml
    - ${TOMCAT_HOME}/conf/
  From:
    Image: yaronr/openjdk-7-jre
  Name: ""
  Platform: ""
  SourceCode: FROM yaronr/openjdk-7-jre
