MetaArgs: null
Stages:
- BaseName: centos:7
  Commands:
  - Maintainer: Fran Tsao <tsao@gpul.org>
    Name: maintainer
  - CmdLine:
    - groupadd -g 972 varnish
    Name: run
    PrependShell: true
  - CmdLine:
    - useradd -u 972 -s /bin/false -g varnish varnish
    Name: run
    PrependShell: true
  - CmdLine:
    - yum install -y     automake     make     gcc     glibc-devel     ca-certificates     curl     libedit-devel     jemalloc-devel     jemalloc     ncurses-devel     pcre-devel     pcre     libtool     pkgconfig     file     dotconf     python-docutils   &&
      yum clean all
    Name: run
    PrependShell: true
  - Env:
    - Key: VARNISH_VERSION
      Value: 4.1.11
    Name: env
  - Env:
    - Key: VARNISH_SHA256SUM
      Value: f937a45116f3a7fbb38b2b5d7137658a4846409630bb9eccdbbb240e1a1379bc
    Name: env
  - CmdLine:
    - mkdir -p /usr/src &&   cd /usr/src &&   curl -sfLO https://varnish-cache.org/_downloads/varnish-$VARNISH_VERSION.tgz
      &&   echo "${VARNISH_SHA256SUM} varnish-$VARNISH_VERSION.tgz" | sha256sum -c
      - &&   tar -xzf varnish-$VARNISH_VERSION.tgz &&   cd varnish-$VARNISH_VERSION
      &&   ./autogen.sh &&   ./configure &&   make install &&   rm ../varnish-$VARNISH_VERSION.tgz
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "8080"
  - CmdLine:
    - /usr/local/sbin/varnishd
    - -j
    - unix,user=varnish
    - -F
    - -f
    - /etc/varnish/default.vcl
    - -a
    - 0.0.0.0:8080
    Name: entrypoint
    PrependShell: false
  From:
    Image: centos:7
  Name: ""
  Platform: ""
  SourceCode: FROM centos:7
