MetaArgs: null
Stages:
- BaseName: codetroopers/jenkins-slave-jdk8-android:22-22.0.1-x86
  Commands:
  - Maintainer: davidbaena
    Name: maintainer
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get -y install curl build-essential
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y maven
    Name: run
    PrependShell: true
  - Name: user
    User: jenkins
  - Name: workdir
    Path: /home/jenkins
  - CmdLine:
    - mkdir .local && mkdir node
    Name: run
    PrependShell: true
  - CmdLine:
    - curl http://nodejs.org/dist/node-latest.tar.gz | tar xz --strip-components=1
    Name: run
    PrependShell: true
  - CmdLine:
    - ./configure --prefix=.local && make install
    Name: run
    PrependShell: true
  - Env:
    - Key: NODE_PATH
      Value: /home/jenkins/.local/lib/node_modules
    Name: env
  - Env:
    - Key: PATH
      Value: /home/jenkins/.local/bin:$PATH
    Name: env
  - Name: user
    User: root
  - CmdLine:
    - ln -s /home/jenkins/.local/bin/node  /usr/bin/nodejs
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -s /home/jenkins/.local/lib/node_modules /usr/local/lib/
    Name: run
    PrependShell: true
  - Env:
    - Key: appium_args
      Value: '"-p 4723"'
    Name: env
  - Name: user
    User: jenkins
  - CmdLine:
    - curl -O https://npmjs.com/install.sh | sh
    Name: run
    PrependShell: true
  - Env:
    - Key: appium_version
      Value: 1.4.10
    Name: env
  - CmdLine:
    - npm install -g appium@${appium_version}
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - files/insecure_shared_adbkey
    - /home/jenkins/.android/adbkey
  - Chown: ""
    Name: add
    SourcesAndDest:
    - files/insecure_shared_adbkey.pub
    - /home/jenkins/.android/adbkey.pub
  - Name: user
    User: root
  - CmdLine:
    - apt-get -y install supervisor
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /var/log/supervisor
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - supervisord.conf
    - /etc/supervisor/conf.d/supervisord.conf
  - CmdLine:
    - adb kill-server
    Name: run
    PrependShell: true
  - CmdLine:
    - adb start-server
    Name: run
    PrependShell: true
  - CmdLine:
    - adb devices
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "22"
  - CmdLine:
    - /usr/bin/supervisord
    Name: cmd
    PrependShell: false
  From:
    Image: codetroopers/jenkins-slave-jdk8-android:22-22.0.1-x86
  Name: ""
  Platform: ""
  SourceCode: FROM codetroopers/jenkins-slave-jdk8-android:22-22.0.1-x86
