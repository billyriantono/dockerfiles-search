MetaArgs: null
Stages:
- BaseName: debian:10
  Commands:
  - CmdLine:
    - apt-get update &&     apt-get install -y build-essential wget cmake m4 libgmp-dev
      file unzip
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://www.shoup.net/ntl/ntl-11.3.2.tar.gz &&     tar xf ntl-11.3.2.tar.gz
      &&     (cd ntl-11.3.2/src &&     ./configure SHARED=on NTL_GMP_LIP=on NTL_THREADS=on
      NTL_THREAD_BOOST=on &&     make -j4 &&     make install)
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://github.com/homenc/HElib/archive/7427ed3709bb9872835324dd0007a97b3ca3baca.zip
      &&     unzip 7427ed3709bb9872835324dd0007a97b3ca3baca.zip &&     (cd HElib-7427ed3709bb9872835324dd0007a97b3ca3baca
      &&     mkdir build &&     cd build &&     cmake -DCMAKE_BUILD_TYPE=RelWithDebInfo
      -DBUILD_SHARED=ON -DENABLE_THREADS=ON .. &&     make -j4 &&     make install
      &&     ldconfig)
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - /tmp/patient-matching/
  - Name: workdir
    Path: /tmp/patient-matching
  - CmdLine:
    - make
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get clean
    Name: run
    PrependShell: true
  From:
    Image: debian:10
  Name: ""
  Platform: ""
  SourceCode: FROM debian:10
- BaseName: debian:10
  Commands:
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - requirements.txt
    - /opt
  - CmdLine:
    - apt-get update &&     apt-get install -qy python3 &&     apt-get install -qy
      python3-pip &&     pip3 install -r /opt/requirements.txt
    Name: run
    PrependShell: true
  - CmdLine:
    - rm -rf /opt/requirements.txt
    Name: run
    PrependShell: true
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /usr/local/lib/libhelib.so
    - /usr/local/lib/libhelib.so
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /usr/local/lib/libhelib.so.1.0.0
    - /usr/local/lib/libhelib.so.1.0.0
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /usr/local/lib/libntl.a
    - /usr/local/lib/libntl.a
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /usr/local/lib/libntl.la
    - /usr/local/lib/libntl.la
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /usr/local/lib/libntl.so
    - /usr/local/lib/libntl.so
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /usr/local/lib/libntl.so.39
    - /usr/local/lib/libntl.so.39
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /usr/local/lib/libntl.so.39.0.2
    - /usr/local/lib/libntl.so.39.0.2
  - CmdLine:
    - mkdir /var/lib/patient-matching
    Name: run
    PrependShell: true
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /tmp/patient-matching/GenerateKeys
    - /var/lib/patient-matching
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /tmp/patient-matching/Multiply
    - /var/lib/patient-matching
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /tmp/patient-matching/Encrypt
    - /var/lib/patient-matching
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /tmp/patient-matching/Decrypt
    - /var/lib/patient-matching
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - /opt/patient-matching/
  - Name: workdir
    Path: /opt/patient-matching/src
  - Env:
    - Key: LD_LIBRARY_PATH
      Value: /usr/local/lib
    Name: env
  - Env:
    - Key: PYTHONPATH
      Value: '"${PYTHONPATH}:/opt/patient-matching"'
    Name: env
  - CmdLine:
    - apt-get clean
    Name: run
    PrependShell: true
  From:
    Image: debian:10
  Name: ""
  Platform: ""
  SourceCode: FROM debian:10
