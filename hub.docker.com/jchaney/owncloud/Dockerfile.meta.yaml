MetaArgs: null
Stages:
- BaseName: debian:jessie
  Commands:
  - Maintainer: Robin Schneider <ypid@riseup.net>
    Name: maintainer
  - CmdLine:
    - DEBIAN_FRONTEND=noninteractive ;    apt-get update &&     apt-get install --assume-yes         bzip2         cron         nginx         openssl         php-apc         php5-apcu         php5-cli         php5-curl         php5-fpm         php5-gd         php5-gmp         php5-imagick         php5-intl         php5-ldap         php5-mcrypt         php5-mysqlnd         php5-pgsql         php5-sqlite         smbclient         sudo         wget
    Name: run
    PrependShell: true
  - Env:
    - Key: OWNCLOUD_VERSION
      Value: '"10.0.7"'
    - Key: OWNCLOUD_IN_ROOTPATH
      Value: '"0"'
    - Key: OWNCLOUD_SERVERNAME
      Value: '"localhost"'
    Name: env
  - Labels:
    - Key: com.github.jchaney.owncloud.version
      Value: '"$OWNCLOUD_VERSION"'
    - Key: com.github.jchaney.owncloud.license
      Value: '"AGPL-3.0"'
    - Key: com.github.jchaney.owncloud.url
      Value: '"https://github.com/jchaney/owncloud"'
    Name: label
  - CmdLine:
    - gpg --keyserver ha.pool.sks-keyservers.net --recv-keys E3036906AD9F30807351FAC32D5D5E97F6978A26
    Name: run
    PrependShell: true
  - CmdLine:
    - wget --no-verbose --output-document /tmp/oc.tar.bz2 https://download.owncloud.org/community/owncloud-${OWNCLOUD_VERSION}.tar.bz2
      &&     wget --no-verbose --output-document /tmp/oc.tar.bz2.asc https://download.owncloud.org/community/owncloud-${OWNCLOUD_VERSION}.tar.bz2.asc
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir --parent /var/www/owncloud/apps_persistent /owncloud /var/log/cron &&     gpg
      --verify /tmp/oc.tar.bz2.asc &&     tar --no-same-owner --directory /var/www/
      --extract --file /tmp/oc.tar.bz2 &&     ln --symbolic --force /owncloud/config.php
      /var/www/owncloud/config/config.php &&     ln --symbolic --force /owncloud/docker_image_owncloud.config.php
      /var/www/owncloud/config/docker_image_owncloud.config.php &&     rm /tmp/oc.tar.bz2
      /tmp/oc.tar.bz2.asc
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - misc/bootstrap.sh
    - misc/occ
    - misc/oc-install-3party-apps
    - /usr/local/bin/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - configs/3party_apps.conf
    - configs/nginx_ssl.conf
    - configs/nginx.conf
    - configs/docker_image_owncloud.config.php
    - configs/owncloud_autoconfig.php
    - /root/
  - CmdLine:
    - echo 'env[PATH] = /usr/local/bin:/usr/bin:/bin' >> /etc/php5/fpm/pool.d/www.conf
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - configs/cron.conf
    - /etc/oc-cron.conf
  - CmdLine:
    - crontab /etc/oc-cron.conf
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "443"
    - "80"
  - CmdLine:
    - bootstrap.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: debian:jessie
  Name: ""
  Platform: ""
  SourceCode: FROM debian:jessie
