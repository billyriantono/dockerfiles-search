MetaArgs: null
Stages:
- BaseName: php:7.1-fpm-alpine
  Commands:
  - Maintainer: Moose wings <pd@urb-it.com>
    Name: maintainer
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./logging.ini
    - /usr/local/etc/php/conf.d
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./lumen.ini
    - /usr/local/etc/php/conf.d
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./lumen.pool.conf
    - /usr/local/etc/php-fpm.d
  - CmdLine:
    - rm /usr/local/etc/php-fpm.d/www.conf*
    Name: run
    PrependShell: true
  - Env:
    - Key: ALPINE_VERSION
      Value: "3.4"
    Name: env
  - Env:
    - Key: PHP_API_VERSION
      Value: "20160303"
    Name: env
  - Env:
    - Key: IMAGICK_VERSION
      Value: 3.4.3
    Name: env
  - Env:
    - Key: MONGODB_VERSION
      Value: 1.2.5
    Name: env
  - Env:
    - Key: LOG_STREAM
      Value: '"/tmp/stdout"'
    Name: env
  - CmdLine:
    - apk --no-cache --update --repository http://dl-cdn.alpinelinux.org/alpine/v$ALPINE_VERSION/main/
      add     autoconf     build-base     ca-certificates && apk --no-cache --update
      --repository http://dl-3.alpinelinux.org/alpine/v3.5/main/ add     curl     openssl     openssl-dev     libtool     icu     icu-libs     icu-dev     libwebp     libpng     libpng-dev     libjpeg-turbo     libjpeg-turbo-dev     imagemagick-dev     imagemagick
      && apk --no-cache --update --repository http://dl-3.alpinelinux.org/alpine/v3.5/community/
      add     php7-gd     php7-sockets     php7-zlib     php7-intl     php7-opcache     php7-bcmath
      && docker-php-ext-configure intl && docker-php-ext-configure gd     --with-png-dir=/usr/include/     --with-jpeg-dir=/usr/include/
      && pecl install     imagick-$IMAGICK_VERSION     mongodb-$MONGODB_VERSION &&
      docker-php-ext-install     pdo_mysql     sockets     gd     intl     opcache     bcmath
      && docker-php-ext-enable     imagick     mongodb && apk --no-cache del     wget     icu-dev     libpng-dev     libjpeg-turbo-dev     imagemagick-dev     tar     autoconf     build-base     libtool
      && rm -rf /var/cache/apk/* /tmp/*
    Name: run
    PrependShell: true
  - CmdLine:
    - mkfifo $LOG_STREAM && chmod 777 $LOG_STREAM
    Name: run
    PrependShell: true
  - CmdLine:
    - sh -c "php-fpm -D | tail -f $LOG_STREAM"
    Name: cmd
    PrependShell: true
  - Name: workdir
    Path: /var/www/application
  - Name: expose
    Ports:
    - "9000"
  From:
    Image: php:7.1-fpm-alpine
  Name: ""
  Platform: ""
  SourceCode: FROM php:7.1-fpm-alpine
