{
  "MetaArgs": null,
  "Stages": [
    {
      "Name": "",
      "BaseName": "php:7.3-cli-alpine",
      "SourceCode": "FROM php:7.3-cli-alpine",
      "Platform": "",
      "From": {
        "Image": "php:7.3-cli-alpine"
      },
      "Commands": [
        {
          "Env": [
            {
              "Key": "PHPREDIS_VERSION",
              "Value": "4.3.0"
            }
          ],
          "Name": "env"
        },
        {
          "Env": [
            {
              "Key": "READIS_VERSION",
              "Value": "2.2.1"
            }
          ],
          "Name": "env"
        },
        {
          "CmdLine": [
            "apk update \u0026\u0026 apk upgrade \u0026\u0026 apk add --no-cache $PHPIZE_DEPS git icu-dev g++ procps"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "docker-php-ext-install intl"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "mkdir -p /usr/src/php/ext/redis    \u0026\u0026 curl -L https://github.com/phpredis/phpredis/archive/${PHPREDIS_VERSION}.tar.gz | tar xvz -C /usr/src/php/ext/redis --strip 1    \u0026\u0026 echo 'redis' \u003e\u003e /usr/src/php-available-exts    \u0026\u0026 docker-php-ext-install redis"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "Chown": "",
          "From": "",
          "Name": "copy",
          "SourcesAndDest": [
            "composer/install_composer.sh",
            "/install_composer.sh"
          ]
        },
        {
          "CmdLine": [
            "sh /install_composer.sh --install-dir=/bin --filename=composer"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "git clone https://github.com/hollodotme/readis.git /code    \u0026\u0026 cd /code    \u0026\u0026 git checkout v${READIS_VERSION}    \u0026\u0026 composer install -a --no-dev --no-interaction"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "CmdLine": [
            "apk del $PHPIZE_DEPS git g++    \u0026\u0026 rm -f /bin/composer    \u0026\u0026 rm -f /install_composer.sh    \u0026\u0026 rm -rf /var/cache/apk/*"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "Name": "expose",
          "Ports": [
            "80"
          ]
        },
        {
          "CmdLine": [
            "php",
            "-S",
            "0.0.0.0:80",
            "-t",
            "/code/public"
          ],
          "Name": "cmd",
          "PrependShell": false
        }
      ]
    }
  ]
}