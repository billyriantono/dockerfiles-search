MetaArgs: null
Stages:
- BaseName: ubuntu:trusty
  Commands:
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - CmdLine:
    - apt-get update && apt-get install -y djbdns daemontools-run ucspi-tcp psmisc
    Name: run
    PrependShell: true
  - CmdLine:
    - useradd -s /bin/false tinydns
    Name: run
    PrependShell: true
  - CmdLine:
    - useradd -s /bin/false dnscache
    Name: run
    PrependShell: true
  - CmdLine:
    - useradd -s /bin/false dnslog
    Name: run
    PrependShell: true
  - CmdLine:
    - tinydns-conf tinydns dnslog /etc/tinydns/ 127.0.0.1
    Name: run
    PrependShell: true
  - CmdLine:
    - dnscache-conf dnscache dnslog /etc/dnscache 0.0.0.0
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "127.0.0.1" > /etc/dnscache/root/servers/dev
    Name: run
    PrependShell: true
  - CmdLine:
    - touch /etc/dnscache/root/ip/192
    Name: run
    PrependShell: true
  - CmdLine:
    - touch /etc/dnscache/root/ip/172
    Name: run
    PrependShell: true
  - CmdLine:
    - touch /etc/dnscache/root/ip/10
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -s /etc/tinydns /etc/service/tinydns
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -s /etc/dnscache /etc/service/dnscache
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - init.sh
    - /scripts/init.sh
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - data
    - /etc/tinydns/root/data
  - Name: expose
    Ports:
    - 53/tcp
    - 53/udp
  - Name: volume
    Volumes:
    - /etc/tinydns
  - Name: volume
    Volumes:
    - /etc/dnscache
  - CmdLine:
    - /scripts/init.sh
    Name: cmd
    PrependShell: false
  From:
    Image: ubuntu:trusty
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:trusty
