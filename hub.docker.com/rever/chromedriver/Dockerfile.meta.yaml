MetaArgs: null
Stages:
- BaseName: debian:stretch-slim
  Commands:
  - CmdLine:
    - export DEBIAN_FRONTEND=noninteractive   && apt-get update   && apt-get dist-upgrade
      -y   && apt-get install --no-install-recommends --no-install-suggests -y   xvfb   xauth   ca-certificates   x11vnc   fluxbox   xvt   curl   &&
      apt-get clean   && rm -rf   /tmp/*   /usr/share/doc/*   /var/cache/*   /var/lib/apt/lists/*   /var/tmp/*
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i 's/LISTENTCP=""/LISTENTCP="-listen tcp"/' /usr/bin/xvfb-run
    Name: run
    PrependShell: true
  - CmdLine:
    - useradd -u 1000 -m -U webdriver
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /home/webdriver
  - CmdLine:
    - export DEBIAN_FRONTEND=noninteractive   && apt-get update   && apt-get install   unzip   &&   DL=https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb   &&
      curl -sL "$DL" > /tmp/chrome.deb   && apt install --no-install-recommends --no-install-suggests
      -y   /tmp/chrome.deb   && CHROMIUM_FLAGS='--no-sandbox --disable-dev-shm-usage'   &&
      sed -i '${s/$/'" $CHROMIUM_FLAGS"'/}' /opt/google/chrome/google-chrome   &&
      BASE_URL=https://chromedriver.storage.googleapis.com   && VERSION=$(curl -sL
      "$BASE_URL/LATEST_RELEASE")   && curl -sL "$BASE_URL/$VERSION/chromedriver_linux64.zip"
      -o /tmp/driver.zip   && unzip /tmp/driver.zip   && mv chromedriver /usr/local/bin/   &&
      chmod +x /usr/local/bin/chromedriver   && apt-get autoremove --purge -y   unzip   &&
      apt-get clean   && rm -rf   /tmp/*   /usr/share/doc/*   /var/cache/*   /var/lib/apt/lists/*   /var/tmp/*
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - entrypoint.sh
    - /usr/local/bin/entrypoint
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - vnc-start.sh
    - /usr/local/bin/vnc-start
  - Name: user
    User: webdriver
  - Env:
    - Key: SCREEN_WIDTH
      Value: "1440"
    Name: env
  - Env:
    - Key: SCREEN_HEIGHT
      Value: "900"
    Name: env
  - Env:
    - Key: SCREEN_DEPTH
      Value: "24"
    Name: env
  - Env:
    - Key: DISPLAY
      Value: :0
    Name: env
  - Name: expose
    Ports:
    - "4444"
  - Name: expose
    Ports:
    - "9515"
  - Name: expose
    Ports:
    - "6000"
  - Name: expose
    Ports:
    - "5900"
  - CmdLine:
    - entrypoint
    - chromedriver
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - --port=9515
    - --whitelisted-ips
    Name: cmd
    PrependShell: false
  From:
    Image: debian:stretch-slim
  Name: ""
  Platform: ""
  SourceCode: FROM debian:stretch-slim
