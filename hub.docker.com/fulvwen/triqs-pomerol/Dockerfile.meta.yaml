MetaArgs: null
Stages:
- BaseName: fulvwen/triqs:latest
  Commands:
  - Name: user
    User: root
  - CmdLine:
    - apt-get update &&     DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends       libeigen3-dev
      &&     apt-get autoremove --purge -y &&     apt-get autoclean -y &&     rm -rf
      /var/cache/apt/* /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - Env:
    - Key: POMEROL_INSTALL_PREFIX
      Value: /opt/pomerol
    Name: env
  - Env:
    - Key: POMEROL2TRIQS_INSTALL_PREFIX
      Value: /opt/pomerol2triqs
    Name: env
  - Env:
    - Key: CPLUS_INCLUDE_PATH
      Value: /opt/pomerol/include:/opt/pomerol2triqs/include:$CPLUS_INCLUDE_PATH
    Name: env
  - Env:
    - Key: LIBRARY_PATH
      Value: /opt/pomerol/lib:/opt/pomerol2triqs/lib:$LIBRARY_PATH
    Name: env
  - Env:
    - Key: LD_LIBRARY_PATH
      Value: /opt/pomerol/lib:/opt/pomerol2triqs/lib:$LD_LIBRARY_PATH
    Name: env
  - Env:
    - Key: CMAKE_PREFIX_PATH
      Value: /opt/pomerol/share/pomerol:/opt/pomerol2triqs/share/cmake:$CMAKE_PREFIX_PATH
    Name: env
  - Env:
    - Key: PYTHONPATH
      Value: /opt/pomerol2triqs/lib/python2.7/site-packages:$PYTHONPATH
    Name: env
  - CmdLine:
    - mkdir -p $POMEROL_INSTALL_PREFIX
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p $POMEROL2TRIQS_INSTALL_PREFIX
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /tmp
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - pomerol2triqs.patch
    - /tmp/pomerol2triqs.patch
  - CmdLine:
    - git clone https://github.com/aeantipov/pomerol.git pomerol.src &&     mkdir
      -p pomerol.build && cd pomerol.build &&     cmake ../pomerol.src -DCMAKE_BUILD_TYPE=Release     -DCMAKE_INSTALL_PREFIX=$POMEROL_INSTALL_PREFIX
      &&     make && make install
    Name: run
    PrependShell: true
  - CmdLine:
    - git clone https://github.com/krivenko/pomerol2triqs.git pomerol2triqs.src &&     cd
      pomerol2triqs.src && patch -p1 < /tmp/pomerol2triqs.patch && cd .. &&    mkdir
      pomerol2triqs.build && cd pomerol2triqs.build &&     cmake ../pomerol2triqs.src
      -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=$POMEROL2TRIQS_INSTALL_PREFIX     -DPOMEROL_PATH=$POMEROL_INSTALL_PREFIX
      &&     make && make install
    Name: run
    PrependShell: true
  - Key: NB_USER
    Name: arg
    Value: triqs
  - Name: user
    User: $NB_USER
  - Name: workdir
    Path: /home/$NB_USER
  - CmdLine:
    - git clone https://github.com/aeantipov/pomerol.git
    Name: run
    PrependShell: true
  - CmdLine:
    - git clone https://github.com/krivenko/pomerol2triqs.git
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "8888"
  - CmdLine:
    - jupyter
    - notebook
    - --ip
    - 0.0.0.0
    Name: cmd
    PrependShell: false
  From:
    Image: fulvwen/triqs:latest
  Name: ""
  Platform: ""
  SourceCode: FROM fulvwen/triqs:latest
