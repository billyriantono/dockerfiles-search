MetaArgs: null
Stages:
- BaseName: dock0/pkgforge-golang
  Commands:
  - CmdLine:
    - pacman -S --noconfirm --needed clang
    Name: run
    PrependShell: true
  - CmdLine:
    - git clone https://github.com/tpoechtrager/osxcross.git /opt/osxcross
    Name: run
    PrependShell: true
  - Env:
    - Key: OSX_SDK
      Value: MacOSX10.11.sdk
    Name: env
  - Env:
    - Key: OSX_NDK_X86
      Value: /usr/local/osx-ndk-x86
    Name: env
  - Env:
    - Key: OSX_SDK_VERSION
      Value: "10.11"
    Name: env
  - Env:
    - Key: OSX_SDK_FILE
      Value: '"MacOSX${OSX_SDK_VERSION}.sdk.tar.xz"'
    Name: env
  - Env:
    - Key: OSX_SDK_URL
      Value: '"https://s3.dockerproject.org/darwin/v2/${OSX_SDK_FILE}"'
    Name: env
  - Env:
    - Key: OSX_SDK_PATH
      Value: '"/opt/osxcross/tarballs/${OSX_SDK_FILE}"'
    Name: env
  - Env:
    - Key: OSX_SDK_CHECKSUM
      Value: 694a66095a3514328e970b14978dc78c0f4d170e590fa7b2c3d3674b75f0b713
    Name: env
  - CmdLine:
    - curl -sLo "$OSX_SDK_PATH" "$OSX_SDK_URL"
    Name: run
    PrependShell: true
  - CmdLine:
    - if [[ "$(sha256sum "${OSX_SDK_PATH}" | cut -d' ' -f1)" != "${OSX_SDK_CHECKSUM}"
      ]] ; then echo 'OSX SDK Checksum mismatch' && exit 1 ; fi
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i -e 's|-march=native||g' /opt/osxcross/build_clang.sh /opt/osxcross/wrapper/build.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - UNATTENDED=yes /opt/osxcross/build.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - mv "/opt/osxcross/target" "$OSX_NDK_X86"
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - patch.tar.xz
    - $OSX_NDK_X86/SDK/$OSX_SDK/usr/include/c++
  - Env:
    - Key: PATH
      Value: '"$OSX_NDK_X86/bin:$PATH"'
    Name: env
  From:
    Image: dock0/pkgforge-golang
  Name: ""
  Platform: ""
  SourceCode: FROM dock0/pkgforge-golang
