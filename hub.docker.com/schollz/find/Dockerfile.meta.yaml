MetaArgs: null
Stages:
- BaseName: ubuntu:16.04
  Commands:
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get -y upgrade
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y git wget curl vim
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y python3 python3-dev python3-pip
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y python3-scipy python3-numpy
    Name: run
    PrependShell: true
  - CmdLine:
    - python3 -m pip install scikit-learn
    Name: run
    PrependShell: true
  - Name: workdir
    Path: '"/tmp"'
  - CmdLine:
    - wget http://www.csie.ntu.edu.tw/~cjlin/cgi-bin/libsvm.cgi?+http://www.csie.ntu.edu.tw/~cjlin/libsvm+tar.gz
      -O libsvm.tar.gz
    Name: run
    PrependShell: true
  - CmdLine:
    - tar -xvzf libsvm.tar.gz
    Name: run
    PrependShell: true
  - CmdLine:
    - mv libsvm-*/* ./
    Name: run
    PrependShell: true
  - CmdLine:
    - make
    Name: run
    PrependShell: true
  - CmdLine:
    - cp svm-scale /usr/local/bin/
    Name: run
    PrependShell: true
  - CmdLine:
    - cp svm-predict /usr/local/bin/
    Name: run
    PrependShell: true
  - CmdLine:
    - cp svm-train /usr/local/bin/
    Name: run
    PrependShell: true
  - CmdLine:
    - rm -rf *
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y mosquitto-clients mosquitto
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://storage.googleapis.com/golang/go1.9.2.linux-amd64.tar.gz
    Name: run
    PrependShell: true
  - CmdLine:
    - tar -C /usr/local -xzf go1.9.2.linux-amd64.tar.gz
    Name: run
    PrependShell: true
  - CmdLine:
    - rm go1.9*
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: '"/usr/local/go/bin:${PATH}"'
    Name: env
  - CmdLine:
    - mkdir /usr/local/work
    Name: run
    PrependShell: true
  - Env:
    - Key: GOPATH
      Value: /usr/local/work
    Name: env
  - CmdLine:
    - go get github.com/schollz/find
    Name: run
    PrependShell: true
  - Name: workdir
    Path: '"/usr/local/work/src/github.com/schollz/find"'
  - CmdLine:
    - rm supervisord.conf
    Name: run
    PrependShell: true
  - CmdLine:
    - go build -v
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "\ninclude_dir /usr/local/work/src/github.com/schollz/find/mosquitto" >>
      /etc/mosquitto/mosquitto.conf
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y supervisor
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - supervisord.conf
    - /etc/supervisor/conf.d/supervisord.conf
  - Env:
    - Key: TINI_VERSION
      Value: v0.13.0
    Name: env
  - Chown: ""
    Name: add
    SourcesAndDest:
    - https://github.com/krallin/tini/releases/download/${TINI_VERSION}/tini
    - /tini
  - CmdLine:
    - chmod +x /tini
    Name: run
    PrependShell: true
  - CmdLine:
    - /tini
    - --
    Name: entrypoint
    PrependShell: false
  - Env:
    - Key: MQTT_SERVER
      Value: localhost:1883
    - Key: MQTT_USERNAME
      Value: admin
    - Key: MQTT_PASSWORD
      Value: "123"
    Name: env
  - CmdLine:
    - /usr/bin/supervisord
    Name: cmd
    PrependShell: false
  From:
    Image: ubuntu:16.04
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:16.04
