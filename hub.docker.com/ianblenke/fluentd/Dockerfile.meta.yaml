MetaArgs: null
Stages:
- BaseName: ruby:latest
  Commands:
  - Maintainer: Ian Blenke <ian@blenke.com>
    Name: maintainer
  - CmdLine:
    - 'echo "gem: --no-document --no-ri --no-rdoc\n" >> ~/.gemrc'
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update &&     apt-get install -yq libcurl4-openssl-dev supervisor python-pip
      &&     apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - "gem install fluentd && \tfluent-gem install \t\tfluent-plugin-elasticsearch
      \t\tfluent-plugin-record-reformer \t\tfluent-plugin-cloudwatch \t\tfluent-plugin-cloudwatch-logs
      \t\tfluent-plugin-s3"
    Name: run
    PrependShell: true
  - CmdLine:
    - pip install supervisor-stdout
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - https://github.com/kelseyhightower/confd/releases/download/v0.7.1/confd-0.7.1-linux-amd64
    - /usr/local/bin/confd
  - CmdLine:
    - curl -L  https://github.com/coreos/etcd/releases/download/v0.4.6/etcd-v0.4.6-linux-amd64.tar.gz
      -o /tmp/etcd-v0.4.6-linux-amd64.tar.gz ;     tar xzf /tmp/etcd-v0.4.6-linux-amd64.tar.gz
      -C /tmp ;     cd /tmp/etcd-v0.4.6-linux-amd64 ;     cp -f etcd /usr/local/bin/etcd
      ;     cp -f etcdctl /usr/local/bin/etcdctl ;     cd /tmp ;     rm -fr /tmp/etcd-v0.4.6-linux-amd64*
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod +x /usr/local/bin/confd /usr/local/bin/etcd /usr/local/bin/etcdctl
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - run.sh
    - /run.sh
  - CmdLine:
    - chmod +x /run.sh
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "5170"
    - 5170/udp
  - Name: volume
    Volumes:
    - /data
  - CmdLine:
    - /run.sh
    Name: cmd
    PrependShell: false
  From:
    Image: ruby:latest
  Name: ""
  Platform: ""
  SourceCode: FROM ruby:latest
