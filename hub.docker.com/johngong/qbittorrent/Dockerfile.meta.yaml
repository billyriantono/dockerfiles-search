MetaArgs: null
Stages:
- As: compilingqb
  BaseName: alpine:3.10
  Commands:
  - Key: LIBTORRENT_VER
    Name: arg
    Value: 1.2.3
  - Key: QBITTORRENT_VER
    Name: arg
    Value: 4.2.1.10
  - CmdLine:
    - apk add --no-cache ca-certificates make g++ gcc qt5-qtsvg-dev boost-dev qt5-qttools-dev
      file &&   mkdir /qbtorrent  &&   wget -P /qbtorrent https://github.com/arvidn/libtorrent/releases/download/libtorrent-`echo
      "$LIBTORRENT_VER"|sed 's#\.#_#g'`/libtorrent-rasterbar-${LIBTORRENT_VER}.tar.gz   &&   tar  -zxvf  /qbtorrent/libtorrent-rasterbar-${LIBTORRENT_VER}.tar.gz   -C    /qbtorrent  &&   cd  /qbtorrent/libtorrent-rasterbar-${LIBTORRENT_VER}
      &&   ./configure  --host=x86_64-alpine-linux-musl &&   make install-strip &&   wget  -P
      /qbtorrent https://github.com/c0re100/qBittorrent-Enhanced-Edition/archive/release-${QBITTORRENT_VER}.zip   &&   unzip   /qbtorrent/release-${QBITTORRENT_VER}.zip  -d    /qbtorrent
      &&   cd  /qbtorrent/qBittorrent-Enhanced-Edition-release-${QBITTORRENT_VER}
      &&   ./configure   --disable-gui --host=x86_64-alpine-linux-musl &&   make install
      &&   ldd /usr/local/bin/qbittorrent-nox   |cut -d ">" -f 2|grep lib|cut -d "("
      -f 1|xargs tar -chvf /qbtorrent/qbittorrent.tar  &&   mkdir /qbittorrent   &&   tar  -xvf
      /qbtorrent/qbittorrent.tar   -C  /qbittorrent   &&   cp --parents /usr/local/bin/qbittorrent-nox  /qbittorrent
    Name: run
    PrependShell: true
  From:
    Image: alpine:3.10
  Name: compilingqb
  Platform: ""
  SourceCode: FROM alpine:3.10 as compilingqB
- BaseName: alpine:3.10
  Commands:
  - Key: S6_VER
    Name: arg
    Value: 1.22.1.0
  - Env:
    - Key: TRACKERSAUTO
      Value: "YES"
    Name: env
  - Env:
    - Key: TZ
      Value: Asia/Shanghai
    Name: env
  - Env:
    - Key: WEBUIPORT
      Value: "8989"
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - root
    - /
  - Chown: ""
    From: compilingqB
    Name: copy
    SourcesAndDest:
    - /qbittorrent
    - /
  - CmdLine:
    - wget --no-check-certificate https://github.com/just-containers/s6-overlay/releases/download/v${S6_VER}/s6-overlay-amd64.tar.gz  &&   tar
      -xvzf s6-overlay-amd64.tar.gz  &&   rm s6-overlay-amd64.tar.gz   &&   apk add
      --no-cache bash curl ca-certificates  tzdata  python3 &&   rm -rf /var/cache/apk/*   &&   chmod
      a+x  /usr/local/qbittorrent/updatetrackers.sh  &&   chmod a+x  /usr/local/bin/qbittorrent-nox
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /Downloads
    - /config
  - Name: expose
    Ports:
    - "6881"
    - 6881/udp
    - "8989"
  - CmdLine:
    - /init
    Name: entrypoint
    PrependShell: false
  From:
    Image: alpine:3.10
  Name: ""
  Platform: ""
  SourceCode: FROM alpine:3.10
