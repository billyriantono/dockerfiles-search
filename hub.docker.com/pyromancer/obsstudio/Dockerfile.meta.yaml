MetaArgs: null
Stages:
- BaseName: debian:testing
  Commands:
  - Maintainer: Pyromancer <pyromancer@fireinthedeep.com>
    Name: maintainer
  - CmdLine:
    - apt-get update && apt-get install -y build-essential pkg-config cmake git checkinstall
      software-properties-common sudo wget
    Name: run
    PrependShell: true
  - CmdLine:
    - add-apt-repository non-free
    Name: run
    PrependShell: true
  - CmdLine:
    - add-apt-repository contrib
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y libx11-dev libgl1-mesa-dev libpulse-dev libxcomposite-dev
      libxinerama-dev libv4l-dev libudev-dev libfreetype6-dev libfontconfig-dev qtbase5-dev
      libqt5x11extras5-dev libx264-dev libxcb-xinerama0-dev libxcb-shm0-dev libjack-jackd2-dev
      libcurl4-openssl-dev libav-tools libavcodec-dev libavfilter-dev libavdevice-dev
      libfdk-aac-dev ffmpeg
    Name: run
    PrependShell: true
  - CmdLine:
    - export uid=1000 gid=1000
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /home/obs
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "obs:x:${uid}:${gid}:OpenBroadcastSoftware,,,:/home/obs:/bin/bash" >> /etc/passwd
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "obs:x:${uid}:" >> /etc/group
    Name: run
    PrependShell: true
  - CmdLine:
    - 'echo "obs ALL=(ALL) NOPASSWD: ALL" >> /etc/sudoers'
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod 0440 /etc/sudoers
    Name: run
    PrependShell: true
  - CmdLine:
    - chown ${uid}:${gid} -R /home/obs
    Name: run
    PrependShell: true
  - Name: user
    User: obs
  - Env:
    - Key: HOME
      Value: /home/obs
    Name: env
  - Name: workdir
    Path: /home/obs
  - CmdLine:
    - git clone https://github.com/jp9000/obs-studio.git
    Name: run
    PrependShell: true
  - CmdLine:
    - cd ./obs-studio && mkdir ./build
    Name: run
    PrependShell: true
  - CmdLine:
    - cd ./obs-studio/ && cmake -DUNIX_STRUCTURE=1 -DCMAKE_INSTALL_PREFIX=/usr
    Name: run
    PrependShell: true
  - CmdLine:
    - cd ./obs-studio/ && make -j4
    Name: run
    PrependShell: true
  - CmdLine:
    - cd ./obs-studio/ && sudo checkinstall --pkgname=FFmpeg --fstrans=no --backup=no
      --pkgversion="$(date +%Y%m%d)-git" --deldoc=yes
    Name: run
    PrependShell: true
  - CmdLine:
    - wget http://download.nomachine.com/download/5.1/Linux/nomachine_5.1.9_6_amd64.deb
    Name: run
    PrependShell: true
  - CmdLine:
    - sudo dpkg -i ./nomachine_5.1.9_6_amd64.deb
    Name: run
    PrependShell: true
  From:
    Image: debian:testing
  Name: ""
  Platform: ""
  SourceCode: FROM debian:testing
