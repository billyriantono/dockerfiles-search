MetaArgs: null
Stages:
- BaseName: debian:stretch-slim
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"EEA: IDM2 A-Team <eea-edw-a-team-alerts@googlegroups.com>"'
    Name: label
  - Env:
    - Key: CYNIN_PATH
      Value: /var/local
    Name: env
  - Env:
    - Key: CYNIN_BUILDOUT
      Value: https://svn.eionet.europa.eu/repositories/Zope/trunk/community.eea.europa.eu/tags/2.5
    Name: env
  - Env:
    - Key: CYNIN_NAME
      Value: community.eea.europa.eu
    Name: env
  - Env:
    - Key: INSTANCEDIR
      Value: $CYNIN_PATH/$CYNIN_NAME
    Name: env
  - CmdLine:
    - groupadd -g 500 cynin  && mkdir -p $INSTANCEDIR  && useradd cynin -d $INSTANCEDIR
      -u 500 -g cynin  && chown -R cynin:cynin $INSTANCEDIR
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - install.sh
    - /tmp/
  - CmdLine:
    - apt-get update  && apt-get -y  install ca-certificates git wget gcc build-essential
      subversion cron gosu nano     libblas-dev     libc6-dev     libexpat1-dev     libjpeg-dev      liblapack-dev     libldap2-dev     libmemcached-dev     libpq-dev     libreadline-dev     libsasl2-dev      libssl-dev     libxml2-dev     libxmlsec1-dev      libxslt-dev     libxslt1-dev     libz-dev     zlib1g-dev     libfreetype6     libfreetype6-dev  &&
      apt-get -y install libssl1.0-dev libjpeg62 libpng16-16  librsvg2-bin  && mkdir
      /opt/python-2.4  && cd /tmp  && wget https://www.python.org/ftp/python/2.4.6/Python-2.4.6.tgz  &&
      tar zxf Python-2.4.6.tgz  && cd Python-2.4.6  && find / -name *ssl  && grep
      -i ssl Modules/Setup.dist  && sed -i '/_ssl/s/^#//g' Modules/Setup.dist  &&
      sed -i '/DUSE_SSL/s/^#//g' Modules/Setup.dist  && sed -i '/lssl/s/^#//g' Modules/Setup.dist  &&
      grep -i ssl Modules/Setup.dist  && ./configure --with-zlib=/usr/include --prefix=/opt/python-2.4
      --enable-ipv6  && sed -i "s/^#zlib/zlib/g" Modules/Setup  && make  && make install  &&
      ls /opt/python-2.4/bin  && ln -s  /opt/python-2.4/bin/python2.4 //usr/local/bin/python2.4  &&
      cd $INSTANCEDIR  && svn co $CYNIN_BUILDOUT .  && mv /tmp/install.sh .  && ./install.sh  &&
      ./bin/buildout -c deploy.cfg  && touch var/log/event.log  && chown -R cynin:cynin
      $INSTANCEDIR  && apt-get remove -y --purge git subversion gcc build-essential
      zlib1g-dev libssl-dev libxmlsec1-dev  && apt-get autoremove -y  && apt-get autoclean  &&
      rm -rf /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "8080"
  - Name: workdir
    Path: $INSTANCEDIR
  - Name: user
    User: root
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - docker-entrypoint.sh
    - /
  - CmdLine:
    - /docker-entrypoint.sh
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - start
    Name: cmd
    PrependShell: false
  From:
    Image: debian:stretch-slim
  Name: ""
  Platform: ""
  SourceCode: FROM debian:stretch-slim
