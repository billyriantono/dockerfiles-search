MetaArgs: null
Stages:
- BaseName: ubuntu
  Commands:
  - Maintainer: Niels Theen <werwofl@googlemail.com>
    Name: maintainer
  - CmdLine:
    - DEBIAN_FRONTEND=noninteractive apt-get update && apt-get install -y     php5
      php5-pgsql php5-fpm php-apc php5-curl php5-cli supervisor ruby unzip python
      wget nginx php5-sqlite php5-gd    && apt-get clean
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - https://github.com/SSilence/selfoss/releases/download/2.12/selfoss-2.12.zip
    - /selfoss-2.12.zip
  - CmdLine:
    - unzip selfoss-2.12.zip -d /var/www
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /var/www
  - CmdLine:
    - chmod +rwx data/cache
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod +rwx data/favicons
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod +rwx data/logs
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod +rwx data/thumbnails
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod +rwx data/sqlite
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod +rwx public
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod +rwx index.php
    Name: run
    PrependShell: true
  - CmdLine:
    - cp defaults.ini config.ini
    Name: run
    PrependShell: true
  - CmdLine:
    - php update.php
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - selfoss.nginx.conf
    - /etc/nginx/sites-available/selfoss
  - CmdLine:
    - ln -s /etc/nginx/sites-available/selfoss /etc/nginx/sites-enabled/selfoss
    Name: run
    PrependShell: true
  - CmdLine:
    - rm /etc/nginx/sites-enabled/default
    Name: run
    PrependShell: true
  - CmdLine:
    - chown www-data:www-data -R /var/www
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - supervisord.conf
    - /etc/supervisor/conf.d/supervisord.conf
  - CmdLine:
    - supervisord -c /etc/supervisor/conf.d/supervisord.conf
    Name: cmd
    PrependShell: true
  - Name: expose
    Ports:
    - "80"
  From:
    Image: ubuntu
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu
