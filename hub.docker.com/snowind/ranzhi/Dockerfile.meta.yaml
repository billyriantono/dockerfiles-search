MetaArgs: null
Stages:
- BaseName: debian:9-slim
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"Snowind <jinks.tao@gmail.com>"'
    - Key: description
      Value: '"ranzhi4.7+zentao10.0+xuanxuan1.6"'
    Name: label
  - Key: RANZHI_URL
    Name: arg
    Value: http://dl.cnezsoft.com/ranzhi/4.7/ranzhi.4.7.stable.zip
  - Key: ZENTAO_URL
    Name: arg
    Value: http://dl.cnezsoft.com/zentao/10.0/ZenTaoPMS.10.0.stable.zip
  - Key: XUANXUAN_URL
    Name: arg
    Value: http://dl.cnezsoft.com/xuanxuan/1.6/xuanxuan.ranzhi.1.6.0.zip
  - Env:
    - Key: IS_HTTPS
      Value: "NO"
    Name: env
  - Env:
    - Key: MYSQL_HOME
      Value: /var/lib/mysql
    Name: env
  - Env:
    - Key: MYSQL_TEMP
      Value: /tmp/mysql
    Name: env
  - Env:
    - Key: MYSQL_ADMIN_USER
      Value: admin
    Name: env
  - Env:
    - Key: MYSQL_ADMIN_PASS
      Value: admin888
    Name: env
  - CmdLine:
    - apt-get update &&     apt-get upgrade -y &&     apt-get install curl unzip mysql-server
      apache2 php php-mbstring php-curl php-mysql --no-install-recommends -y &&     apt-get
      clean &&     service apache2 stop &&     update-rc.d -f apache remove &&     update-rc.d
      -f apache2 remove &&     update-rc.d -f mysql remove
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p $MYSQL_TEMP &&     mv $MYSQL_HOME/* $MYSQL_TEMP
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - http-000-default.conf
    - /tmp/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - https-000-default.conf
    - /tmp/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - https-default-ssl.conf
    - /tmp/
  - CmdLine:
    - echo "ServerName localhost" >> /etc/apache2/apache2.conf
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -o ranzhi.zip $RANZHI_URL &&     mv ranzhi.zip /tmp/ &&     curl -o zentao.zip
      $ZENTAO_URL &&     mv zentao.zip /tmp/ &&     curl -o xuanxuan.zip $XUANXUAN_URL
      &&     mv xuanxuan.zip /tmp/
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - startup.sh
    - /usr/sbin/
  - CmdLine:
    - chmod +x /usr/sbin/startup.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - /usr/sbin/startup.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: debian:9-slim
  Name: ""
  Platform: ""
  SourceCode: FROM debian:9-slim
