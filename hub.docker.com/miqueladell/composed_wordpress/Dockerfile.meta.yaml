MetaArgs: null
Stages:
- BaseName: php:7.0.2-apache
  Commands:
  - Maintainer: Miquel Adell <miquel@miqueladell.com>
    Name: maintainer
  - Env:
    - Key: WORDPRESS_VERSION
      Value: '4.4.1 #can we do that dynamic?'
    Name: env
  - CmdLine:
    - apt-get update     && apt-get install -y         libpng12-dev         libjpeg-dev          curl         sed         zlib1g-dev         rsync     &&
      docker-php-ext-install         zip         mysqli
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin
      --filename=composer
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /tmp/html
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /tmp/html
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - files/composer.json
    - composer.json
  - CmdLine:
    - composer update
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - files/.gitignore
    - .gitignore
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - files/index.php
    - index.php
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - files/wordpress/wp-config-custom.php
    - wordpress/wp-config-custom.php
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - files/wordpress/post-install-script.sh
    - wordpress/post-install-script.sh
  - CmdLine:
    - chown -R www-data:www-data /tmp/html
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /tmp/html
  - CmdLine:
    - rsync --ignore-existing --archive --verbose --human-readable --progress /tmp/html/
      .
    Name: run
    PrependShell: true
  - CmdLine:
    - chown -R www-data:www-data /var/www/html
    Name: run
    PrependShell: true
  - CmdLine:
    - rm -rf /tmp/html/
    Name: run
    PrependShell: true
  - Expression: RUN wordpress/post-install-script.sh
    Name: onbuild
  - Expression: RUN sed '/WP_DEBUG/ r wordpress/wp-config-custom.php' wordpress/wp-config.php
      > wordpress/tmp && mv wordpress/tmp wordpress/wp-config.php && rm wordpress/wp-config-custom.php
    Name: onbuild
  - Expression: VOLUME /var/www/html/
    Name: onbuild
  From:
    Image: php:7.0.2-apache
  Name: ""
  Platform: ""
  SourceCode: FROM php:7.0.2-apache
