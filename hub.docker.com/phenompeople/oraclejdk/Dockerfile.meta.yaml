MetaArgs: null
Stages:
- BaseName: amazonlinux:2
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"rajesh.jonnalagadda@phenompeople.com"'
    - Key: version
      Value: '"1.8.0_201"'
    Name: label
  - Key: APP_HOME
    Name: arg
    Value: /opt/deployment
  - CmdLine:
    - "yum install wget shadow-utils tar gzip -y -q && \tuseradd phenom -d ${APP_HOME}
      -u 1004"
    Name: run
    PrependShell: true
  - Key: JAVA_VERSION
    Name: arg
    Value: 8u201
  - Key: JAVA_DIR
    Name: arg
    Value: jdk1.8.0_201
  - Key: JAVA_BUILD
    Name: arg
    Value: b09
  - CmdLine:
    - "wget -q -O /tmp/jdk-linux-x64.tar.gz --no-cookies --no-check-certificate --header
      \"Cookie: oraclelicense=accept-securebackup-cookie\"       \"http://download.oracle.com/otn-pub/java/jdk/${JAVA_VERSION}-${JAVA_BUILD}/42970487e3af4f5aa5bca3f542482c60/jdk-${JAVA_VERSION}-linux-x64.tar.gz\"
      \ &&      tar -xzf /tmp/jdk-linux-x64.tar.gz -C /usr/local &&      ln -sf /usr/local/${JAVA_DIR}/bin/java
      /usr/local/bin &&      ln -sf /usr/local/${JAVA_DIR} /usr/local/jdk &&   \t
      mkdir -p /opt/deployment/dumps &&   \t rm -rf /tmp/jdk-linux-x64.tar.gz"
    Name: run
    PrependShell: true
  - CmdLine:
    - "rm -f /usr/local/jdk/release /usr/local/jdk/javafx-src.zip && \t rm -f /usr/local/jdk/COPYRIGHT
      /usr/local/jdk/src.zip && \t rm -f /usr/local/jdk/README.html /usr/local/jdk/LICENSE
      && \t rm -f /usr/local/jdk/THIRDPARTYLICENSEREADME.txt /usr/local/jdk/THIRDPARTYLICENSEREADME-JAVAFX.txt
      && \t rm -f /usr/local/jdk/Welcome.html"
    Name: run
    PrependShell: true
  - CmdLine:
    - "rm -f /usr/local/jdk/jre/COPYRIGHT /usr/local/jdk/jre/LICENSE /usr/local/jdk/jre/README
      && \t rm -f /usr/local/jdk/jre/THIRDPARTYLICENSEREADME.txt /usr/local/jdk/jre/THIRDPARTYLICENSEREADME-JAVAFX.txt
      && \t rm -f /usr/local/jdk/jre/Welcome.html"
    Name: run
    PrependShell: true
  - CmdLine:
    - wget -q -O /usr/local/${JAVA_DIR}/lib/apm-agent-java.jar http://central.maven.org/maven2/co/elastic/apm/elastic-apm-agent/1.3.0/elastic-apm-agent-1.3.0.jar
    Name: run
    PrependShell: true
  - Env:
    - Key: JAVA_HOME
      Value: /usr/local/${JAVA_DIR}
    Name: env
  - Env:
    - Key: JAVA_OPTS
      Value: "\"$JAVA_OPTS -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=75
        -XX:+UseCMSInitiatingOccupancyOnly -XX:+AlwaysPreTouch -server -Xss1m -Djava.awt.headless=true
        -Dfile.encoding=UTF-8 \t -Djna.nosys=true -Djdk.io.permissionsUseCanonicalPath=true
        -Dio.netty.noUnsafe=true -Dio.netty.noKeySetOptimization=true -Dio.netty.recycler.maxCapacityPerThread=0
        -Dlog4j.shutdownHookEnabled=false \t -Dlog4j2.disable.jmx=true -Dlog4j.skipJansi=true
        -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/opt/phenom/dumps\""
    Name: env
  - Env:
    - Key: LANG
      Value: en_US.UTF-8
    Name: env
  - Env:
    - Key: PATH
      Value: $JAVA_HOME/bin:$PATH
    Name: env
  - Expression: 'RUN  yum update --security -q -y '
    Name: onbuild
  From:
    Image: amazonlinux:2
  Name: ""
  Platform: ""
  SourceCode: FROM amazonlinux:2
