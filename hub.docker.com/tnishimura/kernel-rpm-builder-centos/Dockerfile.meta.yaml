MetaArgs: null
Stages:
- BaseName: centos
  Commands:
  - Name: workdir
    Path: /root/
  - CmdLine:
    - yum install -y rpmdevtools gcc make rpm-build yum-utils epel-release
    Name: run
    PrependShell: true
  - CmdLine:
    - yum install -y distcc
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /root/distcc/ /root/.distcc
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -s /usr/bin/distcc /root/distcc/gcc
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -s /usr/bin/distcc /root/distcc/cc
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: /root/distcc/:$PATH
    Name: env
  - Env:
    - Key: DISTCC_HOSTS
      Value: '"localhost"'
    Name: env
  - CmdLine:
    - yum install -y ccache
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /root/.ccache
    Name: run
    PrependShell: true
  - Env:
    - Key: USE_CCACHE
      Value: "1"
    Name: env
  - Env:
    - Key: CCACHE_DIR
      Value: /root/.ccache
    Name: env
  - CmdLine:
    - ccache --max-size=5
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: /usr/lib64/ccache:$PATH
    Name: env
  - CmdLine:
    - ccache -s
    Name: run
    PrependShell: true
  - CmdLine:
    - rpmdev-setuptree
    Name: run
    PrependShell: true
  - CmdLine:
    - yumdownloader --source kernel
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -ivh kernel-*.src.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - yum-builddep -y /root/rpmbuild/SPECS/kernel.spec
    Name: run
    PrependShell: true
  - CmdLine:
    - time rpmbuild -ba --clean --with baseonly --without debug /root/rpmbuild/SPECS/kernel.spec
    Name: run
    PrependShell: true
  - CmdLine:
    - ccache -s
    Name: run
    PrependShell: true
  - CmdLine:
    - bash
    Name: cmd
    PrependShell: true
  From:
    Image: centos
  Name: ""
  Platform: ""
  SourceCode: FROM centos
