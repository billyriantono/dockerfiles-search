MetaArgs: null
Stages:
- As: steamcmd-gmail
  BaseName: yard1/steamcmd_gmail
  Commands: null
  From:
    Image: yard1/steamcmd_gmail
  Name: steamcmd-gmail
  Platform: ""
  SourceCode: FROM yard1/steamcmd_gmail as steamcmd-gmail
- BaseName: yard1/steam_headless
  Commands:
  - Labels:
    - Key: author
      Value: '"Antoni Baum (Yard1) <antoni.baum@protonmail.com>"'
    Name: label
  - Name: user
    User: root
  - CmdLine:
    - "set -x \t&& apt-get update \t&& apt-get install -y --no-install-suggests --no-install-recommends
      \txdotool imagemagick xsel xauth xxd x11vnc \t&& rm -rf /var/lib/apt/lists/*"
    Name: run
    PrependShell: true
  - Name: user
    User: steam
  - Chown: steam:steam
    From: steamcmd-gmail
    Name: copy
    SourcesAndDest:
    - /opt/steamcmd
    - /opt/steamcmd
  - Chown: steam:steam
    From: steamcmd-gmail
    Name: copy
    SourcesAndDest:
    - /steamcmd_gmail
    - /opt/steamcmd_gmail
  - CmdLine:
    - mkdir -p "/home/steam/.local/share/Paradox Interactive/Hearts of Iron IV/mod"
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -s "/home/steam/.local/share/Paradox Interactive/Hearts of Iron IV/mod" "/home/steam/mod"
    Name: run
    PrependShell: true
  - Name: workdir
    Path: '"/home/steam/.local/share/Paradox Interactive/Hearts of Iron IV/"'
  - CmdLine:
    - mkdir -p "/home/steam/.steam/steam/steamapps/common/Hearts of Iron IV"
    Name: run
    PrependShell: true
  - Key: target
    Name: arg
    Value: '"/home/steam/.steam/steam/steamapps/common/Hearts of Iron IV"'
  - Env:
    - Key: DISPLAY
      Value: :98
    Name: env
  - CmdLine:
    - /opt/steamcmd/steamcmd.sh +quit
    Name: run
    PrependShell: true
  - CmdLine:
    - /home/steam/update_steam.sh
    Name: run
    PrependShell: true
  - Chown: steam:steam
    Name: add
    SourcesAndDest:
    - data/hoi4
    - ${target}
  - Chown: steam:steam
    Name: add
    SourcesAndDest:
    - data/appmanifest_394360.acf
    - '"/home/steam/.steam/steam/steamapps/"'
  - CmdLine:
    - mkdir /home/steam/image_specimens
    Name: run
    PrependShell: true
  - Chown: steam:steam
    Name: add
    SourcesAndDest:
    - image_specimens
    - /home/steam/image_specimens
  - Chown: steam:steam
    Name: add
    SourcesAndDest:
    - lib/xdotool_script.sh
    - /home/steam
  - CmdLine:
    - chmod 755 /home/steam/xdotool_script.sh && sed -i 's/\r$//' /home/steam/xdotool_script.sh
    Name: run
    PrependShell: true
  - Name: user
    User: root
  - Chown: ""
    Name: add
    SourcesAndDest:
    - lib/entrypoint.sh
    - /entrypoint.sh
  - CmdLine:
    - chmod 755 /entrypoint.sh && sed -i 's/\r$//' /entrypoint.sh
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "5998"
  - Env:
    - Key: DISPLAY
      Value: :98
    Name: env
  - Key: VNC
    Name: arg
    Value: "0"
  - CmdLine:
    - "set -x \t&& if [ \"$VNC\" != 0 ]; then \tapt-get update \t&& apt-get install
      -y --no-install-suggests --no-install-recommends \tx11vnc; else apt-get remove
      --purge -y x11vnc; fi \t&& apt-get clean autoclean \t&& apt-get autoremove -y
      \t&& rm -rf /var/lib/apt/lists/*"
    Name: run
    PrependShell: true
  - Name: user
    User: steam
  - CmdLine:
    - /entrypoint.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: yard1/steam_headless
  Name: ""
  Platform: ""
  SourceCode: FROM yard1/steam_headless
