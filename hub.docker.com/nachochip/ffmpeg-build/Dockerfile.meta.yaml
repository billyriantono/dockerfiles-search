MetaArgs: null
Stages:
- BaseName: debian:stable
  Commands:
  - Maintainer: Nachochip <blockchaincolony@gmail.com>
    Name: maintainer
  - Env:
    - Key: FFMPEG_VERSION
      Value: 3.2.4
    Name: env
  - Env:
    - Key: YASM_VERSION
      Value: 1.3.0
    Name: env
  - Env:
    - Key: FDKAAC_VERSION
      Value: 0.1.5
    Name: env
  - Env:
    - Key: BLACKMAGIC_SDK_VERSION
      Value: 10.8.3
    Name: env
  - Env:
    - Key: SRC
      Value: /usr/local
    Name: env
  - Env:
    - Key: LD_LIBRARY_PATH
      Value: ${SRC}/lib
    Name: env
  - Env:
    - Key: PKG_CONFIG_PATH
      Value: ${SRC}/lib/pkgconfig
    Name: env
  - CmdLine:
    - bash -c 'set -euo pipefail'
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y autoconf automake gcc build-essential git libtool make nasm
      zlib1g-dev tar curl
    Name: run
    PrependShell: true
  - CmdLine:
    - DIR=$(mktemp -d) && cd ${DIR} &&               curl -Os http://www.tortall.net/projects/yasm/releases/yasm-${YASM_VERSION}.tar.gz
      &&               tar xzvf yasm-${YASM_VERSION}.tar.gz &&               cd yasm-${YASM_VERSION}
      &&               ./configure --prefix="$SRC" --bindir="${SRC}/bin" &&               make
      &&               make install &&               make distclean &&               rm
      -rf ${DIR}
    Name: run
    PrependShell: true
  - CmdLine:
    - DIR=$(mktemp -d) && cd ${DIR} &&               git clone --depth 1 git://git.videolan.org/x264
      &&               cd x264 &&               ./configure --prefix="$SRC" --bindir="${SRC}/bin"
      --enable-static &&               make &&               make install &&               make
      distclean &&               rm -rf ${DIR}
    Name: run
    PrependShell: true
  - CmdLine:
    - DIR=$(mktemp -d) && cd ${DIR} &&               curl -s https://codeload.github.com/mstorsjo/fdk-aac/tar.gz/v${FDKAAC_VERSION}
      | tar zxvf - &&               cd fdk-aac-${FDKAAC_VERSION} &&               autoreconf
      -fiv &&               ./configure --prefix="${SRC}" --disable-shared &&               make
      &&               make install &&               make distclean &&               rm
      -rf ${DIR}
    Name: run
    PrependShell: true
  - CmdLine:
    - "cd /usr/src/ && \t      curl -s https://codeload.github.com/nachochip/Blackmagic-SDK/tar.gz/${BLACKMAGIC_SDK_VERSION}
      | tar xzvf -"
    Name: run
    PrependShell: true
  - CmdLine:
    - DIR=$(mktemp -d) && cd ${DIR} &&               curl -Os http://ffmpeg.org/releases/ffmpeg-${FFMPEG_VERSION}.tar.gz
      &&               tar xzvf ffmpeg-${FFMPEG_VERSION}.tar.gz &&               cd
      ffmpeg-${FFMPEG_VERSION} &&               ./configure --prefix="${SRC}" --extra-cflags="-I${SRC}/include"
      --extra-ldflags="-L${SRC}/lib" --bindir="${SRC}/bin"               --extra-libs=-ldl
      --enable-version3 --enable-libx264 --enable-gpl               --enable-postproc
      --enable-nonfree --enable-avresample --enable-libfdk_aac --disable-debug --enable-small               --enable-decklink
      --extra-cflags=-I/usr/src/Blackmagic-SDK-${BLACKMAGIC_SDK_VERSION}/Linux/include/               --extra-ldflags=-L/usr/src/Blackmagic-SDK-${BLACKMAGIC_SDK_VERSION}/Linux/include/
      &&               make &&               make install &&               make distclean
      &&               hash -r &&               rm -rf ${DIR}
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get purge -y autoconf automake gcc build-essential git libtool make nasm
      zlib1g-dev curl
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get autoclean
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "/usr/local/lib" > /etc/ld.so.conf.d/libc.conf
    Name: run
    PrependShell: true
  - CmdLine:
    - --help
    Name: cmd
    PrependShell: false
  - CmdLine:
    - ffmpeg
    Name: entrypoint
    PrependShell: false
  From:
    Image: debian:stable
  Name: ""
  Platform: ""
  SourceCode: "FROM\t\tdebian:stable"
