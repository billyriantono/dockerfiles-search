MetaArgs: null
Stages:
- As: build
  BaseName: golang:1.11
  Commands:
  - CmdLine:
    - "go get github.com/golang/dep \t&& go install github.com/golang/dep/..."
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - .
    - /go/src/github.com/Al2Klimov/check_golang_dep
  - CmdLine:
    - "cd /go/src/github.com/Al2Klimov/check_golang_dep \t&& /go/bin/dep ensure \t&&
      go generate \t&& go install ."
    Name: run
    PrependShell: true
  From:
    Image: golang:1.11
  Name: build
  Platform: ""
  SourceCode: FROM golang:1.11 as build
- BaseName: grandmaster/check-plugins-demo
  Commands:
  - Name: shell
    Shell:
    - /bin/bash
    - -exo
    - pipefail
    - -c
  - CmdLine:
    - "apt-get update ;\tDEBIAN_FRONTEND=noninteractive apt-get install --no-install-{recommends,suggests}
      -y \t\tgolang-go git-core ;\tapt-get clean ;\trm -vrf /var/lib/apt/lists/*"
    Name: run
    PrependShell: true
  - CmdLine:
    - "a2enmod cgi ;\ta2enmod alias ;\ta2enmod env ;\tfor cat in lolcat grumpycat;
      do \t\tmkdir -p /var/www/git/toni/$cat.git ;\t\tpushd /var/www/git/toni/$cat.git
      ;\t\tgit init --bare ;\t\tgit config http.receivepack true ;\t\tgit config http.uploadpack
      true ;\t\tpopd ;\tdone ;\tchown -R www-data:www-data /var/www/git"
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - _docker/apache2-git.conf
    - /etc/apache2/sites-available/git.conf
  - CmdLine:
    - a2ensite git
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - _docker/git-toni.sh
    - /
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - _docker/supervisord.conf
    - /etc/supervisord/conf.d/git-toni.conf
  - Chown: ""
    From: build
    Name: copy
    SourcesAndDest:
    - /go/bin/dep
    - /usr/local/bin/
  - Chown: ""
    From: build
    Name: copy
    SourcesAndDest:
    - /go/bin/check_golang_dep
    - /usr/lib/nagios/plugins/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - icinga2/check_golang_dep.conf
    - _docker/icinga2-monobjs.conf
    - /etc/icinga2/conf.d/
  From:
    Image: grandmaster/check-plugins-demo
  Name: ""
  Platform: ""
  SourceCode: FROM grandmaster/check-plugins-demo
