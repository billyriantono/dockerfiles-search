MetaArgs: null
Stages:
- BaseName: centos:7
  Commands:
  - Maintainer: Otto Odgaard <oodgaard@ultraserve.com.au>
    Name: maintainer
  - Chown: ""
    Name: add
    SourcesAndDest:
    - nginx.repo
    - /etc/yum.repos.d/nginx.repo
  - CmdLine:
    - rpm -Uvh https://mirror.webtatic.com/yum/el7/epel-release.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh https://mirror.webtatic.com/yum/el7/webtatic-release.rpm
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - mongodb.repo
    - /etc/yum.repos.d/mongodb.repo
  - CmdLine:
    - yum -y update
    Name: run
    PrependShell: true
  - CmdLine:
    - yum -y install nginx
    Name: run
    PrependShell: true
  - CmdLine:
    - yum -y install php56w-opcache php56w-fpm php56w-pear php56w-pecl-memcache php56w-pgsql
      php56w-process php56w-soap php56w-xml
    Name: run
    PrependShell: true
  - CmdLine:
    - yum -y install libmongo-devel libyaml-devel php56w-devel mongodb-org-mongos
      php56w-pecl-xdebug
    Name: run
    PrependShell: true
  - CmdLine:
    - yum -y install gcc gcc-c++ automake make gmake openssl-devel
    Name: run
    PrependShell: true
  - CmdLine:
    - pecl channel-update pecl.php.net
    Name: run
    PrependShell: true
  - CmdLine:
    - printf "\r" | pecl install --force mongo
    Name: run
    PrependShell: true
  - CmdLine:
    - pecl install yaml
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - mongo.ini
    - /etc/php.d/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - yaml.ini
    - /etc/php.d/
  - CmdLine:
    - mkdir /var/lib/php/session
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod 1777 /var/lib/php/session
    Name: run
    PrependShell: true
  - CmdLine:
    - yum install -y python-setuptools && yum clean all
    Name: run
    PrependShell: true
  - CmdLine:
    - easy_install pip
    Name: run
    PrependShell: true
  - CmdLine:
    - pip install supervisor
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - nginx.conf
    - /etc/nginx/nginx.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - supervisord.conf
    - /etc/
  - Name: volume
    Volumes:
    - /var/www
    - /etc/php.ini
    - /etc/hosts
    - /etc/resolv.conf
  - CmdLine:
    - supervisord
    - -n
    Name: cmd
    PrependShell: false
  From:
    Image: centos:7
  Name: ""
  Platform: ""
  SourceCode: FROM centos:7
