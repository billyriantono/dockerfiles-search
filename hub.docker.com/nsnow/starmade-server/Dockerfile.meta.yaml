MetaArgs: null
Stages:
- BaseName: golang
  Commands:
  - Env:
    - Key: REMCO_VERSION
      Value: v0.11.0
    Name: env
  - CmdLine:
    - go get github.com/HeavyHorst/remco/cmd/remco
    Name: run
    PrependShell: true
  - CmdLine:
    - cd $GOPATH/src/github.com/HeavyHorst/remco &&   git checkout ${REMCO_VERSION}
    Name: run
    PrependShell: true
  - CmdLine:
    - go install github.com/HeavyHorst/remco/cmd/remco
    Name: run
    PrependShell: true
  From:
    Image: golang
  Name: ""
  Platform: ""
  SourceCode: FROM golang
- BaseName: ubuntu:bionic
  Commands:
  - Env:
    - Key: TINI_VERSION
      Value: v0.18.0
    Name: env
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - Env:
    - Key: LANG
      Value: C.UTF-8
    Name: env
  - Env:
    - Key: LC_ALL
      Value: C.UTF-8
    Name: env
  - CmdLine:
    - set -eux pipefail &&   sed -i -e 's#http://\(archive\|security\)#mirror://mirrors#'
      -e 's#/ubuntu/#/mirrors.txt#' /etc/apt/sources.list &&   apt-get -y update &&
      apt-get -y install     curl     gnupg2     sudo     openjdk-8-jdk-headless     wget     git
    Name: run
    PrependShell: true
  - CmdLine:
    - adduser --shell /bin/bash --home /home/starmade --gecos "" --disabled-password
      starmade &&   passwd -d starmade &&   addgroup starmade sudo
    Name: run
    PrependShell: true
  - CmdLine:
    - wget -O /tini https://github.com/krallin/tini/releases/download/${TINI_VERSION}/tini
      &&   wget -O /tini.asc https://github.com/krallin/tini/releases/download/${TINI_VERSION}/tini.asc
      &&   gpg --batch --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys
      595E85A6B1B4779EA4DAAEC70B588DFF0527A9B7 &&   gpg --batch --verify /tini.asc
      /tini &&   chmod +x /tini
    Name: run
    PrependShell: true
  - Chown: ""
    From: "0"
    Name: copy
    SourcesAndDest:
    - /go/bin/remco
    - /usr/local/bin/remco
  - Chown: starmade:root
    From: ""
    Name: copy
    SourcesAndDest:
    - remco
    - /etc/remco
  - CmdLine:
    - chmod -R 0775 etc/remco
    Name: run
    PrependShell: true
  - Name: user
    User: starmade
  - Name: workdir
    Path: /home/starmade
  - Name: volume
    Volumes:
    - /home/starmade/server
  - Chown: starmade:starmade
    From: ""
    Name: copy
    SourcesAndDest:
    - files/entrypoint.sh
    - ./
  - CmdLine:
    - chmod ug+x entrypoint.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - /tini
    - --
    - ./entrypoint.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: ubuntu:bionic
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:bionic
