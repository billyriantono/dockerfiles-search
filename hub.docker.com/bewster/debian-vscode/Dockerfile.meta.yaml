MetaArgs: null
Stages:
- BaseName: bewster/debian-vnc-desktop:jessie
  Commands:
  - Labels:
    - Key: com.gbelectronics.vendor
      Value: '"GB Electronics (UK) Ltd"'
    - Key: com.gbelectronics.version
      Value: '"0.2-DEV"'
    Name: label
  - CmdLine:
    - "apt-get update                                      && apt-get install -y                                         curl
      \                                                  apt-transport-https                                    libxss1
      \                                        \t\t    git                                             &&
      apt-get clean                                       && rm -rf /var/lib/apt/lists/*"
    Name: run
    PrependShell: true
  - CmdLine:
    - curl https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor > microsoft.gpg  &&
      mv microsoft.gpg /etc/apt/trusted.gpg.d/microsoft.gpg                                   &&
      sh -c 'echo "deb [arch=amd64] https://packages.microsoft.com/repos/vscode stable
      main" > /etc/apt/sources.list.d/vscode.list'  && apt-get update                                                                          &&
      apt-get install -y                                                                             code                                                                                &&
      apt-get install -f                                                                      &&
      apt-get clean                                                                           &&
      rm -rf /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - CmdLine:
    - cp /root/.vnc/xstartup /tmp                                                    &&
      cp /root/.xscreensaver /tmp
    Name: run
    PrependShell: true
  - Env:
    - Key: USER
      Value: vscode
    Name: env
  - CmdLine:
    - useradd -ms /bin/bash vscode
    Name: run
    PrependShell: true
  - Name: user
    User: vscode
  - Name: workdir
    Path: /home/vscode
  - CmdLine:
    - mkdir ~/.vnc                                                                     &&
      cp /tmp/xstartup ~/.vnc                                                          &&
      cp /tmp/.xscreensaver .
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir ~/lib                                                                      &&
      cp /usr/lib/x86_64-linux-gnu/libxcb.so.1 ~/lib                                   &&
      sed -i 's/BIG-REQUESTS/_IG-REQUESTS/' ~/lib/libxcb.so.1                          &&
      echo -n "alias vscode='LD_LIBRARY_PATH=$HOME/lib code'"'\n' >> ~/.bash_aliases
    Name: run
    PrependShell: true
  From:
    Image: bewster/debian-vnc-desktop:jessie
  Name: ""
  Platform: ""
  SourceCode: FROM bewster/debian-vnc-desktop:jessie
