MetaArgs: null
Stages:
- BaseName: jameshclrk/parmetis:latest
  Commands:
  - Maintainer: James Clark <james.clark@stfc.ac.uk>
    Name: maintainer
  - Key: PETSC_VERSION
    Name: arg
    Value: 3.7.6
  - Key: PETSC_INSTALL_PATH
    Name: arg
    Value: /opt/petsc
  - CmdLine:
    - set -x     && apt-get update     && apt-get install -y bison flex
    Name: run
    PrependShell: true
  - CmdLine:
    - "set -x     && curl -fSL \"http://ftp.mcs.anl.gov/pub/petsc/release-snapshots/petsc-lite-${PETSC_VERSION}.tar.gz\"
      -o petsc.tar.gz \t&& mkdir -p /usr/src/petsc \t&& tar -xf petsc.tar.gz -C /usr/src/petsc
      --strip-components=1 \t&& rm petsc.tar.gz* \t&& cd /usr/src/petsc \t&& ./configure
      \        --with-debugging=0         --with-shared-libraries=1         --with-metis
      \        --with-metis-include=\"${PARMETIS_DIR}/include\"         --with-metis-lib=[-L${PARMETIS_DIR}/lib,-lmetis]
      \        --with-parmetis         --with-parmetis-include=\"${PARMETIS_DIR}/include\"
      \        --with-parmetis-lib=[-L${PARMETIS_DIR}/lib,-lparmetis]         --download-triangle
      \        --download-ctetgen         --download-chaco         --download-exodusii
      \        --download-netcdf         --download-hdf5         --download-ptscotch
      \        --download-fblaslapack         --prefix=${PETSC_INSTALL_PATH}         PETSC_ARCH=linux-gnu-c-shared
      \t&& make all \t&& make test     && make install \t&& make PETSC_DIR=\"${PETSC_INSTALL_PATH}\"
      PETSC_ARCH=\"\" test     && rm -rf /usr/src/petsc"
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: '"${PETSC_INSTALL_PATH}/bin:${PATH}"'
    - Key: LD_LIBRARY_PATH
      Value: '"${PETSC_INSTALL_PATH}/lib:${LD_LIBRARY_PATH}"'
    - Key: PETSC_DIR
      Value: '"${PETSC_INSTALL_PATH}"'
    Name: env
  From:
    Image: jameshclrk/parmetis:latest
  Name: ""
  Platform: ""
  SourceCode: FROM jameshclrk/parmetis:latest
