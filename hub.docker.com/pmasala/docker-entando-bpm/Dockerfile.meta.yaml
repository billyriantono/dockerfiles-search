MetaArgs: null
Stages:
- BaseName: centos:7
  Commands:
  - Maintainer: p.masala@entando.com
    Name: maintainer
  - Name: user
    User: root
  - CmdLine:
    - useradd -ms /bin/bash entando
    Name: run
    PrependShell: true
  - Env:
    - Key: JAVA_HOME
      Value: /opt/jdk1.8.0_141
    Name: env
  - Env:
    - Key: JRE_HOME
      Value: /opt/jdk1.8.0_141/jre
    Name: env
  - Env:
    - Key: MAVEN_HOME
      Value: /usr/share/maven
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - entando-components-enterprise/
    - /home/entando/entando-components-enterprise/
  - CmdLine:
    - 'chown -R entando:entando /home/entando/entando-components-enterprise && chmod
      0775 -R /home/entando/entando-components-enterprise && yum install -y curl git
      maven imagemagick wget && cd /opt && wget --no-cookies --no-check-certificate
      --header "Cookie: gpw_e24=http%3A%2F%2Fwww.oracle.com%2F; oraclelicense=accept-securebackup-cookie"
      "http://download.oracle.com/otn-pub/java/jdk/8u141-b15/336fa29ff2bb4ef291e347e091f7f4a7/jdk-8u141-linux-x64.tar.gz"
      && tar xzf jdk-8u141-linux-x64.tar.gz && rm -f jdk-8u141-linux-x64.tar.gz &&
      rm -f /usr/bin/java /usr/bin/jar /usr/bin/javac && cd jdk1.8.0_141/ && ln -s
      /opt/jdk1.8.0_141/bin/java /usr/bin/java && ln -s /opt/jdk1.8.0_141/bin/jar
      /usr/bin/jar && ln -s /opt/jdk1.8.0_141/bin/javac /usr/bin/javac && yum clean
      all -y'
    Name: run
    PrependShell: true
  - Name: user
    User: entando
  - CmdLine:
    - cd /home/entando && git clone https://github.com/entando/entando-core.git &&
      git clone https://github.com/entando/entando-components.git && git clone https://github.com/entando/entando-archetypes.git
      && cd /home/entando/entando-core && mvn clean install -DskipTests && cd .. &&
      rm -rf entando-core/ && cd entando-components && mvn clean install -DskipTests
      && cd ..  && rm -rf entando-components/ && cd entando-archetypes && mvn clean
      install -DskipTests && cp /home/entando/.m2/archetype-catalog.xml /home/entando/.m2/repository
      && cd .. && rm -rf entando-archetypes && cd entando-components-enterprise &&
      mvn clean install -DskipTests && cd .. && rm -rf entando-components-enterprise/
      && mvn archetype:generate -B -Dfilter=entando -DarchetypeGroupId=org.entando.entando
      -DarchetypeArtifactId=entando-archetype-web-app-BPM -DgroupId=org.entando -DartifactId=inspinia-bpm
      -Dversion=1.0-SNAPSHOT -Dpackage=org.entando
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /home/entando/inspinia-bpm
  - CmdLine:
    - mvn
    - clean
    - install
    - -DskipTests
    - jetty:run
    Name: cmd
    PrependShell: false
  - Name: expose
    Ports:
    - "8080"
  From:
    Image: centos:7
  Name: ""
  Platform: ""
  SourceCode: FROM centos:7
