MetaArgs: null
Stages:
- BaseName: debian:8.8
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"Pierre GUINAULT <speed@infinity.ovh>, Alexis Pereda <alexis@pereda.fr>"'
    Name: label
  - Labels:
    - Key: version
      Value: '"0.3"'
    Name: label
  - CmdLine:
    - "apt-get update &&   LC_ALL=C DEBIAN_FRONTEND=noninteractive apt-get install
      -y \tca-certificates \tdovecot-imapd \tdovecot-ldap \tldap-utils \tlibodbc1
      \tlibsasl2-modules-ldap \tlibslp1 \tlibwrap0 \topendkim \topendkim-tools \tpostfix
      \tpostfix-ldap \trsyslog \tsasl2-bin \tsupervisor \t&& rm -rf /var/lib/apt/lists/*"
    Name: run
    PrependShell: true
  - CmdLine:
    - groupadd -g 2000 vmail && useradd -u 2000 -g 2000 -d /vmail -s /bin/false -m
      vmail
    Name: run
    PrependShell: true
  - Env:
    - Key: TZ
      Value: Etc/UTC
    Name: env
  - Env:
    - Key: LDAP_ADMIN_PASSWORD
      Value: password
    Name: env
  - Env:
    - Key: LDAP_DOMAIN_BASE
      Value: example.com
    Name: env
  - Env:
    - Key: LDAP_USE_TLS
      Value: "1"
    Name: env
  - Env:
    - Key: SSL_SMTP_CERT
      Value: smtp.cert
    Name: env
  - Env:
    - Key: SSL_SMTP_KEY
      Value: smtp.key
    Name: env
  - Env:
    - Key: SSL_IMAP_CERT
      Value: imap.cert
    Name: env
  - Env:
    - Key: SSL_IMAP_KEY
      Value: imap.key
    Name: env
  - Env:
    - Key: MAIL_DOMAIN
      Value: exemple.com
    Name: env
  - Env:
    - Key: DKIM_KEY_SIZE
      Value: "2048"
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./files
    - /
  - CmdLine:
    - LC_CTYPE=C.UTF-8
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "25"
  - Name: expose
    Ports:
    - "587"
  - Name: expose
    Ports:
    - "993"
  - Name: volume
    Volumes:
    - /vmail
  - Name: volume
    Volumes:
    - /ssl
  - CmdLine:
    - /usr/bin/supervisord
    - -c/etc/supervisord.conf
    Name: cmd
    PrependShell: false
  From:
    Image: debian:8.8
  Name: ""
  Platform: ""
  SourceCode: FROM debian:8.8
