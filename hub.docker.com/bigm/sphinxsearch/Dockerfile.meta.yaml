MetaArgs: null
Stages:
- BaseName: bigm/base-deb-tools
  Commands:
  - CmdLine:
    - /xt/tools/_ppa_install ppa:builds/sphinxsearch-rel22 sphinxsearch
    Name: run
    PrependShell: true
  - CmdLine:
    - export SPH_API_KEY=REPLKEY   && bash -c "$(curl -s https://tools.sphinxsearch.com/downloads/latest/install-monitor)"
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - sphinxagent.json
    - /usr/local/sphinxmonitor/conf/sphinxagent.json
  - CmdLine:
    - rm -fr /tmp/*
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - etc/sphinxsearch
    - /etc/sphinxsearch
  - CmdLine:
    - rm -f /etc/sphinxsearch/sphinx.conf
    Name: run
    PrependShell: true
  - Env:
    - Key: SPHINXSEARCH_CONFIG_MAIN
      Value: '"/etc/sphinxsearch/main.conf"'
    Name: env
  - Env:
    - Key: SPHINXSEARCH_CONFIG_D
      Value: '"/etc/sphinxsearch/conf.d"'
    Name: env
  - Env:
    - Key: SPH_API_KEY
      Value: '""'
    Name: env
  - Env:
    - Key: SPHINXSEARCH_STARTUP_INDEXER
      Value: '"--rotate --all"'
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - startup/*
    - /prj/startup/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - supervisor/*
    - /etc/supervisord.d/
  - Name: expose
    Ports:
    - "9306"
    - "9312"
  - Name: volume
    Volumes:
    - /var/lib/sphinxsearch
  From:
    Image: bigm/base-deb-tools
  Name: ""
  Platform: ""
  SourceCode: FROM bigm/base-deb-tools
