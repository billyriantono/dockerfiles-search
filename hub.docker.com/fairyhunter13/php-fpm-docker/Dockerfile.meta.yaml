MetaArgs: null
Stages:
- BaseName: php:7.2-fpm
  Commands:
  - Env:
    - Key: TIMEZONE
      Value: Asia/Jakarta
    Name: env
  - Env:
    - Key: PHP_MEMORY_LIMIT
      Value: 512M
    Name: env
  - Env:
    - Key: MAX_UPLOAD
      Value: 50M
    Name: env
  - Env:
    - Key: PHP_MAX_FILE_UPLOAD
      Value: "200"
    Name: env
  - Env:
    - Key: PHP_MAX_POST
      Value: 100M
    Name: env
  - CmdLine:
    - apt-get update;     apt-get install vim --no-install-recommends -y;     sed
      -i "s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/g" $PHP_INI_DIR/php.ini-production
      ;     sed -i "s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/g" $PHP_INI_DIR/php.ini-development
      ;     sed -i "s|;*date.timezone =.*|date.timezone = ${TIMEZONE}|i" $PHP_INI_DIR/php.ini-development;     sed
      -i "s|;*date.timezone =.*|date.timezone = ${TIMEZONE}|i" $PHP_INI_DIR/php.ini-production;     sed
      -i "s|;*memory_limit =.*|memory_limit = ${PHP_MEMORY_LIMIT}|i" $PHP_INI_DIR/php.ini-development                              ;     sed
      -i "s|;*memory_limit =.*|memory_limit = ${PHP_MEMORY_LIMIT}|i" $PHP_INI_DIR/php.ini-production                              ;     sed
      -i "s|;*upload_max_filesize =.*|upload_max_filesize = ${MAX_UPLOAD}|i" $PHP_INI_DIR/php.ini-development                      ;     sed
      -i "s|;*upload_max_filesize =.*|upload_max_filesize = ${MAX_UPLOAD}|i" $PHP_INI_DIR/php.ini-production                       ;     sed
      -i "s|;*max_file_uploads =.*|max_file_uploads = ${PHP_MAX_FILE_UPLOAD}|i" $PHP_INI_DIR/php.ini-development                    ;     sed
      -i "s|;*max_file_uploads =.*|max_file_uploads = ${PHP_MAX_FILE_UPLOAD}|i" $PHP_INI_DIR/php.ini-production                    ;     docker-php-ext-install
      pdo pdo_mysql mysqli;
    Name: run
    PrependShell: true
  - CmdLine:
    - usermod -u 1000 www-data;
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /app
  - CmdLine:
    - php-fpm
    Name: cmd
    PrependShell: false
  From:
    Image: php:7.2-fpm
  Name: ""
  Platform: ""
  SourceCode: FROM php:7.2-fpm
