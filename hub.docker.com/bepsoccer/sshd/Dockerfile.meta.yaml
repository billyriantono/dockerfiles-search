MetaArgs: null
Stages:
- BaseName: alpine:latest
  Commands:
  - CmdLine:
    - apk add --update openssh && rm -rf /var/cache/apk/*
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /var/run/sshd && mkdir /var/sftp && mkdir /var/sftp/uploads && mkdir /var/sshKeys
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod 777 /var/sftp/uploads
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - /sshStuff/.
    - /etc/ssh/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - /sshKeys/.
    - /var/sshKeys/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - /sshKeys/ssh_host_rsa_key
    - /var/sshKeys/ssh_host_rsa_key_readable
  - CmdLine:
    - chmod 600 /var/sshKeys/ssh_host_rsa_key
    Name: run
    PrependShell: true
  - CmdLine:
    - adduser -D -h /var/sftp/uploads sshuser
    Name: run
    PrependShell: true
  - CmdLine:
    - echo 'sshuser:P@$$w0rd' | chpasswd
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "22"
  - CmdLine:
    - /usr/sbin/sshd
    - -D
    - -e
    Name: cmd
    PrependShell: false
  From:
    Image: alpine:latest
  Name: ""
  Platform: ""
  SourceCode: FROM alpine:latest
