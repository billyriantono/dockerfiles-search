MetaArgs: null
Stages:
- BaseName: ubuntu:16.10
  Commands:
  - Maintainer: Borja Maceira <ant@antweb.es>
    Name: maintainer
  - Env:
    - Key: REFRESHED_AT
      Value: "2016-09-22"
    Name: env
  - Env:
    - Key: VERSION
      Value: 0.0.1
    Name: env
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - Env:
    - Key: INSPIRCD_SRC_VERSION
      Value: 2.0.23
    Name: env
  - CmdLine:
    - apt-get update && apt-get install -y -o Dpkg::Options::="--force-confdef"     pkg-config     build-essential     gnutls-bin     libgnutls28-dev     openssl     libssl-dev     libssl1.0.0     curl     unzip     libpcre3     libpcre3-dev     libmysqlclient-dev     libgeoip-dev     --no-install-recommends
      && rm -r /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -s --location https://github.com/inspircd/inspircd/archive/v$INSPIRCD_SRC_VERSION.tar.gz
      --insecure | tar xz
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /src/ &&     mv inspircd-$INSPIRCD_SRC_VERSION /src/ &&     useradd -u
      10000 -d /inspircd/ inspircd &&     cd /src/inspircd-$INSPIRCD_SRC_VERSION/
      &&     ./configure --enable-extras m_mysql.cpp &&     ./configure --enable-extras
      m_regex_pcre.cpp  &&     ./configure --enable-extras m_regex_posix.cpp &&     ./configure
      --enable-extras m_regex_stdlib.cpp  &&     ./configure --enable-extras m_ssl_gnutls.cpp
      &&     ./configure --enable-extras m_ssl_openssl.cpp &&     ./configure --enable-extras
      m_geoip.cpp  &&     ./configure --disable-interactive --prefix=/inspircd --uid
      10000 --enable-gnutls --enable-epoll &&     make  && make install
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - conf/inspircd.conf
    - /inspircd/conf/inspircd.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - conf/inspircd.motd
    - /inspircd/conf/inspircd.motd
  - Chown: ""
    Name: add
    SourcesAndDest:
    - conf/inspircd.rules
    - /inspircd/conf/inspircd.rules
  - Chown: ""
    Name: add
    SourcesAndDest:
    - conf/links.conf
    - /inspircd/conf/links.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - conf/modules.conf
    - /inspircd/conf/modules.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - conf/opers.conf
    - /inspircd/conf/opers.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - conf/permchannels.conf
    - /inspircd/conf/permchannels.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - conf/limits.conf
    - /etc/security/limits.d/inspircd.conf
  - Name: volume
    Volumes:
    - /inspircd/logs
    - /inspircd/conf
    - /inspircd/modules
  - Name: expose
    Ports:
    - "6667"
  - CmdLine:
    - /inspircd/bin/inspircd
    - --nofork
    - --runasroot
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - ""
    Name: cmd
    PrependShell: false
  From:
    Image: ubuntu:16.10
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:16.10
