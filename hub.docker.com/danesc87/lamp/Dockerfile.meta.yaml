MetaArgs: null
Stages:
- BaseName: debian:9-slim
  Commands:
  - Maintainer: Daniel CÃ³rdova A. <danesc87@gmail.com>
    Name: maintainer
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get upgrade -y
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y gnupg2 curl
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -sL https://deb.nodesource.com/setup_8.x | bash -
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add -
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "deb https://dl.yarnpkg.com/debian/ stable main" | tee /etc/apt/sources.list.d/yarn.list
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y apache2 mariadb-server libapache2-mod-php php-mysql php-gd
      php-apcu php-mcrypt php-xml php-json php-mail php-mail-mime php-mailparse php-ssh2
      php-zip php-bz2 php-mbstring php-twig
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y nodejs yarn
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i 's/bind-address/#bind-address/' /etc/mysql/mariadb.conf.d/50-server.cnf
    Name: run
    PrependShell: true
  - CmdLine:
    - service mysql start; mysql -u root -e "CREATE USER 'admin'@'%' IDENTIFIED BY
      '1234abcd';"; mysql -u root -e "GRANT ALL PRIVILEGES ON *.* TO 'admin'@'%' WITH
      GRANT OPTION;";
    Name: run
    PrependShell: true
  - CmdLine:
    - a2enmod rewrite expires mime deflate headers
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - index.php
    - /var/www/html/index.php
  - CmdLine:
    - curl -sS https://getcomposer.org/installer | php
    Name: run
    PrependShell: true
  - CmdLine:
    - mv composer.phar /usr/local/bin/composer
    Name: run
    PrependShell: true
  - CmdLine:
    - adduser --disabled-password --gecos '' lamp
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - match_id.sh
    - /opt
  - CmdLine:
    - chmod 755 /opt/match_id.sh
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - startServices.sh
    - /opt
  - CmdLine:
    - chmod 755 /opt/startServices.sh
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "80"
  - Name: expose
    Ports:
    - "3306"
  - Name: expose
    Ports:
    - "8000"
  - Name: expose
    Ports:
    - "3000"
  - Name: workdir
    Path: /home/lamp
  - CmdLine:
    - /opt/startServices.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: debian:9-slim
  Name: ""
  Platform: ""
  SourceCode: FROM debian:9-slim
