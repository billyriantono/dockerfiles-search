MetaArgs: null
Stages:
- BaseName: schneidermatic/java
  Commands:
  - Maintainer: schneidermatic
    Name: maintainer
  - Name: workdir
    Path: /tmp
  - Env:
    - Key: OPENNMS_HOME
      Value: /opt/opennms
    Name: env
  - Env:
    - Key: OPENNMS_VERSION
      Value: 18.0.3-1
    Name: env
  - Env:
    - Key: DB_HOST
      Value: '"pgdb1"'
    Name: env
  - Env:
    - Key: DB_PORT
      Value: '"5432"'
    Name: env
  - Env:
    - Key: DB_PASSWORD
      Value: '""'
    Name: env
  - CmdLine:
    - yum -y upgrade
    Name: run
    PrependShell: true
  - CmdLine:
    - yum clean all
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm --import http://yum.opennms.org/OPENNMS-GPG-KEY
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/rhel7/jicmp/jicmp-1.4.6-1.x86_64.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/rhel7/jicmp6/jicmp6-1.2.4-1.x86_64.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-core-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-webapp-jetty-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-plugin-provisioning-snmp-asset-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-jmx-config-generator-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-plugin-northbounder-jms-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-plugin-protocol-cifs-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-plugin-protocol-dhcp-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-plugin-protocol-xml-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-plugin-protocol-nsclient-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-plugin-provisioning-snmp-hardware-inventory-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-plugin-ticketer-jira-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - rpm -Uvh http://yum.opennms.org/stable/common/opennms/opennms-plugin-ticketer-otrs-${OPENNMS_VERSION}.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - touch /opt/opennms/etc/install_onmsdb
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /opt/docker/config
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - src/config
    - /opt/docker/config
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - src/config/supervisord.conf
    - /etc/supervisord.conf
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - src/scripts/bootstrap.sh
    - /opt/docker/scripts/bootstrap.sh
  - CmdLine:
    - chmod 775 /opt/docker/scripts/bootstrap.sh
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - src/scripts/opennmsw.sh
    - /opt/docker/scripts/opennmsw.sh
  - CmdLine:
    - chmod 775 /opt/docker/scripts/opennmsw.sh
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - src/config/opennms-datasources.xml
    - /opt/opennms/etc/opennms-datasources.xml
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - src/config/logstash.xml
    - /opt/opennms/etc/imports/pending/logstash.xml
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - src/config/logstash.xml
    - /opt/opennms/etc/imports/logstash.xml
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - src/config/eventd-configuration.xml
    - /opt/opennms/etc/eventd-configuration.xml
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - src/config/eventconf.xml
    - /opt/opennms/etc/eventconf.xml
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - src/config/enterprise.logstash.generic.events.xml
    - /opt/opennms/etc/events/enterprise.logstash.generic.events.xml
  - CmdLine:
    - chmod -R 775 /opt/opennms/etc
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /var/log/opennms
    - /var/opennnms
  - Name: expose
    Ports:
    - "1099"
    - 161/udp
    - 162/udp
    - "18980"
    - "5432"
    - "5817"
    - "61616"
    - "8101"
    - "8443"
    - "8980"
  From:
    Image: schneidermatic/java
  Name: ""
  Platform: ""
  SourceCode: FROM schneidermatic/java
