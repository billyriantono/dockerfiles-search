MetaArgs: null
Stages:
- BaseName: alpine:3.3
  Commands:
  - Env:
    - Key: FIREFOX_VERSION
      Value: '"38.3.0"'
    - Key: FIREFOX_ADDONS_URL
      Value: '"https://addons.mozilla.org/firefox/downloads/latest"'
    - Key: EXT_UID
      Value: '"207605"'
    Name: env
  - Name: workdir
    Path: /scratch
  - CmdLine:
    - apk add --update bash curl dbus-x11 libcanberra-gtk2 firefox=${FIREFOX_VERSION}-r1
      &&     apk add xdotool --update-cache --repository http://dl-3.alpinelinux.org/alpine/edge/testing/
      --allow-untrusted &&     export TTFS=$(apk search -q ttf- | grep -v '\-doc')
      &&     export FONTS=$(apk search -q font- | grep -v '\-doc') &&     apk add
      ${TTFS} ${FONTS} &&     rm -rf /var/cache/apk/*
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -LO $FIREFOX_ADDONS_URL/$EXT_UID/addon-${EXT_UID}-latest.xpi &&     unzip
      addon-${EXT_UID}-latest.xpi &&     rm addon-${EXT_UID}-latest.xpi &&     export
      EXT_ID=$(cat install.rdf | grep "<em:id>" | head -n 1 | sed 's/^.*>\(.*\)<.*$/\1/g')
      &&     export EXT_DIR="/usr/lib/firefox-${FIREFOX_VERSION}/browser/extensions/${EXT_ID}"
      &&     export EXT_PATH="Extension0=${EXT_DIR}^M" &&     mkdir ${EXT_DIR} &&
      mv * ${EXT_DIR}
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - assets/prefs.js
    - /usr/lib/firefox-38.3.0/browser/extensions/tabrotator@davidfichtmueller.de/defaults/preferences/prefs.js
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - assets/mozilla/firefox
    - /root/.mozilla/firefox/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - assets/urls.txt
    - /assets/urls.txt
  - CmdLine:
    - exec firefox $(cat /assets/urls.txt)
    Name: entrypoint
    PrependShell: true
  From:
    Image: alpine:3.3
  Name: ""
  Platform: ""
  SourceCode: FROM alpine:3.3
