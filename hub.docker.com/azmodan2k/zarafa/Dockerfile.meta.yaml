MetaArgs: null
Stages:
- BaseName: azmodan2k/zarafabase:latest
  Commands:
  - Maintainer: azmodan2k "work@azmodan.com"
    Name: maintainer
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - Env:
    - Key: LB_ROOT_PASSWORD
      Value: topSecret
    Name: env
  - Env:
    - Key: LB_LDAP_PASSWORD
      Value: topSecret
    Name: env
  - Env:
    - Key: LB_MYSQL_PASSWORD
      Value: topSecret
    Name: env
  - Env:
    - Key: LB_LDAP_DN
      Value: dc=mydomain,dc=net
    Name: env
  - Env:
    - Key: LB_MAILDOMAIN
      Value: mydomain.net
    Name: env
  - Env:
    - Key: LB_RELAYHOST
      Value: smtp.relayhost.com
    Name: env
  - Env:
    - Key: LB_RELAYHOST_USERNAME
      Value: FooMyAuthUser
    Name: env
  - Env:
    - Key: LB_RELAYHOST_PASSWORD
      Value: BarAuthPassword
    Name: env
  - Env:
    - Key: LB_SSL_COMPANY
      Value: My Company Ltd.
    Name: env
  - Env:
    - Key: LB_SSL_COUNTRY
      Value: US
    Name: env
  - Env:
    - Key: LB_SSL_LOCATION
      Value: Springflied
    Name: env
  - CmdLine:
    - DEBIAN_FRONTEND=noninteractive apt-get -q update && apt-get -yqq install rsyslog
      curl ssh fetchmail postfix postfix-ldap amavisd-new clamav-daemon spamassassin
      razor pyzor slapd ldap-utils phpldapadmin php5-cli php-soap arj bzip2 cabextract
      cpio file gzip lhasa nomarch pax unrar-free ripole unzip zip zoo rpm2cpio lzop
      xzdec lzma sasl2-bin
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/amavis/15-content_filter_mode
    - /etc/amavis/conf.d/15-content_filter_mode
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/amavis/20-debian_defaults
    - /etc/amavis/conf.d/20-debian_defaults
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/postfix/ldap-aliases.cf
    - /etc/postfix/ldap-aliases.cf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/postfix/ldap-users.cf
    - /etc/postfix/ldap-users.cf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/postfix/main.cf
    - /etc/postfix/main.cf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/postfix/master.cf
    - /etc/postfix/master.cf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/postfix/sasl/smtpd.conf
    - /etc/postfix/sasl/smtpd.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/saslauthd/default/saslauthd
    - /etc/default/saslauthd
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/saslauthd/saslauthd.conf
    - /etc/saslauthd.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/ldap/ldap.ldif
    - /usr/local/bin/ldap.ldif
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/ldap/fetchmail.ldif
    - /etc/ldap/schema/fetchmail.ldif
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/ldap/fetchmail.schema
    - /etc/ldap/schema/fetchmail.schema
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/apache/z-push.conf
    - /etc/apache2/sites-available/z-push.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/apache/default-ssl.conf
    - /etc/apache2/sites-available/default-ssl.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /config/apache/000-default.conf
    - /etc/apache2/sites-available/000-default.conf
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /script/init.sh
    - /usr/local/bin/init.sh
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /script/fetchmail.sh
    - /usr/local/bin/fetchmail.sh
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /script/ssl-cert.sh
    - /usr/local/bin/ssl-cert.sh
  - CmdLine:
    - chmod 777 /usr/local/bin/init.sh /usr/local/bin/ssl-cert.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "yes" > /usr/local/bin/firstrun
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - /script/entry.sh
    - /usr/local/bin/entry.sh
  - CmdLine:
    - /usr/local/bin/entry.sh
    Name: cmd
    PrependShell: false
  - Name: expose
    Ports:
    - "236"
  - Name: expose
    Ports:
    - "237"
  - Name: expose
    Ports:
    - "22"
  - Name: expose
    Ports:
    - "80"
  - Name: expose
    Ports:
    - "443"
  - Name: expose
    Ports:
    - "389"
  - CmdLine:
    - /bin/bash
    Name: entrypoint
    PrependShell: false
  From:
    Image: azmodan2k/zarafabase:latest
  Name: ""
  Platform: ""
  SourceCode: FROM azmodan2k/zarafabase:latest
