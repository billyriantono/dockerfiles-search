MetaArgs: null
Stages:
- BaseName: bitnami/minideb:jessie
  Commands:
  - Env:
    - Key: TIMEZONE
      Value: Etc/UTC
    Name: env
  - CmdLine:
    - ln -snf /usr/share/zoneinfo/$TIMEZONE /etc/localtime && echo $TIMEZONE > /etc/timezone
    Name: run
    PrependShell: true
  - CmdLine:
    - install_packages   curl   apt-transport-https   lsb-release   ca-certificates
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -o /etc/apt/trusted.gpg.d/php.gpg https://packages.sury.org/php/apt.gpg
      &&     echo "deb https://packages.sury.org/php/ $(lsb_release -sc) main" > /etc/apt/sources.list.d/php.list
    Name: run
    PrependShell: true
  - CmdLine:
    - install_packages     php7.1-fpm     php7.1-cli     php7.1-xml     php7.1-curl     php7.1-intl     php7.1-mysql     php7.1-mcrypt     php7.1-mbstring     php7.1-redis     php7.1-bcmath     php7.1-imagick     php7.1-gd     php7.1-zip
    Name: run
    PrependShell: true
  - CmdLine:
    - install_packages     git     zip     unzip
    Name: run
    PrependShell: true
  - CmdLine:
    - rm -f /etc/php/7.1/fpm/pool.d/www.conf
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /run/php
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i "/pid = .*/c\;pid = /run/php/php7.1-fpm.pid" /etc/php/7.1/fpm/php-fpm.conf     &&
      sed -i "/;daemonize = .*/c\daemonize = no" /etc/php/7.1/fpm/php-fpm.conf     &&
      sed -i "/error_log = .*/c\error_log = /proc/self/fd/2" /etc/php/7.1/fpm/php-fpm.conf     &&
      usermod -u 1000 www-data
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /var/www
    Name: run
    PrependShell: true
  - CmdLine:
    - chown -R www-data:1000 /var/www
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -sf /dev/stderr /var/log/www.log.slow
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - symfony.pool.conf
    - /etc/php/7.1/fpm/pool.d/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - sfconsole
    - /usr/bin/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - composer
    - /usr/bin/
  - CmdLine:
    - /usr/sbin/php-fpm7.1
    Name: cmd
    PrependShell: false
  - CmdLine:
    - chown -R www-data. /var/www/
    Name: run
    PrependShell: true
  - Name: user
    User: www-data
  - CmdLine:
    - mkdir /var/www/.composer
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /var/www/symfony
  - Name: expose
    Ports:
    - "8000"
  - Name: expose
    Ports:
    - "9000"
  From:
    Image: bitnami/minideb:jessie
  Name: ""
  Platform: ""
  SourceCode: FROM bitnami/minideb:jessie
