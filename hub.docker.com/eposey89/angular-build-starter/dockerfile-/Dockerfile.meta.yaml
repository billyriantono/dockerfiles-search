MetaArgs: null
Stages:
- BaseName: debian:stretch
  Commands:
  - CmdLine:
    - apt-get -y update && apt-get install -y --no-install-recommends     apt-transport-https     bash-completion     curl     composer     git     gnupg     htop     less     lsb-release     make     mysql-client     openssh-server     tree     python3     python3-pip     python3-virtualenv     python3-setuptools     virtualenv     screen     software-properties-common     unzip     vim   &&     apt-get
      -y autoremove &&     apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -sL https://deb.nodesource.com/setup_10.x | bash -
    Name: run
    PrependShell: true
  - CmdLine:
    - curl https://packages.sury.org/php/apt.gpg > /etc/apt/trusted.gpg.d/php.gpg
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "deb https://packages.sury.org/php/ $(lsb_release -sc) main" > /etc/apt/sources.list.d/php.list
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get -y update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get -y install nodejs     php7.1     php7.1-gd     php7.1-cli     php7.1-curl     php7.1-ldap     php7.1-mysql     php7.1-xml     php7.1-zip   &&     apt-get
      -y autoremove &&     apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /var/run/sshd &&     sed -ri 's/UsePAM yes/UsePAM no/g' /etc/ssh/sshd_config
      &&     sed -ri 's/AcceptEnv LANG LC_\*/AcceptEnv LANG LC_\* WP_ENV/g' /etc/ssh/sshd_config
      &&     sed -ri 's/#UsePrivilegeSeparation sandbox/UsePrivilegeSeparation no/g'  /etc/ssh/sshd_config
      &&     sed -ri 's/#?PermitRootLogin\s+.*/PermitRootLogin yes/g' /etc/ssh/sshd_config
      &&     mkdir /tmp/openshift &&     cd /tmp/openshift &&     curl -L -O https://github.com/openshift/origin/releases/download/v3.6.1/openshift-origin-client-tools-v3.6.1-008f2d5-linux-64bit.tar.gz
      &&     tar -xf openshift-origin-client-tools-v3.6.1-008f2d5-linux-64bit.tar.gz
      &&     mv */oc /usr/local/bin &&     cd / &&     rm -rf /tmp/openshift &&     mkdir
      /root/.ssh
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./bash_profile
    - /var/www/.bash_profile
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./docker-entrypoint.sh
    - /
  - CmdLine:
    - 'sed -ir ''s#www-data.*:/usr/sbin/nologin#www-data:x:33:33:www-data:/var/www:/bin/bash#''
      /etc/passwd &&     mkdir -p /var/www/.ssh &&     chown -R www-data: /var/www
      &&     chmod 700 /var/www/.ssh'
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./wp-packages/wp-cli-1.4.1.phar
    - /usr/local/bin/wp
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./wp-packages/polylang-cli-master.zip
    - /tmp/polylang-cli-master.zip
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./wp-packages/wp-cli-polylang-master.zip
    - /tmp/wp-cli-polylang-master.zip
  - CmdLine:
    - chmod a+x /usr/local/bin/wp &&     su www-data -c "/usr/local/bin/wp package
      install /tmp/polylang-cli-master.zip" &&     su www-data -c "/usr/local/bin/wp
      package install /tmp/wp-cli-polylang-master.zip"
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./config.yml
    - /var/www/.wp-cli/config.yml
  - Name: expose
    Ports:
    - "22"
  - CmdLine:
    - /docker-entrypoint.sh
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - /usr/sbin/sshd
    - -D
    Name: cmd
    PrependShell: false
  From:
    Image: debian:stretch
  Name: ""
  Platform: ""
  SourceCode: FROM debian:stretch
