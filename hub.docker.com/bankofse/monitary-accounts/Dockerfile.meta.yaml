MetaArgs: null
Stages:
- BaseName: postgres
  Commands:
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y libgmp3-dev gcc net-tools curl build-essential wget
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install curl
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -sL https://deb.nodesource.com/setup | bash -
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y nodejs
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - https://www.haskell.org/platform/download/2014.2.0.0/haskell-platform-2014.2.0.0-unknown-linux-x86_64.tar.gz
    - /
  - CmdLine:
    - tar vxf haskell-platform-2014.2.0.0-unknown-linux-x86_64.tar.gz
    Name: run
    PrependShell: true
  - CmdLine:
    - /usr/local/haskell/ghc-7.8.3-x86_64/bin/activate-hs
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./misc/postgrest-0.2.7.0.tar.xz
    - /postgrest
  - CmdLine:
    - mv /postgrest/postgrest-0.2.7.0 /usr/local/bin/postgrest
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod +x /usr/local/bin/postgrest
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "3000"
  - CmdLine:
    - mkdir -p /etc/listener/
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./jobs/package.json
    - /etc/listener/package.json
  - CmdLine:
    - cd /etc/listener && npm install
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./jobs/index.js
    - /etc/listener/index.js
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./schema.sql
    - /tmp/schema.sql
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./start_postgrest.sh
    - /docker-entrypoint-initdb.d/start_postgrest.sh
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./setup_db.sh
    - /docker-entrypoint-initdb.d/setup_db.sh
  From:
    Image: postgres
  Name: ""
  Platform: ""
  SourceCode: FROM postgres
