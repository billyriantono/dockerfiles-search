{
  "MetaArgs": null,
  "Stages": [
    {
      "Name": "",
      "BaseName": "samloh84/centos:7",
      "SourceCode": "FROM samloh84/centos:7",
      "Platform": "",
      "From": {
        "Image": "samloh84/centos:7"
      },
      "Commands": [
        {
          "Key": "PRODUCT",
          "Name": "arg",
          "Value": "php"
        },
        {
          "Key": "PRODUCT_VERSION",
          "Name": "arg",
          "Value": "2.4.1"
        },
        {
          "Key": "TEMP_DIR_ROOT",
          "Name": "arg",
          "Value": "/tmp/${PRODUCT}"
        },
        {
          "Key": "TEMP_DIR",
          "Name": "arg",
          "Value": "/${TEMP_DIR_ROOT}/${PRODUCT_VERSION}"
        },
        {
          "Key": "INSTALL_DIR_ROOT",
          "Name": "arg",
          "Value": "/opt/${PRODUCT}"
        },
        {
          "Key": "INSTALL_DIR",
          "Name": "arg",
          "Value": "${INSTALL_DIR_ROOT}/${PRODUCT_VERSION}"
        },
        {
          "Key": "PHP_SRC_TARXZ_URL",
          "Name": "arg",
          "Value": "\"http://sg2.php.net/get/php-7.1.6.tar.xz/from/this/mirror\""
        },
        {
          "Key": "PHP_SRC_TARXZ",
          "Name": "arg",
          "Value": "php-7.1.6.tar.xz"
        },
        {
          "Key": "PHP_SRC_TARXZ_SHA256SUM",
          "Name": "arg",
          "Value": "01584dc521ab7ec84b502b61952f573652fe6aa00c18d6d844fb9209f14b245b"
        },
        {
          "Key": "PHP_GPG_KEYS",
          "Name": "arg",
          "Value": "\"9C0D5763 33CFC8B3\""
        },
        {
          "Key": "PHP_SRC_TARXZ_ASC_URL",
          "Name": "arg",
          "Value": "\"http://php.net/get/php-7.1.6.tar.xz.asc/from/a/mirror\""
        },
        {
          "Key": "PHP_SRC_TARXZ_ASC",
          "Name": "arg",
          "Value": "\"php-7.1.6.tar.xz.asc\""
        },
        {
          "Name": "user",
          "User": "${ROOT_UID}"
        },
        {
          "CmdLine": [
            "PHP_COMPILE_DEPENDENCIES=\"gcc gcc-c++ autoconf automake make libtool flex bison re2c \" \u0026\u0026 PHP_COMPILE_DEPENDENCIES+=\"libxml2-devel openssl-devel gdbm-devel zlib-devel bzip2-devel \" \u0026\u0026 PHP_COMPILE_DEPENDENCIES+=\"libcurl-devel sqlite-devel pcre-devel gmp-devel gd-devel \" \u0026\u0026 PHP_COMPILE_DEPENDENCIES+=\"libc-client-devel uw-imap-static uw-imap-devel libicu-devel openldap-devel \" \u0026\u0026 PHP_COMPILE_DEPENDENCIES+=\"libmcrypt-devel postgresql-devel aspell-devel readline-devel libedit-devel \" \u0026\u0026 PHP_COMPILE_DEPENDENCIES+=\"net-snmp-devel libtidy-devel libxslt-devel\" \u0026\u0026 yum install -y epel-release \u0026\u0026 yum install -y ${PHP_COMPILE_DEPENDENCIES} \u0026\u0026 mkdir -p ${TEMP_DIR} ${INSTALL_DIR} \u0026\u0026 pushd ${TEMP_DIR} \u0026\u0026 curl -LjSs ${PHP_SRC_TARXZ_URL} -o ${PHP_SRC_TARXZ} \u0026\u0026 curl -LjSs ${PHP_SRC_TARXZ_ASC_URL} -o ${PHP_SRC_TARXZ_ASC} \u0026\u0026 for PHP_GPG_KEY in ${PHP_GPG_KEYS}; do gpg --keyserver pool.sks-keyservers.net --recv-keys ${PHP_GPG_KEY}; done \u0026\u0026 echo \"${PHP_SRC_TARXZ_SHA256SUM}  ${PHP_SRC_TARXZ}\" | sha256sum -c - \u0026\u0026 tar -xf ${PHP_SRC_TARXZ} --strip-components=1 -C ${TEMP_DIR} \u0026\u0026 ./configure --prefix=${INSTALL_DIR} --with-libdir=lib64 --enable-re2c-cgoto --enable-fpm --enable-phpdbg --enable-phpdbg-webhelper --with-openssl --with-kerberos --with-pcre-regex --with-pcre-jit --with-zlib --enable-bcmath --with-bz2 --enable-calendar --with-curl --enable-dba --with-gdbm --enable-exif --enable-ftp --with-gd --enable-gd-native-ttf --enable-gd-jis-conv --with-gettext --with-gmp --with-mhash --with-imap --with-kerberos --with-imap-ssl --enable-intl --with-ldap --enable-mbstring --with-mcrypt --with-mysqli --enable-pcntl --with-pdo-mysql --with-pdo-pgsql --with-pgsql --with-pspell --with-libedit --with-readline --enable-shmop --with-snmp --enable-soap --enable-sockets --enable-sysvmsg --enable-sysvsem --enable-sysvshm --with-tidy --enable-wddx --with-xmlrpc --with-xsl --enable-zip --enable-mysqlnd --with-pear \u0026\u0026 make \u0026\u0026 make install \u0026\u0026 pushd ${INSTALL_DIR} \u0026\u0026 PATH=${INSTALL_DIR}/bin:${PATH} pear upgrade-all \u0026\u0026 popd \u0026\u0026 fix-ownership ${INSTALL_DIR} \u0026\u0026 fix-permissions ${INSTALL_DIR} \u0026\u0026 yum remove -y ${PHP_COMPILE_DEPENDENCIES} \u0026\u0026 yum clean all \u0026\u0026 popd \u0026\u0026 rm -rf ${TEMP_DIR_ROOT}"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "Env": [
            {
              "Key": "PHP_HOME",
              "Value": "${INSTALL_DIR}"
            }
          ],
          "Name": "env"
        },
        {
          "Env": [
            {
              "Key": "PATH",
              "Value": "${PHP_HOME}/bin:${PATH}"
            }
          ],
          "Name": "env"
        },
        {
          "Name": "user",
          "User": "${APP_UID}"
        }
      ]
    }
  ]
}