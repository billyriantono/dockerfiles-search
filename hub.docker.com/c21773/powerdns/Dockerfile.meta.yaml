MetaArgs: null
Stages:
- BaseName: alpine:3.7
  Commands:
  - Maintainer: Cristian MÃ¼ller <cristian.mueller@muber.de>
    Name: maintainer
  - Env:
    - Key: REFRESHED_AT
      Value: '"2018-07-15"'
    - Key: POWERDNS_VERSION
      Value: 4.1.3
    - Key: MYSQL_AUTOCONF
      Value: "false"
    - Key: MYSQL_HOST
      Value: '"mysql"'
    - Key: MYSQL_PORT
      Value: '"3306"'
    - Key: MYSQL_USER
      Value: '"root"'
    - Key: MYSQL_PASS
      Value: '"root"'
    - Key: MYSQL_DB
      Value: '"pdns"'
    Name: env
  - CmdLine:
    - apk --update add           libstdc++ libgcc libressl libsodium boost-program_options           mysql-client
      mariadb-client-libs mariadb-libs           libpq postgresql-libs           sqlite-libs
      lua &&         apk add --virtual build-deps           file g++ make mariadb-dev
      postgresql-dev sqlite-dev lua-dev libressl-dev boost-dev libsodium-dev curl
      &&     curl -sSL https://downloads.powerdns.com/releases/pdns-$POWERDNS_VERSION.tar.bz2
      | tar xj -C /tmp &&     cd /tmp/pdns-$POWERDNS_VERSION &&     ./configure --prefix=""
      --exec-prefix=/usr --sysconfdir=/etc/pdns       --with-modules="bind gmysql
      gpgsql gsqlite3" --with-dynmodules="pipe random lua remote" &&     make && make
      install-strip && cd / &&     mkdir -p /etc/pdns/conf.d &&     addgroup -S pdns
      2>/dev/null &&     adduser -S -D -H -h /var/empty -s /bin/false -G pdns -g pdns
      pdns 2>/dev/null &&     apk del --purge build-deps &&     rm -rf /tmp/pdns-$POWERDNS_VERSION
      /var/cache/apk/*
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - schema.sql
    - pdns.conf
    - /etc/pdns/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - entrypoint.sh
    - /
  - Name: expose
    Ports:
    - 53/tcp
    - 53/udp
  - CmdLine:
    - /entrypoint.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: alpine:3.7
  Name: ""
  Platform: ""
  SourceCode: FROM alpine:3.7
