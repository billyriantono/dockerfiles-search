MetaArgs: null
Stages:
- BaseName: tensorflow/tensorflow:1.4.0-py3
  Commands:
  - Maintainer: Kevin Zhao <kevin8093@126.com>
    Name: maintainer
  - CmdLine:
    - sed -i 's/http:\/\/archive\.ubuntu\.com\/ubuntu\//http:\/\/mirrors\.163\.com\/ubuntu\//g'
      /etc/apt/sources.list
    Name: run
    PrependShell: true
  - Env:
    - Key: PYTHON_BIN_PATH
      Value: /usr/bin/python3
    - Key: PYTHON_LIB_PATH
      Value: /usr/local/lib/python3.5/dist-packages
    Name: env
  - CmdLine:
    - apt-get update &&     apt-get install -y wget git protobuf-compiler python-pil
      python-lxml &&     git clone https://github.com/tensorflow/models.git /notebooks/model
      &&     cd /notebooks/model/research &&     protoc object_detection/protos/*.proto
      --python_out=. &&     export PYTHONPATH=$PYTHONPATH:`pwd`:`pwd`/slim &&     apt-get
      install -y --no-install-recommends apt-utils &&     apt-get install -y --no-install-recommends
      curl unzip openssh-client wget &&     apt-get install -y --no-install-recommends
      build-essential cmake &&     apt-get install -y --no-install-recommends libopenblas-dev
      &&     apt-get install -y --no-install-recommends libjpeg8-dev libtiff5-dev
      libjasper-dev libpng12-dev     libavcodec-dev libavformat-dev libswscale-dev
      libv4l-dev libgtk2.0-dev     liblapacke-dev checkinstall
    Name: run
    PrependShell: true
  - CmdLine:
    - git clone https://github.com/opencv/opencv.git /usr/local/src/opencv &&     git
      clone https://github.com/opencv/opencv_contrib.git /usr/local/src/opencv_contrib
      &&     cd /usr/local/src/opencv && mkdir build && cd build &&     cmake -D CMAKE_INSTALL_PREFIX=/usr/local           -D
      BUILD_TESTS=OFF           -D BUILD_opencv_gpu=OFF           -D BUILD_PERF_TESTS=OFF           -D
      WITH_IPP=OFF           -D OPENCV_EXTRA_MODULES_PATH=/usr/local/src/opencv_contrib/modules           -D
      OPENCV_EXTRA_MODULES_PATH=/usr/local/src/opencv_contrib/modules -D BUILD_opencv_xfeatures2d=OFF
      /usr/local/src/opencv           -D OPENCV_EXTRA_MODULES_PATH=/usr/local/src/opencv_contrib/modules
      -D BUILD_opencv_dnn_modern=OFF /usr/local/src/opencv           -D OPENCV_EXTRA_MODULES_PATH=/usr/local/src/opencv_contrib/modules
      -D BUILD_opencv_dnns_easily_fooled=OFF /usr/local/src/opencv           -D PYTHON_DEFAULT_EXECUTABLE=$(which
      python3)           .. &&     make -j"$(nproc)" &&     make install
    Name: run
    PrependShell: true
  From:
    Image: tensorflow/tensorflow:1.4.0-py3
  Name: ""
  Platform: ""
  SourceCode: FROM tensorflow/tensorflow:1.4.0-py3
