MetaArgs: null
Stages:
- BaseName: phusion/baseimage:0.11
  Commands:
  - Labels:
    - Key: author
      Value: '"jorge.duarte.campderros@cern.ch"'
    - Key: version
      Value: '"0.2-alpha"'
    - Key: description
      Value: '"Docker image for refurbished TRACS-v2"'
    Name: label
  - Name: user
    User: root
  - CmdLine:
    - apt-get update   && install_clean --no-install-recommends software-properties-common   &&
      add-apt-repository ppa:fenics-packages/fenics   && apt-get update   && install_clean
      fenics   && install_clean --no-install-recommends    build-essential    python3-dev    python3-numpy    vim    libvtk7.1-qt    libvtk7-qt-dev    libxpm4    wget    git    python3-click    python3-pip    python3-matplotlib    gmsh    sudo   &&
      apt-get clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*
    Name: run
    PrependShell: true
  - Chown: ""
    From: duartej/rootpython3:6.18.0
    Name: copy
    SourcesAndDest:
    - /rootfr/root
    - /rootfr/root
  - Env:
    - Key: ROOTSYS
      Value: /rootfr/root
    Name: env
  - Env:
    - Key: LD_LIBRARY_PATH
      Value: /rootfr/root/lib
    Name: env
  - Env:
    - Key: PYTHONPATH
      Value: /rootfr/root/lib
    Name: env
  - CmdLine:
    - 'useradd -m -s /bin/bash -G sudo tracs   && echo "tracs:docker" | chpasswd   &&
      echo "tracs ALL=(ALL) NOPASSWD: ALL\n" >> /etc/sudoers   && cat /etc/sudoers   &&
      rm /etc/my_init.d/10_syslog-ng.init   && ldconfig   && if [ -e /usr/bin/python
      ]; then unlink /usr/bin/python; ln -sf /usr/bin/python3 /usr/bin/python; fi'
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /home/tracs
  - Name: user
    User: tracs
  - CmdLine:
    - touch /home/tracs/.sudo_as_admin_successful &&   mkdir /home/tracs/tracs-code
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /home/tracs/tracs-code
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - pythonlogon_py
    - /home/tracs/.pythonlogon.py
  - Env:
    - Key: LD_LIBRARY_PATH
      Value: '"${LD_LIBRARY_PATH}:/home/tracs/tracs-code/build/src"'
    Name: env
  - Env:
    - Key: PYTHONPATH
      Value: '"${PYTHONPATH}:/home/tracs/tracs-code/build/tracspy/python"'
    Name: env
  - Env:
    - Key: PYTHONSTARTUP
      Value: '"/home/tracs/.pythonlogon.py"'
    Name: env
  - Env:
    - Key: PATH
      Value: '"${PATH}:/rootfr/root/bin:/home/tracs/tracs-code/build/tracspy/bin"'
    Name: env
  - CmdLine:
    - pip3 install --user meshio lxml h5py
    Name: run
    PrependShell: true
  - Name: user
    User: root
  - CmdLine:
    - /sbin/my_init
    - --quiet
    - --
    - /sbin/setuser
    - tracs
    - /bin/bash
    - -l
    - -c
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - /bin/bash
    - -i
    Name: cmd
    PrependShell: false
  From:
    Image: phusion/baseimage:0.11
  Name: ""
  Platform: ""
  SourceCode: FROM phusion/baseimage:0.11
