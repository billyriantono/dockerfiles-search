MetaArgs: null
Stages:
- BaseName: php:7.1-apache
  Commands:
  - Maintainer: Dan Gibson <daniel.gibson@xandermar.com>
    Name: maintainer
  - CmdLine:
    - a2enmod rewrite
    Name: run
    PrependShell: true
  - CmdLine:
    - docker-php-ext-install mysqli
    Name: run
    PrependShell: true
  - CmdLine:
    - "set -ex; \t\tif command -v a2enmod; then \t\ta2enmod rewrite; \tfi; \t\tsavedAptMark=\"$(apt-mark
      showmanual)\"; \t\tapt-get update; \tapt-get install -y --no-install-recommends
      \t\tlibjpeg-dev \t\tlibpng-dev \t\tlibpq-dev \t; \t\tdocker-php-ext-configure
      gd --with-png-dir=/usr --with-jpeg-dir=/usr; \tdocker-php-ext-install -j \"$(nproc)\"
      \t\tgd \t\topcache \t\tpdo_mysql \t\tpdo_pgsql \t\tzip \t; \t\tapt-mark auto
      '.*' > /dev/null; \tapt-mark manual $savedAptMark; \tldd \"$(php -r 'echo ini_get(\"extension_dir\");')\"/*.so
      \t\t| awk '/=>/ { print $3 }' \t\t| sort -u \t\t| xargs -r dpkg-query -S \t\t|
      cut -d: -f1 \t\t| sort -u \t\t| xargs -rt apt-mark manual; \t\tapt-get purge
      -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \trm -rf /var/lib/apt/lists/*"
    Name: run
    PrependShell: true
  - CmdLine:
    - "{ \t\techo 'opcache.memory_consumption=128'; \t\techo 'opcache.interned_strings_buffer=8';
      \t\techo 'opcache.max_accelerated_files=4000'; \t\techo 'opcache.revalidate_freq=60';
      \t\techo 'opcache.fast_shutdown=1'; \t\techo 'opcache.enable_cli=1'; \t} > /usr/local/etc/php/conf.d/opcache-recommended.ini"
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
    Name: run
    PrependShell: true
  - CmdLine:
    - php composer-setup.php
    Name: run
    PrependShell: true
  - CmdLine:
    - php -r "unlink('composer-setup.php');"
    Name: run
    PrependShell: true
  - CmdLine:
    - mv composer.phar /usr/local/bin/composer
    Name: run
    PrependShell: true
  - CmdLine:
    - composer require drush/drush:8
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -s /var/www/html/vendor/drush/drush/drush /usr/local/bin/drush
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install vim -y
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install mysql-client -y
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install ruby-full -y
    Name: run
    PrependShell: true
  - CmdLine:
    - gem update --system
    Name: run
    PrependShell: true
  - CmdLine:
    - gem install compass
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /var/www/html
  From:
    Image: php:7.1-apache
  Name: ""
  Platform: ""
  SourceCode: FROM php:7.1-apache
