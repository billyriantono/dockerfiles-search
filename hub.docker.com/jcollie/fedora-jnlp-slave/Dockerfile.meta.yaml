MetaArgs: null
Stages:
- BaseName: registry.fedoraproject.org/fedora:28
  Commands:
  - Env:
    - Key: LANG
      Value: C.UTF-8
    Name: env
  - CmdLine:
    - dnf -y update && rm -rf /usr/share/doc /usr/share/man /var/cache/dnf
    Name: run
    PrependShell: true
  - CmdLine:
    - dnf -y install curl git java-1.8.0-openjdk-headless sudo && rm -rf /usr/share/doc
      /usr/share/man /var/cache/dnf
    Name: run
    PrependShell: true
  - Env:
    - Key: HOME
      Value: /home/jenkins
    Name: env
  - CmdLine:
    - groupadd -g 10000 jenkins
    Name: run
    PrependShell: true
  - CmdLine:
    - useradd -c "Jenkins user" -d $HOME -u 10000 -g 10000 -m jenkins
    Name: run
    PrependShell: true
  - CmdLine:
    - 'echo "jenkins ALL=(ALL) NOPASSWD: ALL" > /etc/sudoers.d/jenkins'
    Name: run
    PrependShell: true
  - Key: VERSION
    Name: arg
    Value: "3.20"
  - Key: AGENT_WORKDIR
    Name: arg
    Value: /home/jenkins/agent
  - CmdLine:
    - curl --create-dirs -sSLo /usr/share/jenkins/slave.jar https://repo.jenkins-ci.org/public/org/jenkins-ci/main/remoting/${VERSION}/remoting-${VERSION}.jar   &&
      chmod 755 /usr/share/jenkins   && chmod 644 /usr/share/jenkins/slave.jar
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - https://github.com/jenkinsci/docker-jnlp-slave/raw/master/jenkins-slave
    - /usr/local/bin/jenkins-slave
  - CmdLine:
    - chmod 755 /usr/local/bin/jenkins-slave
    Name: run
    PrependShell: true
  - Name: user
    User: jenkins
  - Env:
    - Key: AGENT_WORKDIR
      Value: ${AGENT_WORKDIR}
    Name: env
  - CmdLine:
    - mkdir -p /home/jenkins/.jenkins ${AGENT_WORKDIR}
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /home/jenkins/.jenkins
  - Name: volume
    Volumes:
    - ${AGENT_WORKDIR}
  - Name: workdir
    Path: /home/jenkins
  - CmdLine:
    - jenkins-slave
    Name: entrypoint
    PrependShell: false
  From:
    Image: registry.fedoraproject.org/fedora:28
  Name: ""
  Platform: ""
  SourceCode: FROM registry.fedoraproject.org/fedora:28
