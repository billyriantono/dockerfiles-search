MetaArgs: null
Stages:
- BaseName: adoptopenjdk/openjdk11:x86_64-alpine-jre-11.0.2.9
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"Mathew Moon <mmoon@quinovas.com>"'
    Name: label
  - CmdLine:
    - apk add --no-cache     bash     su-exec
    Name: run
    PrependShell: true
  - CmdLine:
    - set -ex &&    export GPG_KEY=D0BC8D8A4E90A40AFDFC43B3E22A746A68E327C1 &&    mkdir
      -p /logs /datalog /conf /data &&    apk add --no-cache --virtual .build-deps         ca-certificates         gnupg         libressl;     wget
      -q "https://www.apache.org/dist/zookeeper/zookeeper-3.5.4-beta/zookeeper-3.5.4-beta.tar.gz";     wget
      -q "https://www.apache.org/dist/zookeeper/zookeeper-3.5.4-beta/zookeeper-3.5.4-beta.tar.gz.asc";     export
      GNUPGHOME="$(mktemp -d)";     gpg --keyserver ha.pool.sks-keyservers.net --recv-key
      "$GPG_KEY" ||     gpg --keyserver pgp.mit.edu --recv-keys "$GPG_KEY" ||     gpg
      --keyserver keyserver.pgp.com --recv-keys "$GPG_KEY" &&     gpg --batch --verify
      "zookeeper-3.5.4-beta.tar.gz.asc" "zookeeper-3.5.4-beta.tar.gz" &&     tar -zxf
      "zookeeper-3.5.4-beta.tar.gz" &&     mv zookeeper-3.5.4-beta /zookeeper &&     mv
      "zookeeper/conf/"* /conf &&     rm -rf "$GNUPGHOME" "zookeeper-3.5.4-beta.tar.gz"
      "zookeeper-3.5.4-beta.tar.gz.asc" &&     apk del .build-deps &&     adduser
      -D "zookeeper" &&     chown -R zookeeper:zookeeper /logs /datalog /conf /data
      /zookeeper &&     rm -f /zookeeper/bin/*.cmd &&     rm -f /zookeeper/bin/zkServer.sh
      &&     rm -f /zookeeper/bin/zkEnv.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - wget -qO /usr/local/bin/prometheus_agent.jar https://repo1.maven.org/maven2/io/prometheus/jmx/jmx_prometheus_javaagent/0.11.0/jmx_prometheus_javaagent-0.11.0.jar
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /zookeeper
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - zookeeper
    - /zookeeper/bin/zookeeper
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - prometheus.yml
    - /etc/prometheus/config.yml
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - zoo.cfg
    - /conf/zoo.cfg
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - log4j.properties
    - /conf/log4j.properties
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ensemble.cfg
    - /conf/ensemble.cfg
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - client
    - /zookeeper/bin/zk-client
  - CmdLine:
    - chmod +x /zookeeper/bin/zk-client
    Name: run
    PrependShell: true
  - CmdLine:
    - chmod +x /zookeeper/bin/zookeeper
    Name: run
    PrependShell: true
  - CmdLine:
    - chown -R zookeeper:zookeeper /logs /datalog /conf /data /zookeeper
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: $PATH:/zookeeper/bin
    Name: env
  - CmdLine:
    - /zookeeper/bin/zookeeper
    Name: cmd
    PrependShell: false
  From:
    Image: adoptopenjdk/openjdk11:x86_64-alpine-jre-11.0.2.9
  Name: ""
  Platform: ""
  SourceCode: FROM adoptopenjdk/openjdk11:x86_64-alpine-jre-11.0.2.9
