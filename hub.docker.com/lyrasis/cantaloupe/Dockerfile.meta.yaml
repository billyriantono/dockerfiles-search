MetaArgs: null
Stages:
- BaseName: ubuntu:16.04
  Commands:
  - Env:
    - Key: CANTALOUPE_UID
      Value: "999"
    - Key: CANTALOUPE_GID
      Value: "999"
    - Key: JAVA_OPTS
      Value: -Xmx500m
    - Key: PROPERTIES_FILE
      Value: /cantaloupe/cantaloupe.properties
    - Key: HTTP_HTTP2_ENABLED
      Value: '"false"'
    - Key: HTTP_ACCEPT_QUEUE_LIMIT
      Value: '""'
    - Key: BASE_URI
      Value: '""'
    - Key: SLASH_SUBSTITUTE
      Value: '""'
    - Key: MAX_PIXELS
      Value: '"400000000"'
    - Key: PRINT_STACK_TRACE_ON_ERROR_PAGES
      Value: '"true"'
    - Key: DELEGATE_SCRIPT_ENABLED
      Value: '"false"'
    - Key: DELEGATE_SCRIPT_PATHNAME
      Value: '"delegates.rb"'
    - Key: DELEGATE_SCRIPT_CACHE_ENABLED
      Value: '"false"'
    - Key: ENDPOINT_PUBLIC_AUTH_BASIC_ENABLED
      Value: '"false"'
    - Key: ENDPOINT_PUBLIC_AUTH_BASIC_USERNAME
      Value: '"myself"'
    - Key: ENDPOINT_PUBLIC_AUTH_BASIC_SECRET
      Value: '"mypassword"'
    - Key: ENDPOINT_IIIF_1_ENABLED
      Value: '"false"'
    - Key: ENDPOINT_IIIF_2_ENABLED
      Value: '"true"'
    - Key: ENDPOINT_IIIF_CONTENT_DISPOSITION
      Value: '"inline"'
    - Key: ENDPOINT_IIIF_MIN_SIZE
      Value: '"64"'
    - Key: ENDPOINT_IIIF_MIN_TILE_SIZE
      Value: '"512"'
    - Key: ENDPOINT_IIIF_2_RESTRICT_TO_SIZES
      Value: '"false"'
    - Key: ENDPOINT_ADMIN_ENABLED
      Value: '"false"'
    - Key: ENDPOINT_ADMIN_USERNAME
      Value: '"admin"'
    - Key: ENDPOINT_ADMIN_SECRET
      Value: '""'
    - Key: ENDPOINT_API_ENABLED
      Value: '"false"'
    - Key: ENDPOINT_API_USERNAME
      Value: '""'
    - Key: ENDPOINT_API_SECRET
      Value: '""'
    - Key: SOURCE_STATIC
      Value: '"FilesystemSource"'
    - Key: SOURCE_DELEGATE
      Value: '"false"'
    - Key: FILESYSTEMSOURCE_LOOKUP_STRATEGY
      Value: '"BasicLookupStrategy"'
    - Key: FILESYSTEMSOURCE_BASICLOOKUPSTRATEGY_PATH_PREFIX
      Value: '"/home/myself/images/"'
    - Key: FILESYSTEMSOURCE_BASICLOOKUPSTRATEGY_PATH_SUFFIX
      Value: '""'
    - Key: HTTPSOURCE_TRUST_ALL_CERTS
      Value: '"false"'
    - Key: HTTPSOURCE_REQUEST_TIMEOUT
      Value: '""'
    - Key: HTTPSOURCE_LOOKUP_STRATEGY
      Value: '"BasicLookupStrategy"'
    - Key: HTTPSOURCE_BASICLOOKUPSTRATEGY_URL_PREFIX
      Value: '"http://localhost/images/"'
    - Key: HTTPSOURCE_BASICLOOKUPSTRATEGY_URL_SUFFIX
      Value: '""'
    - Key: HTTPSOURCE_BASICLOOKUPSTRATEGY_AUTH_BASIC_USERNAME
      Value: '""'
    - Key: HTTPSOURCE_BASICLOOKUPSTRATEGY_AUTH_BASIC_SECRET
      Value: '""'
    - Key: JDBCSOURCE_URL
      Value: '"jdbc:postgresql://localhost:5432/my_database"'
    - Key: JDBCSOURCE_USER
      Value: '"postgres"'
    - Key: JDBCSOURCE_PASSWORD
      Value: '"postgres"'
    - Key: JDBCSOURCE_CONNECTION_TIMEOUT
      Value: '"10"'
    - Key: S3SOURCE_ENDPOINT
      Value: '""'
    - Key: S3SOURCE_ACCESS_KEY_ID
      Value: '""'
    - Key: S3SOURCE_SECRET_KEY
      Value: '""'
    - Key: S3SOURCE_MAX_CONNECTIONS
      Value: '""'
    - Key: S3SOURCE_LOOKUP_STRATEGY
      Value: '"BasicLookupStrategy"'
    - Key: S3SOURCE_BASICLOOKUPSTRATEGY_BUCKET_NAME
      Value: '""'
    - Key: S3SOURCE_BASICLOOKUPSTRATEGY_PATH_PREFIX
      Value: '""'
    - Key: S3SOURCE_BASICLOOKUPSTRATEGY_PATH_SUFFIX
      Value: '""'
    - Key: AZURESTORAGESOURCE_ACCOUNT_NAME
      Value: '""'
    - Key: AZURESTORAGESOURCE_ACCOUNT_KEY
      Value: '""'
    - Key: AZURESTORAGESOURCE_CONTAINER_NAME
      Value: '""'
    - Key: AZURESTORAGESOURCE_LOOKUP_STRATEGY
      Value: '"BasicLookupStrategy"'
    - Key: PROCESSOR_AVI
      Value: '"FfmpegProcessor"'
    - Key: PROCESSOR_BMP
      Value: '""'
    - Key: PROCESSOR_DCM
      Value: '"ImageMagickProcessor"'
    - Key: PROCESSOR_FLV
      Value: '"FfmpegProcessor"'
    - Key: PROCESSOR_GIF
      Value: '""'
    - Key: PROCESSOR_JP2
      Value: '"KakaduNativeProcessor"'
    - Key: PROCESSOR_JPG
      Value: '""'
    - Key: PROCESSOR_MOV
      Value: '"FfmpegProcessor"'
    - Key: PROCESSOR_MP4
      Value: '"FfmpegProcessor"'
    - Key: PROCESSOR_MPG
      Value: '"FfmpegProcessor"'
    - Key: PROCESSOR_PDF
      Value: '"PdfBoxProcessor"'
    - Key: PROCESSOR_PNG
      Value: '""'
    - Key: PROCESSOR_TIF
      Value: '""'
    - Key: PROCESSOR_WEBM
      Value: '"FfmpegProcessor"'
    - Key: PROCESSOR_WEBP
      Value: '"ImageMagickProcessor"'
    - Key: PROCESSOR_FALLBACK
      Value: '"Java2dProcessor"'
    - Key: PROCESSOR_STREAM_RETRIEVAL_STRATEGY
      Value: '"StreamStrategy"'
    - Key: PROCESSOR_FALLBACK_RETRIEVAL_STRATEGY
      Value: '"DownloadStrategy"'
    - Key: PROCESSOR_DPI
      Value: '"150"'
    - Key: PROCESSOR_NORMALIZE
      Value: '"false"'
    - Key: PROCESSOR_BACKGROUND_COLOR
      Value: '"white"'
    - Key: PROCESSOR_DOWNSCALE_FILTER
      Value: '"bicubic"'
    - Key: PROCESSOR_UPSCALE_FILTER
      Value: '"bicubic"'
    - Key: PROCESSOR_SHARPEN
      Value: '"0"'
    - Key: PROCESSOR_METADATA_PRESERVE
      Value: '"false"'
    - Key: PROCESSOR_METADATA_RESPECT_ORIENTATION
      Value: '"false"'
    - Key: PROCESSOR_JPG_PROGRESSIVE
      Value: '"true"'
    - Key: PROCESSOR_JPG_QUALITY
      Value: '"80"'
    - Key: PROCESSOR_TIF_COMPRESSION
      Value: '"LZW"'
    - Key: PROCESSOR_IMAGEIO_BMP_READER
      Value: '""'
    - Key: PROCESSOR_IMAGEIO_GIF_READER
      Value: '""'
    - Key: PROCESSOR_IMAGEIO_GIF_WRITER
      Value: '""'
    - Key: PROCESSOR_IMAGEIO_JPG_READER
      Value: '""'
    - Key: PROCESSOR_IMAGEIO_JPG_WRITER
      Value: '""'
    - Key: PROCESSOR_IMAGEIO_PNG_READER
      Value: '""'
    - Key: PROCESSOR_IMAGEIO_PNG_WRITER
      Value: '""'
    - Key: PROCESSOR_IMAGEIO_TIF_READER
      Value: '""'
    - Key: PROCESSOR_IMAGEIO_TIF_WRITER
      Value: '""'
    - Key: CACHE_CLIENT_ENABLED
      Value: '"true"'
    - Key: CACHE_CLIENT_MAX_AGE
      Value: '"2592000"'
    - Key: CACHE_CLIENT_SHARED_MAX_AGE
      Value: '""'
    - Key: CACHE_CLIENT_PUBLIC
      Value: '"true"'
    - Key: CACHE_CLIENT_PRIVATE
      Value: '"false"'
    - Key: CACHE_CLIENT_NO_CACHE
      Value: '"false"'
    - Key: CACHE_CLIENT_NO_STORE
      Value: '"false"'
    - Key: CACHE_CLIENT_MUST_REVALIDATE
      Value: '"false"'
    - Key: CACHE_CLIENT_PROXY_REVALIDATE
      Value: '"false"'
    - Key: CACHE_CLIENT_NO_TRANSFORM
      Value: '"true"'
    - Key: CACHE_SERVER_SOURCE
      Value: '"FilesystemCache"'
    - Key: CACHE_SERVER_SOURCE_TTL_SECONDS
      Value: '"2592000"'
    - Key: CACHE_SERVER_DERIVATIVE_ENABLED
      Value: '"false"'
    - Key: CACHE_SERVER_DERIVATIVE
      Value: '""'
    - Key: CACHE_SERVER_DERIVATIVE_TTL_SECONDS
      Value: '"2592000"'
    - Key: CACHE_SERVER_INFO_ENABLED
      Value: '"true"'
    - Key: CACHE_SERVER_PURGE_MISSING
      Value: '"false"'
    - Key: CACHE_SERVER_RESOLVE_FIRST
      Value: '"false"'
    - Key: CACHE_SERVER_WORKER_ENABLED
      Value: '"false"'
    - Key: CACHE_SERVER_WORKER_INTERVAL
      Value: '"86400"'
    - Key: FILESYSTEMCACHE_PATHNAME
      Value: '"/var/cache/cantaloupe"'
    - Key: FILESYSTEMCACHE_DIR_DEPTH
      Value: '"3"'
    - Key: FILESYSTEMCACHE_DIR_NAME_LENGTH
      Value: '"2"'
    - Key: HEAPCACHE_TARGET_SIZE
      Value: '"2G"'
    - Key: HEAPCACHE_PERSIST
      Value: '"false"'
    - Key: HEAPCACHE_PERSIST_FILESYSTEM_PATHNAME
      Value: '"/var/cache/cantaloupe/heap.cache"'
    - Key: JDBCCACHE_URL
      Value: '"jdbc:postgresql://localhost:5432/cantaloupe"'
    - Key: JDBCCACHE_USER
      Value: '"postgres"'
    - Key: JDBCCACHE_PASSWORD
      Value: '""'
    - Key: JDBCCACHE_CONNECTION_TIMEOUT
      Value: '"10"'
    - Key: JDBCCACHE_DERIVATIVE_IMAGE_TABLE
      Value: '"derivative_cache"'
    - Key: JDBCCACHE_INFO_TABLE
      Value: '"info_cache"'
    - Key: S3CACHE_ENDPOINT
      Value: '""'
    - Key: S3CACHE_ACCESS_KEY_ID
      Value: '""'
    - Key: S3CACHE_SECRET_KEY
      Value: '""'
    - Key: S3CACHE_BUCKET_NAME
      Value: '""'
    - Key: S3CACHE_OBJECT_KEY_PREFIX
      Value: '""'
    - Key: S3CACHE_MAX_CONNECTIONS
      Value: '""'
    - Key: AZURESTORAGECACHE_ACCOUNT_NAME
      Value: '""'
    - Key: AZURESTORAGECACHE_ACCOUNT_KEY
      Value: '""'
    - Key: AZURESTORAGECACHE_CONTAINER_NAME
      Value: '""'
    - Key: AZURESTORAGECACHE_OBJECT_KEY_PREFIX
      Value: '""'
    - Key: REDISCACHE_HOST
      Value: '"localhost"'
    - Key: REDISCACHE_PORT
      Value: '"6379"'
    - Key: REDISCACHE_SSL
      Value: '"false"'
    - Key: REDISCACHE_PASSWORD
      Value: '""'
    - Key: REDISCACHE_DATABASE
      Value: '"0"'
    - Key: OVERLAYS_ENABLED
      Value: '"false"'
    - Key: OVERLAYS_STRATEGY
      Value: '"BasicStrategy"'
    - Key: OVERLAYS_BASICSTRATEGY_TYPE
      Value: '"image"'
    - Key: OVERLAYS_BASICSTRATEGY_IMAGE
      Value: '"/path/to/overlay.png"'
    - Key: OVERLAYS_BASICSTRATEGY_STRING
      Value: '"Copyright \u00A9Ô∏è My Great Organization\nAll rights reserved."'
    - Key: OVERLAYS_BASICSTRATEGY_STRING_FONT
      Value: '"Helvetica"'
    - Key: OVERLAYS_BASICSTRATEGY_STRING_FONT_SIZE
      Value: '"24"'
    - Key: OVERLAYS_BASICSTRATEGY_STRING_FONT_MIN_SIZE
      Value: '"18"'
    - Key: OVERLAYS_BASICSTRATEGY_STRING_FONT_WEIGHT
      Value: '"1.0"'
    - Key: OVERLAYS_BASICSTRATEGY_STRING_GLYPH_SPACING
      Value: '"0.02"'
    - Key: OVERLAYS_BASICSTRATEGY_STRING_COLOR
      Value: '"white"'
    - Key: OVERLAYS_BASICSTRATEGY_STRING_STROKE_COLOR
      Value: '"black"'
    - Key: OVERLAYS_BASICSTRATEGY_STRING_STROKE_WIDTH
      Value: '"1"'
    - Key: OVERLAYS_BASICSTRATEGY_STRING_BACKGROUND_COLOR
      Value: '"rgba(0, 0, 0, 100)"'
    - Key: OVERLAYS_BASICSTRATEGY_POSITION
      Value: '"bottom right"'
    - Key: OVERLAYS_BASICSTRATEGY_INSET
      Value: '"10"'
    - Key: OVERLAYS_BASICSTRATEGY_OUTPUT_WIDTH_THRESHOLD
      Value: '"400"'
    - Key: OVERLAYS_BASICSTRATEGY_OUTPUT_HEIGHT_THRESHOLD
      Value: '"300"'
    - Key: REDACTION_ENABLED
      Value: '"false"'
    - Key: LOG_APPLICATION_LEVEL
      Value: '"debug"'
    - Key: LOG_APPLICATION_CONSOLEAPPENDER_ENABLED
      Value: '"true"'
    - Key: LOG_APPLICATION_FILEAPPENDER_ENABLED
      Value: '"false"'
    - Key: LOG_APPLICATION_FILEAPPENDER_PATHNAME
      Value: '"/path/to/logs/application.log"'
    - Key: LOG_APPLICATION_ROLLINGFILEAPPENDER_ENABLED
      Value: '"false"'
    - Key: LOG_APPLICATION_ROLLINGFILEAPPENDER_PATHNAME
      Value: '"/path/to/logs/application.log"'
    - Key: LOG_APPLICATION_ROLLINGFILEAPPENDER_POLICY
      Value: '"TimeBasedRollingPolicy"'
    - Key: LOG_APPLICATION_ROLLINGFILEAPPENDER_TIMEBASEDROLLINGPOLICY_FILENAME_PATTERN
      Value: '"/path/to/logs/application-%d{yyyy-MM-dd}.log"'
    - Key: LOG_APPLICATION_ROLLINGFILEAPPENDER_TIMEBASEDROLLINGPOLICY_MAX_HISTORY
      Value: '"30"'
    - Key: LOG_APPLICATION_SYSLOGAPPENDER_ENABLED
      Value: '"false"'
    - Key: LOG_APPLICATION_SYSLOGAPPENDER_HOST
      Value: '""'
    - Key: LOG_APPLICATION_SYSLOGAPPENDER_PORT
      Value: '"514"'
    - Key: LOG_APPLICATION_SYSLOGAPPENDER_FACILITY
      Value: '"LOCAL0"'
    - Key: LOG_ERROR_FILEAPPENDER_ENABLED
      Value: '"false"'
    - Key: LOG_ERROR_FILEAPPENDER_PATHNAME
      Value: '"/path/to/logs/error.log"'
    - Key: LOG_ERROR_ROLLINGFILEAPPENDER_ENABLED
      Value: '"false"'
    - Key: LOG_ERROR_ROLLINGFILEAPPENDER_PATHNAME
      Value: '"/path/to/logs/error.log"'
    - Key: LOG_ERROR_ROLLINGFILEAPPENDER_POLICY
      Value: '"TimeBasedRollingPolicy"'
    - Key: LOG_ERROR_ROLLINGFILEAPPENDER_TIMEBASEDROLLINGPOLICY_FILENAME_PATTERN
      Value: '"/path/to/logs/error-%d{yyyy-MM-dd}.log"'
    - Key: LOG_ERROR_ROLLINGFILEAPPENDER_TIMEBASEDROLLINGPOLICY_MAX_HISTORY
      Value: '"30"'
    - Key: LOG_ACCESS_CONSOLEAPPENDER_ENABLED
      Value: '"false"'
    - Key: LOG_ACCESS_FILEAPPENDER_ENABLED
      Value: '"false"'
    - Key: LOG_ACCESS_FILEAPPENDER_PATHNAME
      Value: '"/path/to/logs/access.log"'
    - Key: LOG_ACCESS_ROLLINGFILEAPPENDER_ENABLED
      Value: '"false"'
    - Key: LOG_ACCESS_ROLLINGFILEAPPENDER_PATHNAME
      Value: '"/path/to/logs/access.log"'
    - Key: LOG_ACCESS_ROLLINGFILEAPPENDER_POLICY
      Value: '"TimeBasedRollingPolicy"'
    - Key: LOG_ACCESS_ROLLINGFILEAPPENDER_TIMEBASEDROLLINGPOLICY_FILENAME_PATTERN
      Value: '"/path/to/logs/access-%d{yyyy-MM-dd}.log"'
    - Key: LOG_ACCESS_ROLLINGFILEAPPENDER_TIMEBASEDROLLINGPOLICY_MAX_HISTORY
      Value: '"30"'
    - Key: LOG_ACCESS_SYSLOGAPPENDER_ENABLED
      Value: '"false"'
    - Key: LOG_ACCESS_SYSLOGAPPENDER_HOST
      Value: '""'
    - Key: LOG_ACCESS_SYSLOGAPPENDER_PORT
      Value: '"514"'
    - Key: LOG_ACCESS_SYSLOGAPPENDER_FACILITY
      Value: '"LOCAL0"'
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - /build
  - CmdLine:
    - /build/setup.sh
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "8182"
  - Name: workdir
    Path: /cantaloupe
  - Health:
      Test:
      - CMD-SHELL
      - curl --fail http://localhost:8182/ || exit 1
    Name: healthcheck
  - CmdLine:
    - /build/entrypoint.sh
    Name: cmd
    PrependShell: false
  From:
    Image: ubuntu:16.04
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:16.04
