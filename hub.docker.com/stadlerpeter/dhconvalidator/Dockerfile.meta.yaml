MetaArgs: null
Stages:
- As: builder
  BaseName: gradle:5.4
  Commands:
  - Name: workdir
    Path: /home/gradle/dhconvalidator
  - Name: user
    User: root:root
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - .
  - CmdLine:
    - gradle war
    Name: run
    PrependShell: true
  From:
    Image: gradle:5.4
  Name: builder
  Platform: ""
  SourceCode: FROM gradle:5.4 as builder
- BaseName: jetty:alpine
  Commands:
  - Env:
    - Key: dhconvalidator_base_url
      Value: http://localhost:8080/dhconv
    - Key: dhconvalidator_conftool_login_url
      Value: https://www.conftool.pro/dh2018/
    - Key: dhconvalidator_conftool_rest_url
      Value: https://www.conftool.pro/dh2018/rest.php
    - Key: dhconvalidator_conftool_shared_pass
      Value: quae4EeCh8iepaisoay2gei9wai3Eiz5uyaig1Daisie5ho4caxab8ahraeChaiz
    - Key: dhconvalidator_defaultSubmissionLanguage
      Value: ENGLISH
    - Key: dhconvalidator_encodingDesc
      Value: '''<encodingDesc xmlns="http://www.tei-c.org/ns/1.0"><appInfo><application
        ident="DHCONVALIDATOR" version="{VERSION}"><label>DHConvalidator</label></application></appInfo></encodingDesc>'''
    - Key: dhconvalidator_html_address_generation
      Value: "true"
    - Key: dhconvalidator_html_to_xml_link
      Value: "true"
    - Key: dhconvalidator_image_min_resolution_height
      Value: "50"
    - Key: dhconvalidator_image_min_resolution_width
      Value: "800"
    - Key: dhconvalidator_logConversionStepOutput
      Value: "false"
    - Key: dhconvalidator_oxgarage_url
      Value: https://oxgarage.tei-c.org/ege-webservice/
    - Key: dhconvalidator_paperProviderClass
      Value: org.adho.dhconvalidator.demo.DemoPaperProvider
    - Key: dhconvalidator_performSchemaValidation
      Value: "true"
    - Key: dhconvalidator_publicationStmt
      Value: '''<publicationStmt xmlns="http://www.tei-c.org/ns/1.0"><publisher>Name,
        Institution</publisher><address><addrLine>Street</addrLine><addrLine>City</addrLine><addrLine>Country</addrLine><addrLine>Name</addrLine></address></publicationStmt>'''
    - Key: dhconvalidator_showOnlyAcceptedPapers
      Value: "false"
    - Key: dhconvalidator_showOnlyAcceptedUsers
      Value: "false"
    - Key: dhconvalidator_tei_image_location
      Value: /Pictures
    - Key: dhconvalidator_templateFileDE
      Value: template/DH_template_DH2018_de
    - Key: dhconvalidator_templateFileEN
      Value: template/DH_template_DH2018_en
    - Key: dhconvalidator_templateFileES
      Value: template/DH_template_DH2018_es
    - Key: dhconvalidator_userProviderClass
      Value: org.adho.dhconvalidator.demo.DemoUserProvider
    Name: env
  - Chown: ""
    From: builder
    Name: copy
    SourcesAndDest:
    - /home/gradle/dhconvalidator/build/libs/*.war
    - /tmp/
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - entrypoint.sh
    - /entrypoint.sh
  - Name: user
    User: root:root
  - CmdLine:
    - mkdir -p ${JETTY_BASE}/webapps/ROOT     && unzip /tmp/*.war -d ${JETTY_BASE}/webapps/ROOT     &&
      chown -R jetty:jetty ${JETTY_BASE}/webapps/ROOT
    Name: run
    PrependShell: true
  - Name: user
    User: jetty:jetty
  - CmdLine:
    - /entrypoint.sh
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - java
    - -jar
    - /usr/local/jetty/start.jar
    Name: cmd
    PrependShell: false
  From:
    Image: jetty:alpine
  Name: ""
  Platform: ""
  SourceCode: FROM jetty:alpine
