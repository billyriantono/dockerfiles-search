MetaArgs: null
Stages:
- BaseName: ensemblorg/ensembl-vep:latest
  Commands:
  - Env:
    - Key: SRC_DIR
      Value: /srv/data
    Name: env
  - Env:
    - Key: SCRIPTS
      Value: ${SRC_DIR}/scripts
    Name: env
  - Env:
    - Key: SAMTOOLS_RELEASE
      Value: "1.9"
    Name: env
  - Env:
    - Key: BAMUTIL_VERSION
      Value: 1.0.14
    Name: env
  - Name: user
    User: vep
  - Name: workdir
    Path: ${OPT_SRC}/ensembl-vep
  - CmdLine:
    - ./INSTALL.pl -a p --plugins LoF -s homo_sapiens -y GRCh38
    Name: run
    PrependShell: true
  - Name: user
    User: root
  - CmdLine:
    - set -x     && apt-get update && apt-get install -y         build-essential         cmake         git         libbz2-dev         libcurl4-gnutls-dev         liblzma-dev         libncurses5-dev         libssl-dev         python         python-pip         zlib1g-dev     &&
      pip install --upgrade pip
    Name: run
    PrependShell: true
  - Name: workdir
    Path: ${SRC_DIR}
  - CmdLine:
    - curl -L -o /tmp/samtools-$SAMTOOLS_RELEASE.tar.bz2 https://github.com/samtools/samtools/releases/download/1.9/samtools-$SAMTOOLS_RELEASE.tar.bz2     &&
      tar -xvjf /tmp/samtools-$SAMTOOLS_RELEASE.tar.bz2 -C /tmp     && /tmp/samtools-${SAMTOOLS_RELEASE}/./configure     &&
      make -j5 -C /tmp/samtools-${SAMTOOLS_RELEASE}     && make install -C /tmp/samtools-${SAMTOOLS_RELEASE}
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -L -o /tmp/bamUtil_${BAMUTIL_VERSION} https://github.com/statgen/bamUtil/archive/v1.0.14.tar.gz     &&
      tar -xvf /tmp/bamUtil_${BAMUTIL_VERSION} -C /tmp     && make cloneLib -C /tmp/bamUtil-${BAMUTIL_VERSION}     &&
      make -C /tmp/bamUtil-${BAMUTIL_VERSION}     && make install INSTALLDIR=/usr/local/bin/
      -C /tmp/bamUtil-${BAMUTIL_VERSION}
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - ${SRC_DIR}
  - CmdLine:
    - pip install -r requirements.txt
    Name: run
    PrependShell: true
  - Name: workdir
    Path: ${SCRIPTS}
  - CmdLine:
    - chmod +x *
    Name: run
    PrependShell: true
  - Name: workdir
    Path: ${SRC_DIR}/DataPrep
  - CmdLine:
    - cget install .
    Name: run
    PrependShell: true
  - Name: workdir
    Path: ${SRC_DIR}
  - CmdLine:
    - rm -rf /tmp/*
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: '"${SRC_DIR}/DataPrep/cget/bin:${PATH}"'
    Name: env
  - Env:
    - Key: PATH
      Value: '"${SCRIPTS}:${PATH}"'
    Name: env
  From:
    Image: ensemblorg/ensembl-vep:latest
  Name: ""
  Platform: ""
  SourceCode: FROM ensemblorg/ensembl-vep:latest
