MetaArgs: null
Stages:
- BaseName: centos:7
  Commands:
  - Maintainer: xdf<xudafeng@126.com>
    Name: maintainer
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./CentOS7-Base-163.repo
    - /etc/yum.repos.d/CentOS-Base.repo
  - CmdLine:
    - yum clean all && yum makecache
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /temp
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./zeromq-4.1.4.tar.gz
    - /temp/zeromq-4.1.4.tar.gz
  - CmdLine:
    - yum install -y   xorg-x11-server-Xvfb   java-1.7.0-openjdk-devel   which   glibc.i686   zlib.i686   libgcc-4.8.5-4.el7.i686   glx-utils   git   libstdc++.i686   file   make   qemu-kvm   libvirt   virt-install   bridge-utils   gtk2   libXtst   GConf2   alsa-lib   xorg-x11-fonts*   libnotify   libtool   gcc-c++   krb5-devel   glib*
    Name: run
    PrependShell: true
  - CmdLine:
    - dbus-uuidgen > /etc/machine-id
    Name: run
    PrependShell: true
  - Env:
    - Key: LIBSODIUM_VERSION
      Value: 1.0.3
    Name: env
  - CmdLine:
    - "curl -O http://www.mirrorservice.org/sites/distfiles.macports.org/libsodium/1.0.3_1/libsodium-$LIBSODIUM_VERSION.tar.gz
      \  && mkdir libsodium   && tar -zxvf libsodium-$LIBSODIUM_VERSION.tar.gz --strip-components
      1 -C libsodium \t&& cd ./libsodium && ./autogen.sh && ./configure \t&& make
      && make install \t&& ldconfig"
    Name: run
    PrependShell: true
  - Env:
    - Key: ZEROMQ_VERSION
      Value: 4.1.4
    Name: env
  - CmdLine:
    - "export sodium_CFLAGS=\"-I/usr/local/include\"   && export sodium_LIBS=\"-L/usr/local/lib\"
      \  && export CPATH=/usr/local/include   && export LIBRARY_PATH=/usr/local/lib
      \  && export LD_LIBRARY_PATH=/usr/local/lib   && export LD_RUN_PATH=/usr/local/lib
      \  && export PKG_CONFIG_PATH=/usr/local/lib/pkgconfig   && export CFLAGS=$(pkg-config
      --cflags libsodium)   && export LDFLAGS=$(pkg-config --libs libsodium) \t&&
      tar -zxvf zeromq-$ZEROMQ_VERSION.tar.gz \t&& cd ./zeromq-$ZEROMQ_VERSION \t&&
      ./configure && make && make install   && echo \"/usr/local/lib\" >> /etc/ld.so.conf.d/libzmq.conf
      \t&& ldconfig"
    Name: run
    PrependShell: true
  - Env:
    - Key: ROOT_DIR
      Value: /root
    Name: env
  - CmdLine:
    - git clone --depth=1 https://github.com/creationix/nvm.git $ROOT_DIR/.nvm
    Name: run
    PrependShell: true
  - Env:
    - Key: NODE_VERSION
      Value: v4.5.0
    Name: env
  - Env:
    - Key: NVM_NODEJS_ORG_MIRROR
      Value: https://npm.taobao.org/mirrors/node
    Name: env
  - CmdLine:
    - source $HOME/.nvm/nvm.sh   && NVM_NODEJS_ORG_MIRROR=$NVM_NODEJS_ORG_MIRROR nvm
      install $NODE_VERSION
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: '"$ROOT_DIR/.nvm/versions/node/$NODE_VERSION/bin:$PATH"'
    Name: env
  - Name: workdir
    Path: /
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - ./entrypoint.sh
    - /
  - CmdLine:
    - /entrypoint.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: centos:7
  Name: ""
  Platform: ""
  SourceCode: FROM centos:7
