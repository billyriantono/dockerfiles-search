MetaArgs: null
Stages:
- BaseName: python:2.7.16-alpine3.10
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"rob@bitniftee.com"'
    Name: label
  - Key: GOOGLE_SDK_VERSION
    Name: arg
    Value: 263.0.0
  - Key: TERRAFORM_VERSION
    Name: arg
    Value: 0.12.9
  - Key: HELM_VERSION
    Name: arg
    Value: '"v2.14.3"'
  - Key: ANSIBLE_VERSION
    Name: arg
    Value: 2.7.12
  - Key: APP_USER
    Name: arg
    Value: googterrahelm
  - Key: WORKING_DIRECTORY
    Name: arg
    Value: /home/${APP_USER}
  - CmdLine:
    - mkdir -p ${WORKING_DIRECTORY}/bin &&     addgroup -g 1001 ${APP_USER} &&     adduser
      -u 1001 -D ${APP_USER} -G ${APP_USER} &&     chown -R ${APP_USER}:${APP_USER}
      ${WORKING_DIRECTORY}
    Name: run
    PrependShell: true
  - Name: workdir
    Path: ${WORKING_DIRECTORY}
  - CmdLine:
    - 'echo "****** Install system dependencies ******" &&     apk update && apk upgrade
      &&     apk add --no-cache tar wget openssl ca-certificates &&     apk add --update
      --virtual ansible-build-deps libffi-dev openssl-dev build-base &&     echo "******
      Building Ansible: ${ANSIBLE_VERSION} ******" &&     pip install ansible==${ANSIBLE_VERSION}
      &&     echo "****** Remove unused system librabies ******" &&     apk del ansible-build-deps
      && rm -rf /var/cache/apk/* &&     mkdir -p /etc/ansible &&     echo -e "[local]\nlocalhost
      ansible_connection=local" > /etc/ansible/hosts'
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: ${WORKING_DIRECTORY}/bin:${WORKING_DIRECTORY}/google-cloud-sdk/bin:$PATH
    Name: env
  - Env:
    - Key: CLOUDSDK_PYTHON_SITEPACKAGES
      Value: "1"
    Name: env
  - Name: user
    User: ${APP_USER}
  - CmdLine:
    - 'echo "****** Building Google Cloud: ${GOOGLE_SDK_VERSION}} ******" &&     wget
      https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-${GOOGLE_SDK_VERSION}-linux-x86_64.tar.gz
      &&     tar -zxvf google-cloud-sdk-${GOOGLE_SDK_VERSION}-linux-x86_64.tar.gz
      &&     rm google-cloud-sdk-${GOOGLE_SDK_VERSION}-linux-x86_64.tar.gz &&     google-cloud-sdk/install.sh         --usage-reporting=false
      --path-update=true          --bash-completion=true --rc-path=${WORKING_DIRECTORY}/.bashrc         --additional-components
      kubectl &&     google-cloud-sdk/bin/gcloud config set --installation component_manager/disable_update_check
      true &&     echo "****** Building Terraform: ${TERRAFORM_VERSION} ******" &&     wget
      https://releases.hashicorp.com/terraform/${TERRAFORM_VERSION}/terraform_${TERRAFORM_VERSION}_linux_amd64.zip
      &&     unzip terraform_${TERRAFORM_VERSION}_linux_amd64.zip -d ${WORKING_DIRECTORY}/bin
      &&     rm -f terraform_${TERRAFORM_VERSION}_linux_amd64.zip &&     echo "******
      Building Helm: ${HELM_VERSION} ******" &&     wget https://storage.googleapis.com/kubernetes-helm/helm-${HELM_VERSION}-linux-amd64.zip
      &&     unzip helm-${HELM_VERSION}-linux-amd64.zip &&     mv ./linux-amd64/helm
      ${WORKING_DIRECTORY}/bin/helm &&     rm -f helm-${HELM_VERSION}-linux-amd64.zip'
    Name: run
    PrependShell: true
  From:
    Image: python:2.7.16-alpine3.10
  Name: ""
  Platform: ""
  SourceCode: FROM python:2.7.16-alpine3.10
