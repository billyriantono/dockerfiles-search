MetaArgs: null
Stages:
- BaseName: centos/systemd
  Commands:
  - Maintainer: spam@chabin.eu
    Name: maintainer
  - CmdLine:
    - yum install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - yum install -y https://mirror.webtatic.com/yum/el7/webtatic-release.rpm
    Name: run
    PrependShell: true
  - CmdLine:
    - yum install -y httpd mod_php71w php71w-common php71w-mysql php71w-gd php71w-mbstring
      php71w-soap php71w-intl php71w-opcache php71w-xml php71w-xmlrpc php71w-cli
    Name: run
    PrependShell: true
  - CmdLine:
    - yum install -y telnet mariadb mc
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "short_open_tag = On" >> /etc/php.ini; echo "memory_limit = 384M" >> /etc/php.ini;
      echo "date.timezone = Europe/Warsaw" >> /etc/php.ini; echo "expose_php = Off"
      >> /etc/php.ini
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "post_max_size = 128M" >> /etc/php.ini; echo "upload_max_filesize = 128M"
      >> /etc/php.ini
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "max_execution_time = 240" >> /etc/php.ini
    Name: run
    PrependShell: true
  - CmdLine:
    - systemctl enable httpd.service
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - apache/moodle.conf
    - /etc/httpd/conf.d/moodle.conf
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - mysql/*
    - /tmp/
  - CmdLine:
    - ln -s /www/moodle/ /var/www/html/moodle
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /www
  - Name: volume
    Volumes:
    - /data
  - Name: volume
    Volumes:
    - /var/log/httpd/
  - Name: expose
    Ports:
    - "80"
  - CmdLine:
    - /usr/sbin/init
    Name: cmd
    PrependShell: false
  From:
    Image: centos/systemd
  Name: ""
  Platform: ""
  SourceCode: FROM centos/systemd
