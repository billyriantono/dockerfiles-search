MetaArgs: null
Stages:
- BaseName: node:10-alpine
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"O: University of Halle (Saale) Germany; OU: ITZ, department application
        systems"'
    - Key: license
      Value: '"Docker composition: MIT; Components: Please check"'
    Name: label
  - Key: BUILD_NO
    Name: arg
    Value: null
  - Env:
    - Key: ILIAS_REPO
      Value: '"https://github.com/ILIAS-eLearning/ILIAS.git"'
    - Key: ILIAS_TAG_OR_BRANCH
      Value: '"v5.3.12"'
    - Key: ILIAS_RUN_USER
      Value: '"ilias"'
    - Key: ILIAS_RUN_GROUP
      Value: '"ilias"'
    - Key: ILIAS_RUN_UID
      Value: '"800"'
    - Key: ILIAS_RUN_GID
      Value: '"800"'
    - Key: ILIAS_CHAT_HOME
      Value: '"/opt/chat"'
    - Key: ILIAS_CHAT_CONFIG_DIR
      Value: '"/etc/chat"'
    - Key: ILIAS_CHAT_LOG_DIR
      Value: '"/var/log/chat"'
    - Key: ILIAS_CHAT_PORT
      Value: '"27019"'
    - Key: GOSU_VERSION
      Value: '"1.11"'
    Name: env
  - CmdLine:
    - apk add --no-cache       git gnupg       bash openssl curl tini     && set -ex     &&
      for key in       B42F6819007F00F88E364FD4036A9C25BF357DD4       ; do         gpg
      --batch --keyserver pgp.mit.edu --recv-keys "$key" ||         gpg --batch --keyserver
      ha.pool.sks-keyservers.net --recv-keys "$key" ||         gpg --batch --keyserver
      keyserver.ubuntu.com --recv-keys "$key" ||         gpg --batch --keyserver keyserver.pgp.com
      --recv-keys "$key" ||         gpg --batch --keyserver ha.pool.sks-keyservers.net
      --recv-keys "$key" ;       done     && set +x     && curl -o /usr/local/bin/gosu
      -fSL "https://github.com/tianon/gosu/releases/download/${GOSU_VERSION}/gosu-amd64"     &&
      curl -o /usr/local/bin/gosu.asc -fSL "https://github.com/tianon/gosu/releases/download/${GOSU_VERSION}/gosu-amd64.asc"     &&
      gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu     && rm /usr/local/bin/gosu.asc     &&
      chmod +x /usr/local/bin/gosu     && cd /tmp     && git clone       -b "${ILIAS_TAG_OR_BRANCH}"       --single-branch       --depth=1       "${ILIAS_REPO}"     &&
      mv ./ILIAS/Modules/Chatroom/chat "${ILIAS_CHAT_HOME}"     && mv ./ILIAS/Modules/Chatroom/README.md
      "${ILIAS_CHAT_HOME}"     && rm -rf ./ILIAS     && addgroup -S -g "${ILIAS_RUN_GID}"
      "${ILIAS_RUN_GROUP}"     && adduser -S -D -H -G "${ILIAS_RUN_GROUP}" -h "${ILIAS_CHAT_HOME}"
      -u "${ILIAS_RUN_UID}" "${ILIAS_RUN_USER}"     && apk del git gnupg
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - assets/*
    - /
  - Name: workdir
    Path: '"${ILIAS_CHAT_HOME}"'
  - Name: volume
    Volumes:
    - ${ILIAS_CHAT_CONFIG_DIR}
    - ${ILIAS_CHAT_LOG_DIR}
  - Name: expose
    Ports:
    - '"${ILIAS_CHAT_PORT}"'
  - Health:
      Interval: 7000000000
      StartPeriod: 15000000000
      Test:
      - CMD-SHELL
      - /docker-healthcheck.sh
      Timeout: 5000000000
    Name: healthcheck
  - CmdLine:
    - tini
    - --
    - /docker-entrypoint.sh
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - app:serve
    Name: cmd
    PrependShell: false
  From:
    Image: node:10-alpine
  Name: ""
  Platform: ""
  SourceCode: FROM node:10-alpine
