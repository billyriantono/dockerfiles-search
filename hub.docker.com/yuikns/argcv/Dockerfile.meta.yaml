MetaArgs: null
Stages:
- BaseName: fedora:latest
  Commands:
  - CmdLine:
    - dnf update -y &&   dnf install openssh* wget bzip2 unzip git which gcc-c++     java-1.8.0-openjdk
      java-1.8.0-openjdk-devel     patch file -y &&   dnf clean all
    Name: run
    PrependShell: true
  - CmdLine:
    - ssh-keygen -A
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /var/run/sshd
    Name: run
    PrependShell: true
  - CmdLine:
    - echo 'root:youjumpijump' | chpasswd
    Name: run
    PrependShell: true
  - CmdLine:
    - sed 's@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g'
      -i /etc/pam.d/sshd
    Name: run
    PrependShell: true
  - Env:
    - Key: NOTVISIBLE
      Value: '"in users profile"'
    Name: env
  - CmdLine:
    - echo "export VISIBLE=now" >> /etc/profile
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "export JAVA_HOME=/usr/lib/jvm/java" >> /etc/profile
    Name: run
    PrependShell: true
  - Env:
    - Key: BAZEL_VERSION
      Value: 0.23.1
    Name: env
  - CmdLine:
    - wget https://github.com/bazelbuild/bazel/releases/download/${BAZEL_VERSION}/bazel-${BAZEL_VERSION}-installer-linux-x86_64.sh          -O
      bazel.sh &&          chmod +x bazel.sh &&          ./bazel.sh &&          rm
      -rf bazel.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -sf /usr/local/lib/bazel/bin/bazel-complete.bash /etc/bash_completion.d/
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh         -O
      miniconda.sh &&         chmod +x miniconda.sh &&         ./miniconda.sh -b -p
      /usr/mc &&         rm -rf miniconda.sh
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: /usr/mc/bin:$PATH
    Name: env
  - CmdLine:
    - echo 'export PATH=/usr/mc/bin:$PATH' >> /etc/profile
    Name: run
    PrependShell: true
  - CmdLine:
    - conda install --yes numpy
    Name: run
    PrependShell: true
  - Env:
    - Key: DOCKER_FRONTEND
      Value: '"noninteractive"'
    Name: env
  - Env:
    - Key: ARGCV_SRC_DIR
      Value: /src/argcv
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - ${ARGCV_SRC_DIR}
  - Name: workdir
    Path: ${ARGCV_SRC_DIR}
  - CmdLine:
    - bazel build //... && bazel clean
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "22"
  - CmdLine:
    - /usr/sbin/sshd
    - -D
    Name: cmd
    PrependShell: false
  From:
    Image: fedora:latest
  Name: ""
  Platform: ""
  SourceCode: FROM fedora:latest
