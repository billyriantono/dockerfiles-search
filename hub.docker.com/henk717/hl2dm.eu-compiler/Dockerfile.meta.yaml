MetaArgs: null
Stages:
- BaseName: debian:stretch
  Commands:
  - Labels:
    - Key: maintainer
      Value: rays3t
    Name: label
  - Labels:
    - Key: version
      Value: '"1.2.2"'
    Name: label
  - Labels:
    - Key: description
      Value: '"A docker container based on debian/stretch for building sourcemod plugins
        (.sp).This is intended to be used in an CI environment like GitLab. It also
        adds a little wrapper script for the spcomp that abstracts the sourcemod libs
        from your plugin ones"'
    Name: label
  - CmdLine:
    - groupadd -r smbuild
    Name: run
    PrependShell: true
  - CmdLine:
    - useradd -m -r -g smbuild smuser
    Name: run
    PrependShell: true
  - CmdLine:
    - dpkg --add-architecture i386
    Name: run
    PrependShell: true
  - CmdLine:
    - apt update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt install -y git wget zip tar libc6:i386 lib32z1 lib32z1-dev libc6-dev-i386
      libc6-i386 curl p7zip-full
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - compile.sh
    - /home/smuser/compile.sh
  - CmdLine:
    - chmod 755 /home/smuser/compile.sh && ln -s /home/smuser/compile.sh /usr/bin/spcomp
    Name: run
    PrependShell: true
  - Name: user
    User: smuser
  - Name: workdir
    Path: /home/smuser
  - CmdLine:
    - "BASE_SM_DL_URL=http://www.sourcemod.net/smdrop/1.8 && \tLATEST_SM_VERSION=`wget
      $BASE_SM_DL_URL/sourcemod-latest-linux -q -O -` && \techo Detected sourcemod
      version: $LATEST_SM_VERSION && \twget -qO sourcemod.tar.gz $BASE_SM_DL_URL/$LATEST_SM_VERSION"
    Name: run
    PrependShell: true
  - CmdLine:
    - "mkdir sourcemod && \ttar xvzf sourcemod.tar.gz -C sourcemod"
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /home/smuser/build
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /home/smuser/build
  From:
    Image: debian:stretch
  Name: ""
  Platform: ""
  SourceCode: FROM debian:stretch
