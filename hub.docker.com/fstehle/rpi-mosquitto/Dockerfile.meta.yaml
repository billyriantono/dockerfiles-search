MetaArgs: null
Stages:
- BaseName: gcc:7.3
  Commands:
  - Maintainer: Frederik Zahle <frza@dtu.dk>
    Name: maintainer
  - Env:
    - Key: SHELL
      Value: /bin/bash
    Name: env
  - Env:
    - Key: LD_LIBRARY_PATH
      Value: $LD_LIBRARY_PATH:/usr/local/lib
    Name: env
  - Env:
    - Key: CONDA_ENV_PATH
      Value: /opt/miniconda
    Name: env
  - Env:
    - Key: PATH
      Value: $CONDA_ENV_PATH/bin:$PATH
    Name: env
  - CmdLine:
    - apt-get update  && apt-get install --fix-missing -y -q     git-all     curl     build-essential
      libhdf5-dev  && apt-get autoremove -y  && apt-get clean -y
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://download.open-mpi.org/release/open-mpi/v3.1/openmpi-3.1.2.tar.gz   &&
      tar -xzf openmpi-3.1.2.tar.gz   && cd openmpi-3.1.2   && ./configure --prefix=/usr/local   &&
      make all install
    Name: run
    PrependShell: true
  - CmdLine:
    - wget --quiet     https://repo.continuum.io/miniconda/Miniconda-latest-Linux-x86_64.sh
      &&     bash Miniconda-latest-Linux-x86_64.sh -b -p $CONDA_ENV_PATH &&     rm
      Miniconda-latest-Linux-x86_64.sh &&     chmod -R a+rx $CONDA_ENV_PATH
    Name: run
    PrependShell: true
  - CmdLine:
    - conda update --quiet --yes conda   && conda create -y -n py37 python=3.7   &&
      conda create -y -n py35 python=3.5   && conda create -y -n py27 python=2.7   &&
      /bin/bash -c "source activate py27   && conda install pip numpy scipy nose hdf5"   &&
      /bin/bash -c "source activate py35   && conda install pip numpy scipy nose hdf5"   &&
      /bin/bash -c "source activate py37   && conda install pip numpy scipy nose hdf5"
    Name: run
    PrependShell: true
  - Env:
    - Key: PETSC_CONFIGURE_OPTIONS
      Value: '"--with-shared-libraries --with-fortran-interfaces=1 -with-fortran-bindings
        --with-fc=mpif90"'
    Name: env
  - CmdLine:
    - update-alternatives --install /usr/bin/cc cc /usr/local/bin/gcc 999   && update-alternatives
      --install /usr/bin/gfortran gfortran /usr/local/bin/gfortran 999   && apt-get
      install libblas-dev liblapack-dev -y   && /bin/bash -c "source activate py27   &&
      pip install --upgrade pip   && pip install Cython   && pip install coverage   &&
      pip install mpi4py   && pip install -v petsc==3.11   && pip install -v petsc4py==3.11"   &&
      /bin/bash -c "source activate py37   && pip install --upgrade pip   && pip install
      Cython   && pip install coverage   && pip install mpi4py   && pip install -v
      petsc==3.11   && pip install -v petsc4py==3.11"
    Name: run
    PrependShell: true
  - CmdLine:
    - echo 'ulimit -s unlimited' >> .bashrc
    Name: run
    PrependShell: true
  From:
    Image: gcc:7.3
  Name: ""
  Platform: ""
  SourceCode: FROM gcc:7.3
