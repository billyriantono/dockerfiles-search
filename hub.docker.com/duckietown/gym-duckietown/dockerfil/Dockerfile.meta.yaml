MetaArgs: null
Stages:
- BaseName: java:8-jre
  Commands:
  - Env:
    - Key: WEB_SER_NAME
      Value: apache-tomcat-8.0.28
    Name: env
  - Env:
    - Key: BACKEND_HOME
      Value: /usr/atwork
    Name: env
  - Env:
    - Key: WEB_SER_PATH
      Value: /usr/share
    Name: env
  - Env:
    - Key: CONFIG_NAME
      Value: config.sh
    Name: env
  - Env:
    - Key: PACKAGE_NAME
      Value: atwork.war
    Name: env
  - Env:
    - Key: PROJECT_NAME
      Value: atwork
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - $BACKEND_HOME
  - Name: workdir
    Path: $BACKEND_HOME
  - CmdLine:
    - tar xf $BACKEND_HOME/$WEB_SER_NAME.tar.gz -C $WEB_SER_PATH
    Name: run
    PrependShell: true
  - CmdLine:
    - rm -rf $WEB_SER_PATH/$WEB_SER_NAME/webapps/*
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir $WEB_SER_PATH/$WEB_SER_NAME/webapps/$PROJECT_NAME
    Name: run
    PrependShell: true
  - CmdLine:
    - unzip atwork.war -d  $WEB_SER_PATH/$WEB_SER_NAME/webapps/atwork
    Name: run
    PrependShell: true
  - CmdLine:
    - cp -f $BACKEND_HOME/$CONFIG_NAME $WEB_SER_PATH/$WEB_SER_NAME/webapps/$PROJECT_NAME/WEB-INF/classes
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "8080"
  - CmdLine:
    - /bin/bash
    - /usr/atwork/start.sh
    Name: cmd
    PrependShell: false
  From:
    Image: java:8-jre
  Name: ""
  Platform: ""
  SourceCode: FROM java:8-jre
