MetaArgs: null
Stages:
- BaseName: alpine:3.9
  Commands:
  - Labels:
    - Key: Maintainer
      Value: '"Craig Manley https://github.com/cmanley"'
    - Key: Description
      Value: '"GitList (an elegant git repository viewer) using nginx, php-fpm 7.2,
        and Alpine Linux 3.9"'
    Name: label
  - CmdLine:
    - "apk update && apk --no-cache add \tgit \tnginx \tphp7 \tphp7-ctype \tphp7-fpm
      \tphp7-json \tphp7-mbstring \tphp7-simplexml \tsupervisor"
    Name: run
    PrependShell: true
  - Key: REPOSITORY_ROOT
    Name: arg
    Value: /repos
  - Key: REPOSITORY_DUMMY
    Name: arg
    Value: $REPOSITORY_ROOT/If_you_see_this_then_the_host_volume_was_not_mounted
  - CmdLine:
    - "mkdir -p \"$REPOSITORY_DUMMY\" \t&& git --bare init \"$REPOSITORY_DUMMY\""
    Name: run
    PrependShell: true
  - Key: GITLIST_DOWNLOAD_FILENAME
    Name: arg
    Value: '''gitlist-1.0.2.tar.gz'''
  - Key: GITLIST_DOWNLOAD_URL
    Name: arg
    Value: '"https://github.com/klaussilveira/gitlist/releases/download/1.0.2/$GITLIST_DOWNLOAD_FILENAME"'
  - Key: GITLIST_DOWNLOAD_SHA256
    Name: arg
    Value: 38728b688f6600ad97b6d5900b472da6529ff7f3b8c0669ada25ae0bb65d34d9
  - CmdLine:
    - "NEED='wget'; \tDEL='' \t&& for x in $NEED; do \t\tif [ $(apk list \"$x\" |
      grep -F [installed] | wc -l) -eq 0 ]; then \t\t\tDEL=\"$DEL $x\" \t\t\t&& echo
      \"Add temporary package $x\" \t\t\t&& apk --no-cache add $x; \t\tfi; \tdone
      \t&& cd /var/www \t&& wget -q \"$GITLIST_DOWNLOAD_URL\" -O \"$GITLIST_DOWNLOAD_FILENAME\"
      \t&& sha256sum \"$GITLIST_DOWNLOAD_FILENAME\" \t&& echo \"$GITLIST_DOWNLOAD_SHA256
      \ $GITLIST_DOWNLOAD_FILENAME\" | sha256sum -c - \t&& tar -xf \"$GITLIST_DOWNLOAD_FILENAME\"
      \t&& rm \"$GITLIST_DOWNLOAD_FILENAME\" \t&& if [ -n \"$DEL\" ]; then echo \"Delete
      temporary package(s) $DEL\" && apk del $DEL; fi \t&& mkdir -p gitlist/cache
      \t&& chmod a+trwx gitlist/cache;"
    Name: run
    PrependShell: true
  - CmdLine:
    - "cd /var/www/gitlist/themes \t&& cp -al bootstrap3 bootstrap3-wide \t&& rm bootstrap3-wide/css/style.css
      \t&& cp bootstrap3/css/style.css bootstrap3-wide/css/style.css \t&& sed -E -i
      -e 's/(@media ?\\(min-width:[0-9]+px\\)\\{\\.container\\{width:[0-9]+px\\}\\})+/.container{width:100%}/'
      bootstrap3-wide/css/style.css \t&& rm bootstrap3-wide/twig/commits_list.twig
      \t&& cp bootstrap3/twig/commits_list.twig bootstrap3-wide/twig/commits_list.twig
      \t&& sed -i -e 's/date(\"F j, Y\")/date(\"l, j F Y\")/' bootstrap3-wide/twig/commits_list.twig"
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - copy
    - /
  - Name: expose
    Ports:
    - "80"
  - CmdLine:
    - /docker-entrypoint.sh
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - gitlist
    Name: cmd
    PrependShell: false
  From:
    Image: alpine:3.9
  Name: ""
  Platform: ""
  SourceCode: FROM alpine:3.9
