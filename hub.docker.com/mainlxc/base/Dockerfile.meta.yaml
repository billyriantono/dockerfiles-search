MetaArgs: null
Stages:
- BaseName: mainlxc/ubuntu
  Commands:
  - Maintainer: Asokani "https://github.com/asokani"
    Name: maintainer
  - CmdLine:
    - apt-get -y install postfix mailutils sqlite3 pwgen
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - acme_tiny.py
    - /opt/acme_tiny.py
  - CmdLine:
    - mkdir -p /var/log/acme && chown :acme /var/log/acme
    Name: run
    PrependShell: true
  - CmdLine:
    - "mkdir -p /var/app-cert/.well-known/acme-challenge && \tchown acme:www-user
      /var/app-cert/.well-known/acme-challenge && \tchmod 750 /var/app-cert/.well-known/acme-challenge"
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - letsencrypt-startup.sh
    - /etc/my_init.d/20-letsencrypt
  - Chown: ""
    Name: add
    SourcesAndDest:
    - letsencrypt-cron.sh
    - /etc/cron.weekly/letsencrypt
  - CmdLine:
    - sed -i 's/relayhost =/relayhost = mailserver/g' /etc/postfix/main.cf
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i 's/\/etc\/mailname,//g' /etc/postfix/main.cf
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "smtp_host_lookup = native\n" >> /etc/postfix/main.cf
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /etc/service/postfix
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - postfix.sh
    - /etc/service/postfix/run
  - Name: expose
    Ports:
    - "22"
  - CmdLine:
    - /sbin/my_init
    Name: cmd
    PrependShell: false
  From:
    Image: mainlxc/ubuntu
  Name: ""
  Platform: ""
  SourceCode: FROM mainlxc/ubuntu
