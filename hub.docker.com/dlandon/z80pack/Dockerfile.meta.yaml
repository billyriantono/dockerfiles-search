MetaArgs: null
Stages:
- BaseName: phusion/baseimage:0.11
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"dlandon"'
    Name: label
  - Env:
    - Key: DEBCONF_NONINTERACTIVE_SEEN
      Value: '"true"'
    - Key: DEBIAN_FRONTEND
      Value: '"noninteractive"'
    - Key: DISABLE_SSH
      Value: '"true"'
    - Key: HOME
      Value: '"/root"'
    - Key: LC_ALL
      Value: '"C.UTF-8"'
    - Key: LANG
      Value: '"en_US.UTF-8"'
    - Key: LANGUAGE
      Value: '"en_US.UTF-8"'
    - Key: TZ
      Value: '"Etc/UTC"'
    - Key: TERM
      Value: '"xterm"'
    Name: env
  - Env:
    - Key: Z80PACK_VERS
      Value: '"1.36"'
    - Key: CPMTOOLS_VERS
      Value: '"2.20"'
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - init
    - /etc/my_init.d/
  - CmdLine:
    - rm -rf /etc/service/cron /etc/service/syslog-ng
    Name: run
    PrependShell: true
  - CmdLine:
    - "apt-get update && \tapt-get -y dist-upgrade -o Dpkg::Options::=\"--force-confold\"
      && \tapt-get -y upgrade -o Dpkg::Options::=\"--force-confold\" && \tapt-get
      -y install wget tzdata make gcc nano sudo && \tapt-get -y install libncurses5-dev
      libncursesw5-dev && \twget http://archive.ubuntu.com/ubuntu/pool/universe/s/shellinabox/shellinabox_2.14-1_amd64.deb
      && \tdpkg -i shellinabox_2.14-1_amd64.deb"
    Name: run
    PrependShell: true
  - CmdLine:
    - "cd ~ && \twget http://www.autometer.de/unix4fun/z80pack/ftp/z80pack-$Z80PACK_VERS.tgz
      && \ttar xzvf z80pack-$Z80PACK_VERS.tgz && \tmv z80pack-$Z80PACK_VERS z80pack\t&&
      \trm z80pack-$Z80PACK_VERS.tgz"
    Name: run
    PrependShell: true
  - CmdLine:
    - "cd ~/z80pack/cpmsim/srcsim && \tmake -fMakefile.linux && \tmake -fMakefile.linux
      clean"
    Name: run
    PrependShell: true
  - CmdLine:
    - "cd ~/z80pack/cpmsim/srctools && \tsed -i \"s/\"#INSTALLDIR=\"/\"INSTALLDIR=/\"\"
      Makefile && \tmake && \tmake install && \tmake clean"
    Name: run
    PrependShell: true
  - CmdLine:
    - "cd ~ && \twget http://www.moria.de/~michael/cpmtools/files/cpmtools-$CPMTOOLS_VERS.tar.gz
      && \ttar xzvf cpmtools-$CPMTOOLS_VERS.tar.gz && \tmv cpmtools-$CPMTOOLS_VERS
      cpmtools && \tcd cpmtools && \t./configure && make && make install && \tcd ~
      && \trm cpmtools-$CPMTOOLS_VERS.tar.gz && \trm -r cpmtools"
    Name: run
    PrependShell: true
  - CmdLine:
    - "cd ~/z80pack/cpmsim/disks/library && \tcp -p * ../backups"
    Name: run
    PrependShell: true
  - CmdLine:
    - "sed -i s#SHELL=/bin/sh#SHELL=/bin/bash#g /etc/default/useradd && \tuseradd
      -d \"/root/z80pack/cpmsim\" \"vintage\" && \tadduser \"vintage\" sudo && \techo
      \"vintage:computer\" | chpasswd"
    Name: run
    PrependShell: true
  - CmdLine:
    - "mv \"/etc/shellinabox/options-enabled/00+Black on White.css\" \"/etc/shellinabox/options-enabled/00_Black
      on White.css\" && \tmv \"/etc/shellinabox/options-enabled/00_White On Black.css\"
      \"/etc/shellinabox/options-enabled/00+White On Black.css\""
    Name: run
    PrependShell: true
  - CmdLine:
    - "apt-get -y remove wget make gcc libncurses5-dev libncursesw5-dev && \tapt-mark
      hold shellinabox && \tapt-get clean -y && \tapt-get -y autoremove && \trm -rf
      /tmp/* /var/tmp/* && \tchmod +x /etc/my_init.d/*.sh"
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /config
  - Name: expose
    Ports:
    - "4200"
  - CmdLine:
    - /sbin/my_init
    Name: cmd
    PrependShell: false
  From:
    Image: phusion/baseimage:0.11
  Name: ""
  Platform: ""
  SourceCode: FROM phusion/baseimage:0.11
