MetaArgs: null
Stages:
- BaseName: ubuntu:18.04
  Commands:
  - Maintainer: Daniel Agar <daniel@agar.ca>
    Name: maintainer
  - Key: QT_VERSION
    Name: arg
    Value: 5.12.6
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - Env:
    - Key: DISPLAY
      Value: :99
    Name: env
  - Env:
    - Key: QMAKESPEC
      Value: linux-g++-64
    Name: env
  - Env:
    - Key: QT_PATH
      Value: /opt/Qt
    Name: env
  - Env:
    - Key: QT_DESKTOP
      Value: $QT_PATH/${QT_VERSION}/gcc_64
    Name: env
  - Env:
    - Key: PATH
      Value: /usr/lib/ccache:$QT_DESKTOP/bin:$PATH
    Name: env
  - CmdLine:
    - "apt-get update && apt-get -y --quiet --no-install-recommends install \t\tapt-utils
      \t\tbuild-essential \t\tca-certificates \t\tccache \t\tcheckinstall \t\tcmake
      \t\tcurl \t\tespeak \t\tfuse \t\tg++ \t\tgcc \t\tgit \t\tgosu \t\tkmod \t\tlibespeak-dev
      \t\tlibfontconfig1 \t\tlibfuse2 \t\tlibgstreamer-plugins-base1.0-dev \t\tlibgstreamer1.0-0:amd64
      \t\tlibgstreamer1.0-dev \t\tlibsdl2-dev \t\tlibssl-dev \t\tlibudev-dev \t\tlocales
      \t\tmake \t\tninja-build \t\topenssh-client \t\topenssl \t\tpkg-config \t\trsync
      \t\tsnapcraft \t\tspeech-dispatcher \t\twget \t\txvfb \t\tzlib1g-dev \t&& apt-get
      -y autoremove \t&& apt-get clean autoclean \t&& rm -rf /var/lib/apt/lists/{apt,dpkg,cache,log}
      /tmp/* /var/tmp/*"
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - scripts/extract-qt-installer.sh
    - /tmp/qt/
  - CmdLine:
    - "curl -Lo /tmp/qt/installer.run \"https://download.qt.io/archive/qt/$(echo \"${QT_VERSION}\"
      | cut -d. -f 1-2)/${QT_VERSION}/qt-opensource-linux-x64-${QT_VERSION}.run\"
      \t&& QT_PACKAGE_VER=$(echo \"${QT_VERSION}\" | tr -d .) QT_CI_PACKAGES=qt,qt.qt5.${QT_PACKAGE_VER},qt.qt5.${QT_PACKAGE_VER}.gcc_64,qt.qt5.${QT_PACKAGE_VER}.qtcharts,qt.qt5.${QT_PACKAGE_VER}.qtvirtualkeyboard,qt.qt5.${QT_PACKAGE_VER}.qtnetworkauth
      /tmp/qt/extract-qt-installer.sh /tmp/qt/installer.run \"$QT_PATH\" \t&& find
      \"${QT_PATH}\" -mindepth 1 -maxdepth 1 ! -name \"${QT_VERSION}\" -exec echo
      'Cleaning Qt SDK: {}' \\; -exec rm -r '{}' \\; \t&& rm -rf /tmp/*"
    Name: run
    PrependShell: true
  - CmdLine:
    - locale-gen en_US.UTF-8 && dpkg-reconfigure locales
    Name: run
    PrependShell: true
  - CmdLine:
    - cd /usr/local/src/     && sudo wget https://www.openssl.org/source/openssl-1.1.1c.tar.gz     &&
      tar -xf openssl-1.1.1c.tar.gz     && cd openssl-1.1.1c     && ./config --prefix=/usr/local/ssl
      --openssldir=/usr/local/ssl shared zlib     && make     && make install     &&
      mkdir -p ${QT_PATH}/Tools/OpenSSL/binary/lib/ && cp -f /usr/local/ssl/lib/libcrypto.so.1.1
      ${QT_PATH}/Tools/OpenSSL/binary/lib/     && cp -f /usr/local/ssl/lib/libssl.so.1.1
      ${QT_PATH}/Tools/OpenSSL/binary/lib/     && cd .. && rm -rf openssl-1.1.1c.tar.gz
      && rm -rf openssl-1.1.1c
    Name: run
    PrependShell: true
  - CmdLine:
    - useradd --shell /bin/bash -u 1001 -c "" -m user && usermod -a -G dialout user
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - scripts/entrypoint.sh
    - /usr/local/bin/entrypoint.sh
  - CmdLine:
    - /usr/local/bin/entrypoint.sh
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - /bin/bash
    Name: cmd
    PrependShell: false
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: teletype
    Name: env
  From:
    Image: ubuntu:18.04
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:18.04
