MetaArgs: null
Stages:
- BaseName: elasticsearch:2.4.1
  Commands:
  - Maintainer: lmangani <lorenzo.mangani@gmail.com>
    Name: maintainer
  - CmdLine:
    - groupadd -r kibi && useradd -r -m -g kibi kibi
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update && apt-get clean  && wget -O /dumb-init https://github.com/Yelp/dumb-init/releases/download/v1.1.3/dumb-init_1.1.3_amd64  &&
      chmod +x /dumb-init  && curl -sL https://deb.nodesource.com/setup_4.x | bash
      -  && apt-get install -y nodejs  && /usr/share/elasticsearch/bin/plugin install
      solutions.siren/siren-join/2.4.1  && apt-get autoremove  && rm -rf /var/lib/apt/lists/*
      /tmp/* /var/tmp/*
    Name: run
    PrependShell: true
  - CmdLine:
    - cd /opt && wget https://download.support.siren.solutions/kibi/community?file=kibi-community-standalone-4.6.4-1-linux-x64.zip
      -O kibi-community-standalone-4.6.4-1-linux-x64.zip  && unzip kibi-community-standalone-4.6.4-1-linux-x64.zip  &&
      rm -rf /opt/kibi-community-standalone-4.6.4-1-linux-x64.zip  && mv kibi-community-standalone-4.6.4-1-linux-x64
      kibi  && chown -R kibi:kibi /opt/kibi  && chown -R elasticsearch:elasticsearch
      /var/lib/elasticsearch/
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - entrypoint.sh
    - /opt/
  - CmdLine:
    - chmod 755 /opt/entrypoint.sh
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: /opt/kibi/kibi/bin:$PATH
    Name: env
  - Name: expose
    Ports:
    - "5601"
    - "5606"
  - Name: expose
    Ports:
    - "9200"
  - Name: expose
    Ports:
    - "9300"
  - Name: expose
    Ports:
    - "8899"
  - CmdLine:
    - /dumb-init
    - --
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - /opt/entrypoint.sh
    Name: cmd
    PrependShell: false
  From:
    Image: elasticsearch:2.4.1
  Name: ""
  Platform: ""
  SourceCode: FROM elasticsearch:2.4.1
