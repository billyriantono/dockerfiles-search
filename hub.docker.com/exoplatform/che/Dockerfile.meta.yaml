MetaArgs: null
Stages:
- BaseName: exoplatform/exo-community:4.3
  Commands:
  - Maintainer: GREAU Maxime <mgreau+docker@exoplatform.com>
    Name: maintainer
  - Name: user
    User: root
  - Env:
    - Key: LANG
      Value: C.UTF-8
    Name: env
  - Env:
    - Key: EXO_CHE_CONF_URL
      Value: https://raw.githubusercontent.com/exo-docker/exo-che/master/base-che
    Name: env
  - Env:
    - Key: MAVEN_VERSION
      Value: 3.2.5
    Name: env
  - Env:
    - Key: M2_HOME
      Value: /home/${EXO_USER}/apache-maven-$MAVEN_VERSION
    Name: env
  - Env:
    - Key: PATH
      Value: $JAVA_HOME/bin:$M2_HOME/bin:$PATH
    Name: env
  - CmdLine:
    - add-apt-repository ppa:git-core/ppa &&   apt-get update &&   sudo apt-get install
      git -y &&   apt-get -qq -y autoremove &&   apt-get -qq -y clean &&   rm -rf
      /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir /home/${EXO_USER}/apache-maven-$MAVEN_VERSION &&   wget -qO- "http://apache.ip-connect.vn.ua/maven/maven-3/$MAVEN_VERSION/binaries/apache-maven-$MAVEN_VERSION-bin.tar.gz"
      | tar -zx --strip-components=1 -C /home/exo/apache-maven-$MAVEN_VERSION/
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "export JAVA_HOME=$JAVA_HOME\nexport M2_HOME=/home/exo/apache-maven-$MAVEN_VERSION\nexport
      PATH=$JAVA_HOME/bin:$M2_HOME/bin:$PATH" >> /home/exo/.bashrc
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /home/${EXO_USER}/.m2/repository && chown ${EXO_USER}:${EXO_USER} /home/${EXO_USER}/.m2/repository
      &&     curl -L -o /home/${EXO_USER}/.m2/settings.xml ${EXO_CHE_CONF_URL}/m2-settings.xml
      &&     chown ${EXO_USER}:${EXO_USER} /home/${EXO_USER}/.m2/settings.xml &&     curl
      -L -o ${EXO_CONF_DIR}/exo.properties ${EXO_CHE_CONF_URL}/exo-sample.properties
      &&     chown ${EXO_USER}:${EXO_USER} ${EXO_CONF_DIR}/exo.properties
    Name: run
    PrependShell: true
  - Name: user
    User: ${EXO_USER}
  - CmdLine:
    - git clone https://github.com/exoplatform/task.git /home/${EXO_USER}/tmp &&      mvn
      -f /home/${EXO_USER}/tmp/ install -DskipTests &&      for x in `find "/home/${EXO_USER}/.m2/repository"
      -name '*-SNAPSHOT*'`; do rm -rf "$x"; done &&      rm -rf /home/${EXO_USER}/tmp
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "22"
    - "4403"
    - "8000"
    - "8080"
    - "9876"
  - CmdLine:
    - sudo /usr/sbin/sshd -D &&     tail -f /dev/null
    Name: cmd
    PrependShell: true
  From:
    Image: exoplatform/exo-community:4.3
  Name: ""
  Platform: ""
  SourceCode: FROM       exoplatform/exo-community:4.3
