MetaArgs: null
Stages:
- As: buildstage
  BaseName: maven
  Commands:
  - CmdLine:
    - git clone https://github.com/mysinmyc/sampleapp1.git
    Name: run
    PrependShell: true
  - CmdLine:
    - "cd sampleapp1 \t&& echo \"git.version=$(git describe --tags)\"  > frontend/src/main/resources/static/version.properties
      \t&& mvn versions:set -DnewVersion=$(git describe --tags) \t&& mvn -Pproduction-mode,mariadb
      -Dmaven.test.skip=true package"
    Name: run
    PrependShell: true
  From:
    Image: maven
  Name: buildstage
  Platform: ""
  SourceCode: FROM maven as buildStage
- BaseName: openjdk:8
  Commands:
  - Name: expose
    Ports:
    - "8080"
  - Chown: ""
    From: buildStage
    Name: copy
    SourcesAndDest:
    - /sampleapp1/frontend/target/frontend*.jar
    - /
  - Chown: ""
    Name: add
    SourcesAndDest:
    - entrypoint.sh
    - /
  - Env:
    - Key: APPUSERS_PASSWORD
      Value: t0polino
    Name: env
  - Env:
    - Key: JAVA_ADDITIONALARGS
      Value: '"-Dvaadin.productionMode=true"'
    Name: env
  - CmdLine:
    - sh
    - /entrypoint.sh
    Name: cmd
    PrependShell: false
  From:
    Image: openjdk:8
  Name: ""
  Platform: ""
  SourceCode: FROM openjdk:8
