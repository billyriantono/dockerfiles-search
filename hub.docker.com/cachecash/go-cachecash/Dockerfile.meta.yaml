MetaArgs: null
Stages:
- As: build
  BaseName: cachecash/go-cachecash-build:latest
  Commands:
  - Name: workdir
    Path: $GOPATH/src/github.com/cachecashproject/go-cachecash
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - .
  - CmdLine:
    - make PREFIX=/artifacts all
    Name: run
    PrependShell: true
  From:
    Image: cachecash/go-cachecash-build:latest
  Name: build
  Platform: ""
  SourceCode: FROM cachecash/go-cachecash-build:latest as build
- As: filebeat
  BaseName: docker.elastic.co/beats/filebeat:6.6.2
  Commands: null
  From:
    Image: docker.elastic.co/beats/filebeat:6.6.2
  Name: filebeat
  Platform: ""
  SourceCode: FROM docker.elastic.co/beats/filebeat:6.6.2 as filebeat
- BaseName: debian:buster
  Commands:
  - CmdLine:
    - "apt-get update \t&& apt-get install -y --no-install-recommends logrotate cron
      runit sqlite3 ca-certificates \t&& apt-get clean && rm -rf /var/lib/apt/lists/*
      /tmp/* /var/tmp/*"
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - deploy/omnibus-cache/our_init
    - /sbin/
  - CmdLine:
    - /sbin/our_init
    Name: cmd
    PrependShell: false
  - CmdLine:
    - mkdir /etc/service/filebeat
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - deploy/omnibus-cache/filebeat.sh
    - /etc/service/filebeat/run
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - deploy/omnibus-cache/filebeat.yml.tpl
    - /etc/filebeat.yml.tpl
  - CmdLine:
    - mkdir -p /etc/service/cron
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - deploy/omnibus-cache/cron.sh
    - /etc/service/cron/run
  - CmdLine:
    - mkdir -p /etc/service/cache/log
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - deploy/omnibus-cache/cache.sh
    - /etc/service/cache/run
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - deploy/omnibus-cache/cache.log.sh
    - /etc/service/cache/log/run
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - deploy/omnibus-cache/cache.log.config
    - /var/log/cachecash/cache/config
  - CmdLine:
    - mkdir -p /etc/service/publisher/log
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - deploy/omnibus-cache/publisher.sh
    - /etc/service/publisher/run
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - deploy/omnibus-cache/publisher.log.sh
    - /etc/service/publisher/log/run
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - deploy/omnibus-cache/publisher.log.config
    - /var/log/publishercash/publisher/config
  - Chown: ""
    From: filebeat
    Name: copy
    SourcesAndDest:
    - /usr/share/filebeat/filebeat
    - /usr/bin/
  - Chown: ""
    From: build
    Name: copy
    SourcesAndDest:
    - /artifacts/bin/*
    - /usr/local/bin/
  - Name: workdir
    Path: /data
  From:
    Image: debian:buster
  Name: ""
  Platform: ""
  SourceCode: FROM debian:buster
