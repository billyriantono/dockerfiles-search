MetaArgs: null
Stages:
- BaseName: php:7.2-apache
  Commands:
  - CmdLine:
    - apt-get update &&     apt-get install wget unzip libldap2-dev libsqlite3-dev
      libpq-dev -y &&     rm -rf /var/lib/apt/lists/* &&     docker-php-ext-configure
      ldap --with-libdir=lib/x86_64-linux-gnu/
    Name: run
    PrependShell: true
  - CmdLine:
    - docker-php-ext-install ldap pdo pdo_sqlite pdo_pgsql pdo_mysql    && a2enmod
      rewrite
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://github.com/YOURLS/YOURLS/archive/master.zip -O /tmp/YOURLS.zip
    Name: run
    PrependShell: true
  - CmdLine:
    - unzip /tmp/YOURLS.zip -d /tmp
    Name: run
    PrependShell: true
  - CmdLine:
    - mv /tmp/YOURLS-master/* /var/www/html/
    Name: run
    PrependShell: true
  - CmdLine:
    - rm /tmp/YOURLS* -R
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /var/www/html/user/plugins/db
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /var/www/html/user/plugins/ldap
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - plugin.php
    - /var/www/html/user/plugins/db/plugin.php
  - CmdLine:
    - wget https://raw.githubusercontent.com/k3a/yourls-ldap-plugin/master/plugin.php
      -O /var/www/html/user/plugins/ldap/plugin.php
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "80"
  From:
    Image: php:7.2-apache
  Name: ""
  Platform: ""
  SourceCode: FROM php:7.2-apache
