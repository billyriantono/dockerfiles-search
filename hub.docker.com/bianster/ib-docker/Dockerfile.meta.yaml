MetaArgs: null
Stages:
- BaseName: ubuntu:16.04
  Commands:
  - Maintainer: Douglas Tan <bianster@gmail.com>
    Name: maintainer
  - CmdLine:
    - apt-get update -y     && apt-get install -y fluxbox wmctrl xvfb libxrender1
      libxtst6 x11vnc socat unzip software-properties-common unzip supervisor inotify-tools
      iputils-ping     && rm -rf /var/lib/apt/lists/*     && apt-get clean
    Name: run
    PrependShell: true
  - CmdLine:
    - echo oracle-java8-installer shared/accepted-oracle-license-v1-1 select true
      | /usr/bin/debconf-set-selections
    Name: run
    PrependShell: true
  - CmdLine:
    - add-apt-repository -y ppa:webupd8team/java     && apt-get update -y     && apt-get
      install -y oracle-java8-installer ca-certificates
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - https://github.com/bianster/ib-tws-binaries/raw/master/tws/972.1e/tws-latest-standalone-linux-x64.sh
    - tws-standalone-linux-x64.sh
  - CmdLine:
    - chmod +x tws-standalone-linux-x64.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - ./tws-standalone-linux-x64.sh -q
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /opt/ibc && wget https://github.com/IbcAlpha/IBC/releases/download/3.6.0/IBCLinux-3.6.0.zip
      && unzip IBCLinux-3.6.0.zip -d /opt/ibc && chmod -R +x /opt/ibc/*.sh && chmod
      -R +x /opt/ibc/scripts/*.sh && rm IBCLinux-3.6.0.zip
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - bin/update-ibc-config.py
    - /usr/bin/update-ibc-config.py
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - bin/run-ibc
    - /usr/bin/run-ibc
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - bin/run-vnc
    - /usr/bin/run-vnc
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - bin/run-xvfb
    - /usr/bin/run-xvfb
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - bin/run-wm
    - /usr/bin/run-wm
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - bin/run-relay
    - /usr/bin/run-relay
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - bin/run-logger
    - /usr/bin/run-logger
  - CmdLine:
    - mkdir -p /var/log/ib && mkdir -p /root/conf && mkdir -p /root/ibc && mkdir -p
      /tmp/tws
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - conf/supervisord.conf
    - /root/conf/supervisord.conf
  - Env:
    - Key: DISPLAY
      Value: '":0"'
    - Key: VNC_PASSWORD
      Value: '"1234"'
    - Key: TWS_CONF_DIR
      Value: '""'
    - Key: TWS_SYNC_CONF
      Value: '""'
    - Key: IB_LOGIN
      Value: '"edemo"'
    - Key: IB_PASSWORD
      Value: '"demouser"'
    - Key: IB_MODE
      Value: '"paper"'
    - Key: TWS_VERSION
      Value: '"972"'
    - Key: RELAY_PORT
      Value: '"4001"'
    - Key: TWS_PORT
      Value: '"4000"'
    - Key: IB_ACCEPT_CONNECTIONS
      Value: '"manual"'
    Name: env
  - Name: expose
    Ports:
    - "4001"
    - "5900"
    - "7462"
  - Name: volume
    Volumes:
    - /var/log/ib
    - /root/ibc/logs
    - /tmp/tws
  - CmdLine:
    - /usr/bin/supervisord
    - -n
    - -c
    - /root/conf/supervisord.conf
    Name: cmd
    PrependShell: false
  From:
    Image: ubuntu:16.04
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:16.04
