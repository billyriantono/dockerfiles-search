MetaArgs: null
Stages:
- BaseName: ubuntu:18.04
  Commands:
  - Labels:
    - Key: MAINTAINER
      Value: '"Wes Widner <kai5263499@gmail.com>"'
    Name: label
  - Key: GPU_PLATFORM
    Name: arg
    Value: cpu
  - Key: DEEPSPEECH_VERSION
    Name: arg
    Value: 0.6.0
  - Env:
    - Key: CGO_ENABLED
      Value: "1"
    - Key: CGO_CPPFLAGS
      Value: '"-I/usr/include"'
    Name: env
  - Env:
    - Key: GOPATH
      Value: /go
    Name: env
  - Env:
    - Key: PATH
      Value: /go/bin:/usr/local/go/bin:/deepspeech:$PATH
    Name: env
  - Env:
    - Key: CGO_LDFLAGS
      Value: '"-L/deepspeech"'
    Name: env
  - Env:
    - Key: CGO_CXXFLAGS
      Value: '"-I/deepspeech"'
    Name: env
  - Env:
    - Key: LD_LIBRARY_PATH
      Value: /deepspeech:$LD_LIBRARY_PATH
    Name: env
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - /go/src/github.com/kai5263499/diy-jarvis
  - Name: workdir
    Path: /go/src/github.com/kai5263499/diy-jarvis
  - CmdLine:
    - "apt-get update &&     apt-get install -y     git     curl \tunzip \twget \tsox
      \tffmpeg \tpython3-pip \talsa-utils \tpulseaudio \tpulseaudio-utils \tlibsoxr-dev
      \ttzdata     portaudio19-dev"
    Name: run
    PrependShell: true
  - CmdLine:
    - "echo \"Install golang\" && \tcurl -sLO https://dl.google.com/go/go1.13.3.linux-amd64.tar.gz
      && \ttar -xf go1.13.3.linux-amd64.tar.gz && \tmv go /usr/local && \trm -rf go1.13.3.linux-amd64.tar.gz"
    Name: run
    PrependShell: true
  - CmdLine:
    - "echo \"Install deepspeech\" && \tmkdir -p /deepspeech && \tcd /deepspeech &&
      \twget https://github.com/mozilla/DeepSpeech/raw/v${DEEPSPEECH_VERSION}/native_client/deepspeech.h
      && \twget https://github.com/mozilla/DeepSpeech/releases/download/v${DEEPSPEECH_VERSION}/native_client.amd64.${GPU_PLATFORM}.linux.tar.xz
      && \ttar -xvf native_client.amd64.${GPU_PLATFORM}.linux.tar.xz && \trm native_client.amd64.${GPU_PLATFORM}.linux.tar.xz"
    Name: run
    PrependShell: true
  - CmdLine:
    - "echo \"Caching golang modules\" && \tgo mod vendor"
    Name: run
    PrependShell: true
  - CmdLine:
    - "echo \"Install protoc tools\" && \tgo get -u github.com/golang/protobuf/protoc-gen-go
      && \tcurl -sLO https://github.com/google/protobuf/releases/download/v3.7.1/protoc-3.7.1-linux-x86_64.zip
      &&     unzip protoc-3.7.1-linux-x86_64.zip -d protoc3 &&     mv protoc3/bin/*
      /usr/local/bin/ &&     mv protoc3/include/* /usr/local/include/ &&     rm -rf
      protoc3 protoc-3.7.1-linux-x86_64.zip"
    Name: run
    PrependShell: true
  From:
    Image: ubuntu:18.04
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:18.04
