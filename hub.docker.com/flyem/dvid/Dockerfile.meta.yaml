MetaArgs: null
Stages:
- BaseName: ubuntu:12.04
  Commands:
  - Maintainer: Stephen Plaza <plazas@janelia.hhmi.org>
    Name: maintainer
  - Env:
    - Key: GOROOT
      Value: /usr/local/go
    Name: env
  - Env:
    - Key: GOPATH
      Value: $HOME/go
    Name: env
  - Env:
    - Key: DVIDSRC
      Value: $GOPATH/src/github.com/janelia-flyem/dvid
    Name: env
  - Env:
    - Key: BUILDEM_DIR
      Value: $HOME/buildem
    Name: env
  - Env:
    - Key: LD_LIBRARY_PATH
      Value: $BUILDEM_DIR/lib:$LD_LIBRARY_PATH
    Name: env
  - Env:
    - Key: PATH
      Value: /usr/local/go/bin:$BUILDEM_DIR/bin:$PATH
    Name: env
  - Env:
    - Key: DVIDDATA
      Value: /var/dvid
    Name: env
  - Env:
    - Key: CONSOLEVERSION
      Value: 1.11.0
    Name: env
  - Env:
    - Key: DVIDVERSION
      Value: v0.8.1
    Name: env
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./config.toml
    - /var/config.toml
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./configbucket.toml
    - /var/configbucket.toml
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./dvid.sh
    - /usr/local/bin/dvid.sh
  - CmdLine:
    - apt-get -y update && apt-get install -y     git     make     g++     cmake     wget     mercurial     zip
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://storage.googleapis.com/golang/go1.5.linux-amd64.tar.gz && tar -C
      /usr/local -xzf go1.5.linux-amd64.tar.gz
    Name: run
    PrependShell: true
  - CmdLine:
    - wget https://github.com/janelia-flyem/dvid-console/releases/download/v${CONSOLEVERSION}/dvid-console-${CONSOLEVERSION}.tar.gz
      && tar -C /usr/local -xzf dvid-console-${CONSOLEVERSION}.tar.gz
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir $HOME/go; mkdir -p $DVIDSRC;     cd $DVIDSRC; cd ..;     git clone https://github.com/janelia-flyem/dvid;     cd
      $DVIDSRC; git reset --hard be6fadf1d8ea284e84aa414228ba10ea3201efba; mkdir build;
      cd build;     cmake -DDVID_BACKEND="basholeveldb;gbucket" -DBUILDEM_DIR=$BUILDEM_DIR
      ..;     make; cmake -D BUILDEM_DIR=$BUILDEM_DIR ..;     make dvid;     cd $GOPATH/src/google.golang.org/cloud;
      git reset --hard 8bc2457bef5a52c10b0001d481d441141095b130; go install;     cd
      $DVIDSRC/build; make dvid;     chmod +x /usr/local/bin/dvid.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - /usr/local/bin/dvid.sh
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - ""
    Name: cmd
    PrependShell: false
  - Name: expose
    Ports:
    - "8000"
  From:
    Image: ubuntu:12.04
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:12.04
