MetaArgs: null
Stages:
- BaseName: visanalyticskit/vakserver_base:latest
  Commands:
  - Maintainer: visanalyticskit@gmail.com
    Name: maintainer
  - Env:
    - Key: GOPATH
      Value: /opt/go
    Name: env
  - Env:
    - Key: GOROOT
      Value: /usr/local/go
    Name: env
  - Env:
    - Key: PATH
      Value: $PATH:$GOPATH/bin:$GOROOT/bin
    Name: env
  - Env:
    - Key: SGROOT
      Value: /opt/sync_gateway
    Name: env
  - Env:
    - Key: SYNC_CONFIG_FILE
      Value: /opt/sync_gateway/conf/config.json
    Name: env
  - CmdLine:
    - apt-get -q update && DEBIAN_FRONTEND=noninteractive &&         apt-get autoclean
      && apt-get -qy autoremove &&         apt-get install -y bc build-essential &&         apt-get
      clean && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*
    Name: run
    PrependShell: true
  - CmdLine:
    - wget -N -q https://storage.googleapis.com/golang/go1.6.linux-amd64.tar.gz &&   mkdir
      -p $GOPATH &&   tar -C /usr/local -xzf go1.6.linux-amd64.tar.gz && rm go1.6.linux-amd64.tar.gz
    Name: run
    PrependShell: true
  - CmdLine:
    - go get github.com/tools/godep &&     go get github.com/nsf/gocode &&     go
      get golang.org/x/tools/cmd/goimports &&     go get github.com/golang/lint/golint
      &&     go get github.com/rogpeppe/godef
    Name: run
    PrependShell: true
  - CmdLine:
    - cd /opt &&   git clone https://github.com/couchbase/sync_gateway.git  &&   cd
      $SGROOT &&   git checkout release/1.2.1 &&   git submodule update --init --recursive
      &&   ./build.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p $SGROOT/data && mkdir -p $SGROOT/conf
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - scripts/config.json
    - $SYNC_CONFIG_FILE
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - scripts/run
    - /etc/service/sync_gateway/run
  - CmdLine:
    - chmod +x /etc/service/sync_gateway/run
    Name: run
    PrependShell: true
  - CmdLine:
    - /sbin/my_init
    Name: cmd
    PrependShell: false
  - Name: expose
    Ports:
    - "4984"
    - "4985"
  - Name: volume
    Volumes:
    - '"/opt/sync_gateway/conf"'
  From:
    Image: visanalyticskit/vakserver_base:latest
  Name: ""
  Platform: ""
  SourceCode: FROM visanalyticskit/vakserver_base:latest
