MetaArgs: null
Stages:
- BaseName: golang:1.11
  Commands:
  - CmdLine:
    - echo 'deb http://httpredir.debian.org/debian jessie-backports main' > /etc/apt/sources.list.d/backports.list
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update && apt-get install -y     apparmor     autoconf     automake     bison     build-essential     curl     e2fslibs-dev     gawk     gettext     iptables     pkg-config     libaio-dev     libcap-dev     libfuse-dev     libnet-dev     libnl-3-dev     libostree-dev     libprotobuf-dev     libprotobuf-c0-dev     libseccomp2/jessie-backports     libseccomp-dev/jessie-backports     libtool     libudev-dev     protobuf-c-compiler     protobuf-compiler     python-minimal     python-protobuf     libglib2.0-dev     btrfs-tools     libdevmapper1.02.1     libdevmapper-dev     libgpgme11-dev     liblzma-dev     netcat     socat     --no-install-recommends     bsdmainutils     &&
      apt-get clean
    Name: run
    PrependShell: true
  - Env:
    - Key: BATS_COMMIT
      Value: v1.1.0
    Name: env
  - CmdLine:
    - cd /tmp     && git clone https://github.com/bats-core/bats-core.git     && cd
      bats-core     && git checkout -q "$BATS_COMMIT"     && ./install.sh /usr/local
    Name: run
    PrependShell: true
  - Env:
    - Key: CRIU_VERSION
      Value: "3.9"
    Name: env
  - CmdLine:
    - mkdir -p /usr/src/criu     && curl -sSL https://github.com/xemul/criu/archive/v${CRIU_VERSION}.tar.gz
      | tar -v -C /usr/src/criu/ -xz --strip-components=1     && cd /usr/src/criu     &&
      make install-criu     && rm -rf /usr/src/criu
    Name: run
    PrependShell: true
  - Env:
    - Key: RUNC_COMMIT
      Value: 459bfaec1fc6c17d8bfb12d0a0f69e7e7271ed2a
    Name: env
  - CmdLine:
    - "set -x \t&& export GOPATH=\"$(mktemp -d)\" \t&& git clone https://github.com/opencontainers/runc.git
      \"$GOPATH/src/github.com/opencontainers/runc\" \t&& cd \"$GOPATH/src/github.com/opencontainers/runc\"
      \t&& git fetch origin --tags \t&& git checkout -q \"$RUNC_COMMIT\" \t&& make
      static BUILDTAGS=\"seccomp selinux\" \t&& cp runc /usr/bin/runc \t&& rm -rf
      \"$GOPATH\""
    Name: run
    PrependShell: true
  - Env:
    - Key: CNI_COMMIT
      Value: dcf7368eeab15e2affc6256f0bb1e84dd46a34de
    Name: env
  - CmdLine:
    - set -x        && export GOPATH="$(mktemp -d)"        && git clone https://github.com/containernetworking/plugins.git
      "$GOPATH/src/github.com/containernetworking/plugins"        && cd "$GOPATH/src/github.com/containernetworking/plugins"        &&
      git checkout -q "$CNI_COMMIT"        && ./build.sh        && mkdir -p /opt/cni/bin        &&
      cp bin/* /opt/cni/bin/        && rm -rf "$GOPATH"
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - test/cni_plugin_helper.bash
    - /opt/cni/bin/cni_plugin_helper.bash
  - Env:
    - Key: CRICTL_COMMIT
      Value: 98eea54af789ae13edce79cba101fb9ac8e7b241
    Name: env
  - CmdLine:
    - set -x        && export GOPATH="$(mktemp -d)"        && git clone https://github.com/kubernetes-sigs/cri-tools.git
      "$GOPATH/src/github.com/kubernetes-sigs/cri-tools"        && cd "$GOPATH/src/github.com/kubernetes-sigs/cri-tools"        &&
      git checkout -q "$CRICTL_COMMIT"        && go install github.com/kubernetes-sigs/cri-tools/cmd/crictl        &&
      cp "$GOPATH"/bin/crictl /usr/bin/        && rm -rf "$GOPATH"
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /etc/containers
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - test/policy.json
    - /etc/containers/policy.json
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - test/redhat_sigstore.yaml
    - /etc/containers/registries.d/registry.access.redhat.com.yaml
  - Name: workdir
    Path: /go/src/github.com/kubernetes-sigs/cri-o
  - Chown: ""
    Name: add
    SourcesAndDest:
    - .
    - /go/src/github.com/kubernetes-sigs/cri-o
  From:
    Image: golang:1.11
  Name: ""
  Platform: ""
  SourceCode: FROM golang:1.11
