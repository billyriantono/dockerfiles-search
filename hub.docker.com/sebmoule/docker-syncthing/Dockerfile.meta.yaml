MetaArgs: null
Stages:
- BaseName: ubuntu:16.04
  Commands:
  - Maintainer: Sebastien Allamand "sebastien@allamand.com"
    Name: maintainer
  - Env:
    - Key: LANG
      Value: C.UTF-8
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    - Key: DEBCONF_NONINTERACTIVE_SEEN
      Value: "true"
    - Key: SYNCTHING_VERSION
      Value: 0.14.41
    - Key: GOSU_VERSION
      Value: "1.10"
    Name: env
  - CmdLine:
    - set -x     && apt-get update     && apt-get upgrade -y --no-install-recommends     &&
      apt-get install curl wget ca-certificates -y --no-install-recommends     &&
      dpkgArch="$(dpkg --print-architecture | awk -F- '{ print $NF }')"     && wget
      -O /usr/local/bin/gosu "https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch"     &&
      wget -O /usr/local/bin/gosu.asc "https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc"     &&
      export GNUPGHOME="$(mktemp -d)"     && gpg --keyserver ha.pool.sks-keyservers.net
      --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4     && gpg --batch --verify
      /usr/local/bin/gosu.asc /usr/local/bin/gosu     && rm -r "$GNUPGHOME" /usr/local/bin/gosu.asc     &&
      chmod +x /usr/local/bin/gosu     && gosu nobody true     && apt-get purge -y
      --auto-remove -y wget     && apt-get clean
    Name: run
    PrependShell: true
  - Key: VCF_REF
    Name: arg
    Value: null
  - Key: BUILD_DATE
    Name: arg
    Value: null
  - Labels:
    - Key: org.label-schema.docker.dockerfile
      Value: '"/Dockerfile"'
    - Key: org.label-schema.license
      Value: '"MIT"'
    - Key: org.label-schema.name
      Value: '"syncthing"'
    - Key: org.label-schema.url
      Value: '"https://syncthing.net/"'
    - Key: org.label-schema.vcs-type
      Value: '"Git"'
    - Key: org.label-schema.vcs-url
      Value: '"https://github.com/allamand/docker-syncthing"'
    - Key: org.label-schema.build-date
      Value: $BUILD_DATE
    - Key: org.label-schema.vcs-ref
      Value: $VCS_REF
    Name: label
  - Key: MYUSERNAME
    Name: arg
    Value: syncthing
  - Key: MYGROIUPNAME
    Name: arg
    Value: sync
  - Key: MYUID
    Name: arg
    Value: "1000"
  - Key: MYGID
    Name: arg
    Value: "1000"
  - Env:
    - Key: USERNAME
      Value: ${MYUSERNAME}
    - Key: GROUPNAME
      Value: ${MYGROUPNAME}
    - Key: UID
      Value: ${MYUID}
    - Key: GID
      Value: ${MYGID}
    Name: env
  - Name: workdir
    Path: /srv
  - CmdLine:
    - 'echo ''Creating user: ${MYUSERNAME} with UID $UID''     && groupadd -g $GID
      sync     && useradd --uid $UID --no-create-home -g sync $USERNAME'
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -L -o syncthing.tar.gz https://github.com/syncthing/syncthing/releases/download/v$SYNCTHING_VERSION/syncthing-linux-amd64-v$SYNCTHING_VERSION.tar.gz   &&
      tar -xzvf syncthing.tar.gz   && rm -f syncthing.tar.gz   && mv syncthing-linux-amd64-v*
      syncthing   && rm -rf syncthing/etc   && rm -rf syncthing/*.pdf   && mkdir -p
      /srv/config   && mkdir -p /srv/data
    Name: run
    PrependShell: true
  - Name: volume
    Volumes:
    - /srv/data
    - /srv/config
  - Chown: ""
    Name: add
    SourcesAndDest:
    - ./entrypoint.sh
    - /srv/entrypoint.sh
  - CmdLine:
    - chmod 770 /srv/entrypoint.sh && chown -R $USERNAME:$GROUPNAME /srv/
    Name: run
    PrependShell: true
  - CmdLine:
    - /srv/entrypoint.sh
    Name: entrypoint
    PrependShell: false
  From:
    Image: ubuntu:16.04
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:16.04
