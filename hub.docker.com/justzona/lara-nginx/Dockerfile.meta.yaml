MetaArgs: null
Stages:
- BaseName: ubuntu:16.04
  Commands:
  - Labels:
    - Key: Maintainer
      Value: '"Zona Budi InScaled.com"'
    Name: label
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - ln -fs /usr/share/zoneinfo/Asia/Jakarta /etc/localtime
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y tzdata
    Name: run
    PrependShell: true
  - CmdLine:
    - dpkg-reconfigure --frontend noninteractive tzdata
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y wget curl zip unzip software-properties-common locales
    Name: run
    PrependShell: true
  - Env:
    - Key: TERM
      Value: xterm
    Name: env
  - Name: workdir
    Path: /var/www/html
  - CmdLine:
    - LC_ALL=C.UTF-8 add-apt-repository ppa:ondrej/php
    Name: run
    PrependShell: true
  - CmdLine:
    - apt update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y     php7.3     php7.3-fpm     php7.3-pgsql     php7.3-sqlite     php7.3-json     php7.3-curl     php7.3-xml    php7.3-mbstring     php7.3-bcmath     php-redis     php7.3-xdebug     php7.3-zip
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - config/php/www.conf
    - /etc/php/7.3/fpm/pool.d/www.conf
  - CmdLine:
    - apt-key adv --keyserver keyserver.ubuntu.com --recv-keys ABF5BD827BD9BF62
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4F4EA0AAE5267A6C
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "deb http://nginx.org/packages/ubuntu/ trusty nginx" >> /etc/apt/sources.list
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "deb-src http://nginx.org/packages/ubuntu/ trusty nginx" >> /etc/apt/sources.list
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y nginx
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - config/nginx/default
    - /etc/nginx/sites-enabled/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - config/nginx/nginx.conf
    - /etc/nginx/
  - CmdLine:
    - curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin
      --filename=composer
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y supervisor
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /var/log/supervisor
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - config/supervisor/supervisord.conf
    - /etc/supervisor/conf.d/supervisord.conf
  - CmdLine:
    - chown -R www-data:www-data /var/www
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "80"
  - CmdLine:
    - /usr/bin/supervisord
    - -c
    - /etc/supervisor/conf.d/supervisord.conf
    Name: entrypoint
    PrependShell: false
  From:
    Image: ubuntu:16.04
  Name: ""
  Platform: ""
  SourceCode: FROM ubuntu:16.04
