MetaArgs: null
Stages:
- BaseName: debian:buster
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"Meik Minks <mminks@inoxio.de>"'
    Name: label
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - Env:
    - Key: APACHE_RUN_USER
      Value: www-data
    Name: env
  - Env:
    - Key: APACHE_RUN_GROUP
      Value: www-data
    Name: env
  - Env:
    - Key: APACHE_LOG_DIR
      Value: /var/log/apache2
    Name: env
  - Env:
    - Key: TZ
      Value: Europe/Berlin
    Name: env
  - CmdLine:
    - "echo $TZ | tee /etc/timezone     && dpkg-reconfigure --frontend noninteractive
      tzdata     && apt-get update \t\t&& apt-get install -y \t\t  wget \t\t  dialog
      \t\t  php-mbstring \t\t  gnupg \t\t&& wget -q http://www.benno-mailarchiv.de/download/debian/benno.asc
      \t\t&& apt-key add benno.asc \t\t&& echo \"deb http://www.benno-mailarchiv.de/download/debian
      /\" >> /etc/apt/sources.list.d/benno-mailarchive.list \t\t&& rm -Rf benno.asc
      \    && apt-get update \t\t&& apt-get -y install \t\t  apache2 \t\t  php \t\t
      \ php-pear \t\t  smarty3       benno-lib       benno-core       benno-archive
      \      benno-rest-lib       benno-rest       benno-smtp       benno-imap       php-sqlite3
      \      php-curl       smarty3       php-pear       sqlite3       libdbi-perl
      \      libdbd-sqlite3-perl       sqlite3       postfix       libnet-ldap-perl
      \      libdbd-mysql-perl       libcrypt-eksblowfish-perl       libdata-entropy-perl
      \    && echo \"#!/bin/sh\\nexit 0\" > /usr/sbin/policy-rc.d     && cd /tmp &&
      apt-get download benno-web     && dpkg --unpack benno-web_*.deb     && sed -i
      '/invoke-rc.d apache2 force-reload/d' /var/lib/dpkg/info/benno-web.postinst
      \    && dpkg --configure benno-web     && rm -Rf /etc/apache2/conf-available/benno.conf
      /etc/apache2/conf-enabled/benno.conf     && rm -Rf /etc/benno-web/apache-2.2.conf
      /etc/benno-web/apache-2.4.conf     && apt-get autoremove --purge     && apt-get
      autoclean     && rm -rf /var/lib/apt/lists/*"
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - apache2-benno.conf
    - /etc/apache2/sites-available/000-default.conf
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - docker-entrypoint.sh
    - /
  - Name: expose
    Ports:
    - "80"
  - Name: expose
    Ports:
    - "2500"
  - Name: volume
    Volumes:
    - /srv/benno/archive
    - /srv/benno/inbox
    - /var/log/apache2
    - /var/log/benno
  - CmdLine:
    - /docker-entrypoint.sh
    Name: cmd
    PrependShell: true
  From:
    Image: debian:buster
  Name: ""
  Platform: ""
  SourceCode: FROM debian:buster
