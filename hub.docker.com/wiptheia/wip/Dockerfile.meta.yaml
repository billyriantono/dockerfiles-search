MetaArgs: null
Stages:
- BaseName: node:8-alpine
  Commands:
  - CmdLine:
    - 'apk update && apk add --no-cache make gcc g++ python git openssh bash sudo
      shadow &&     rm -rf /tmp/* /var/cache/apk/* &&     echo "%root ALL=(ALL) NOPASSWD:
      ALL" >> /etc/sudoers &&     adduser -S user -h /home/theia -s /bin/bash -G root
      -u 1001 &&     usermod -p "*" user'
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - https://raw.githubusercontent.com/theia-ide/theia-apps/master/theia-full-docker/latest.package.json
    - /home/theia/package.json
  - Chown: ""
    Name: add
    SourcesAndDest:
    - theia-default-package.json
    - /home/default/theia/package.json
  - Chown: ""
    Name: add
    SourcesAndDest:
    - src/add-extensions.js
    - /home/default
  - Chown: ""
    Name: add
    SourcesAndDest:
    - src/main.js
    - /theia_launcher/theia_launcher.js
  - CmdLine:
    - sudo chown -R user /home/theia /home/default
    Name: run
    PrependShell: true
  - Name: user
    User: user
  - Env:
    - Key: HOME
      Value: /home/theia
    Name: env
  - Name: workdir
    Path: /home/theia
  - CmdLine:
    - sed -i -e 's/@theia/@wiptheia/g' /home/theia/package.json &&     sed -i '/@wiptheia\/go/d'
      /home/theia/package.json &&     cat /home/theia/package.json
    Name: run
    PrependShell: true
  - CmdLine:
    - git clone https://github.com/eclipse/che-theia-hosted-plugin-manager-extension
      /tmp/hosted-plugin-extension &&     node /home/default/add-extensions.js     @eclipse-che/che-theia-hosted-plugin-manager-extension:file:///tmp/hosted-plugin-extension     che-theia-ssh-extension:https://github.com/eclipse/che-theia-ssh-plugin.git
      &&     rm /home/default/add-extensions.js &&     cd /home/theia &&     yarn
      &&     yarn theia build &&     rm -rf * &&     cd /home/default/theia &&     yarn
      &&     yarn theia build
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - https://api.github.com/repos/theia-demo-plugins/generator-theia-plugin/git/refs/heads/master
    - /tmp/.sha1
  - CmdLine:
    - sudo npm install -g yo @wiptheia/generator-theia-plugin
    Name: run
    PrependShell: true
  - Name: expose
    Ports:
    - "3000"
  - Key: GITHUB_TOKEN
    Name: arg
    Value: null
  - Env:
    - Key: USE_LOCAL_GIT
      Value: "true"
    - Key: GITHUB_TOKEN
      Value: ${GITHUB_TOKEN}
    Name: env
  - CmdLine:
    - for f in "/home/theia" "/etc/passwd" "/etc/group"; do           sudo chgrp -R
      0 ${f} &&            sudo chmod -R g+rwX ${f};         done &&         cat /etc/passwd
      |         sed s#user:x.*#user:x:\${USER_ID}:\${GROUP_ID}::\${HOME}:/bin/bash#g         >
      /home/theia/passwd.template &&         cat /etc/group |         sed s#root:x:0:#root:x:0:0,\${USER_ID}:#g         >
      /home/theia/group.template
    Name: run
    PrependShell: true
  - CmdLine:
    - node
    - /theia_launcher/theia_launcher.js
    Name: entrypoint
    PrependShell: false
  From:
    Image: node:8-alpine
  Name: ""
  Platform: ""
  SourceCode: FROM node:8-alpine
