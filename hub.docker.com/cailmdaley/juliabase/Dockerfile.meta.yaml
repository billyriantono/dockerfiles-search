MetaArgs: null
Stages:
- BaseName: julia:1.3
  Commands:
  - Env:
    - Key: JULIAVERSION
      Value: "1.3"
    Name: env
  - CmdLine:
    - apt-get update && apt-get install -y --no-install-recommends         ca-certificates         cmake         curl         gcc         git         ffmpeg         gfortran         qt5-default         make         man         ruby         tar         vim         wget     &&
      rm -rf /var/lib/apt/lists/*
    Name: run
    PrependShell: true
  - Env:
    - Key: IMAGEUSER
      Value: imageuser
    Name: env
  - Env:
    - Key: HOME
      Value: /home/$IMAGEUSER
    Name: env
  - CmdLine:
    - adduser --disabled-password --gecos "Default user" $IMAGEUSER     && chown -R
      $IMAGEUSER $HOME
    Name: run
    PrependShell: true
  - Env:
    - Key: SRC
      Value: /src
    Name: env
  - CmdLine:
    - mkdir -p $SRC/bin
    Name: run
    PrependShell: true
  - Env:
    - Key: PATH
      Value: '"$SRC/bin:$PATH"'
    Name: env
  - Chown: "1000"
    From: ""
    Name: copy
    SourcesAndDest:
    - .panrun
    - $SRC/.panrun
  - Chown: "1000"
    From: ""
    Name: copy
    SourcesAndDest:
    - tinytex_packagelist.txt
    - $SRC/.tinytex/
  - CmdLine:
    - wget -qO- "https://yihui.name/gh/tinytex/tools/install-unx.sh" | sh         &&
      $HOME/.TinyTeX/bin/x86_64-linux/tlmgr install $(cat $SRC/.tinytex/tinytex_packagelist.txt)         &&
      mv $HOME/.TinyTeX/* $SRC/.tinytex         && ln -s $SRC/.tinytex/bin/x86_64-linux/*
      $SRC/bin     && wget https://github.com/jgm/pandoc/releases/download/2.7.3/pandoc-2.7.3-1-amd64.deb         &&
      dpkg -i pandoc-2.7.3-1-amd64.deb         && rm pandoc-2.7.3-1-amd64.deb     &&
      ln -s $SRC/.panrun/panrun $SRC/bin/     && rm -rf $HOME/*     && chown -R $IMAGEUSER
      $SRC
    Name: run
    PrependShell: true
  - Name: user
    User: $IMAGEUSER
  - Name: workdir
    Path: $HOME
  - Env:
    - Key: JULIA_DEPOT_PATH
      Value: $SRC/.julia
    Name: env
  - Chown: "1000"
    From: ""
    Name: copy
    SourcesAndDest:
    - Project.toml
    - $JULIA_DEPOT_PATH/environments/v$JULIAVERSION/
  - CmdLine:
    - julia -e 'using Pkg; pkg"instantiate; precompile"'
    Name: run
    PrependShell: true
  From:
    Image: julia:1.3
  Name: ""
  Platform: ""
  SourceCode: FROM julia:1.3
