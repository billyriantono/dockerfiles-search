MetaArgs: null
Stages:
- BaseName: ruby:2.4.1-slim
  Commands:
  - Maintainer: Zammad <info@zammad.org>
    Name: maintainer
  - Key: BUILD_DATE
    Name: arg
    Value: null
  - Env:
    - Key: ZAMMAD_DIR
      Value: /opt/zammad
    Name: env
  - Env:
    - Key: ZAMMAD_TMP_DIR
      Value: /tmp/zammad
    Name: env
  - Env:
    - Key: ZAMMAD_USER
      Value: zammad
    Name: env
  - Env:
    - Key: RAILS_ENV
      Value: production
    Name: env
  - Env:
    - Key: GIT_URL
      Value: https://github.com/zammad/zammad.git
    Name: env
  - Env:
    - Key: GIT_BRANCH
      Value: stable
    Name: env
  - CmdLine:
    - "BUILD_DEPENDENCIES=\"git build-essential libffi-dev libpq5 libpq-dev nginx
      rsync\"     set -ex \t  && apt-get update && apt-get install -y --force-yes
      --no-install-recommends ${BUILD_DEPENDENCIES} && rm -rf /var/lib/apt/lists/*
      \    && useradd -M -d ${ZAMMAD_DIR} -s /bin/bash ${ZAMMAD_USER}     && cd $(dirname
      ${ZAMMAD_TMP_DIR})     && git clone --depth 1 -b \"${GIT_BRANCH}\" \"${GIT_URL}\"
      \    && cd ${ZAMMAD_TMP_DIR}     && bundle install --without test development
      mysql     && contrib/packager.io/fetch_locales.rb     && sed -e 's#.*adapter:
      postgresql#  adapter: nulldb#g' -e 's#.*username:.*#  username: postgres#g'
      -e 's#.*password:.*#  password: \\n  host: zammad-postgresql\\n#g' < config/database.yml.pkgr
      > config/database.yml     && sed -e 's#server_name localhost#server_name _#g'
      -e 's#.*\\(access\\|error\\)_log.*log;##g' < contrib/nginx/zammad.conf > /etc/nginx/sites-enabled/default
      \    && bundle exec rake assets:precompile     && rm -r tmp/cache     && chown
      -R ${ZAMMAD_USER}:${ZAMMAD_USER} ${ZAMMAD_TMP_DIR}"
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - docker-entrypoint.sh
    - /
  - CmdLine:
    - chown ${ZAMMAD_USER}:${ZAMMAD_USER} /docker-entrypoint.sh && chmod +x /docker-entrypoint.sh
    Name: run
    PrependShell: true
  - CmdLine:
    - /docker-entrypoint.sh
    Name: entrypoint
    PrependShell: false
  - CmdLine:
    - zammad
    Name: cmd
    PrependShell: false
  - Name: workdir
    Path: ${ZAMMAD_DIR}
  - Name: volume
    Volumes:
    - ${ZAMMAD_DIR}
  From:
    Image: ruby:2.4.1-slim
  Name: ""
  Platform: ""
  SourceCode: FROM ruby:2.4.1-slim
