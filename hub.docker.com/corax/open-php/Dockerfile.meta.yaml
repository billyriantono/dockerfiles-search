MetaArgs: null
Stages:
- BaseName: php:7.1.3-fpm
  Commands:
  - Maintainer: Dmitry Kuzmin rockwith@me.com
    Name: maintainer
  - CmdLine:
    - "DEBIAN_FRONTEND=noninteractive \tapt-get update;\tapt-get -y install mc;\tapt-get
      -y install software-properties-common"
    Name: run
    PrependShell: true
  - CmdLine:
    - "apt-get update && \tapt-get install -y libldap2-dev && \tdocker-php-ext-configure
      ldap --with-libdir=lib/x86_64-linux-gnu/ && \tdocker-php-ext-install ldap"
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get install -y --no-install-recommends     curl     libmemcached-dev     libz-dev     libjpeg-dev     libpng12-dev     libfreetype6-dev     libssl-dev     libmcrypt-dev
    Name: run
    PrependShell: true
  - CmdLine:
    - "pecl channel-update pecl.php.net &&     docker-php-ext-install mcrypt && \tdocker-php-ext-install
      zip && \tdocker-php-ext-install tokenizer &&   \tdocker-php-ext-install pdo_mysql
      &&   \tdocker-php-ext-configure gd     --enable-gd-native-ttf     --with-jpeg-dir=/usr/lib
      \    --with-freetype-dir=/usr/include/freetype2 &&     docker-php-ext-install
      gd"
    Name: run
    PrependShell: true
  - Key: INSTALL_XDEBUG
    Name: arg
    Value: "false"
  - CmdLine:
    - if [ ${INSTALL_XDEBUG} = true ]; then     pecl install xdebug &&     docker-php-ext-enable
      xdebug ;fi
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "\r\n deb http://ftp.de.debian.org/debian/ sid main" >> /etc/apt/sources.list
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get -y install tdsodbc php7.1-sybase
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get -y install gcc
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get -y install build-essential
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - freetds-patched.tar
    - /temp/
  - CmdLine:
    - "cd /temp/freetds-1.00.27 && \t./configure --enable-msdblib --prefix=/usr/local
      && \tmake -j$(nproc) && \tmake install"
    Name: run
    PrependShell: true
  - CmdLine:
    - 'docker-php-ext-install pdo_dblib #можно и без mssql'
    Name: run
    PrependShell: true
  - CmdLine:
    - sed -i '$ d' /etc/apt/sources.list
    Name: run
    PrependShell: true
  - Chown: ""
    Name: add
    SourcesAndDest:
    - xdebug.ini
    - /usr/local/etc/php/conf.d/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - php.ini
    - /usr/local/etc/php/
  - Chown: ""
    Name: add
    SourcesAndDest:
    - freetds.conf
    - /usr/local/etc
  - CmdLine:
    - php-fpm
    Name: cmd
    PrependShell: false
  - Name: expose
    Ports:
    - "9000"
  From:
    Image: php:7.1.3-fpm
  Name: ""
  Platform: ""
  SourceCode: FROM php:7.1.3-fpm
