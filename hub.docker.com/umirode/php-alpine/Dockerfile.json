{
  "MetaArgs": [
    {
      "Key": "PHP_VERSION",
      "DefaultValue": "7.2",
      "ProvidedValue": null,
      "Value": "7.2"
    }
  ],
  "Stages": [
    {
      "Name": "",
      "BaseName": "php:${PHP_VERSION}-fpm-alpine",
      "SourceCode": "FROM php:${PHP_VERSION}-fpm-alpine",
      "Platform": "",
      "From": {
        "Image": "php:${PHP_VERSION}-fpm-alpine"
      },
      "Commands": [
        {
          "Env": [
            {
              "Key": "PHPREDIS_VERSION",
              "Value": "\"4.1.1\""
            }
          ],
          "Name": "env"
        },
        {
          "Chown": "",
          "Name": "add",
          "SourcesAndDest": [
            "https://github.com/phpredis/phpredis/archive/${PHPREDIS_VERSION}.tar.gz",
            "/tmp/"
          ]
        },
        {
          "Chown": "",
          "Name": "add",
          "SourcesAndDest": [
            "http://downloads3.ioncube.com/loader_downloads/ioncube_loaders_lin_x86-64.tar.gz",
            "/tmp/"
          ]
        },
        {
          "CmdLine": [
            "docker-php-source extract \u0026\u0026         apk update \u0026\u0026 apk upgrade \u0026\u0026         apk add --no-cache --virtual         .build-dependencies         $PHPIZE_DEPS         zlib-dev         cyrus-sasl-dev         git         autoconf         g++         libtool         make         pcre-dev \u0026\u0026         apk add --no-cache         tini         libintl         icu         icu-dev         libxml2-dev         postgresql-dev         freetype-dev         libjpeg-turbo-dev         libpng-dev         gmp         gmp-dev         libmemcached-dev         imagemagick-dev         libssh2         libssh2-dev         libxslt-dev \u0026\u0026         tar xfz /tmp/${PHPREDIS_VERSION}.tar.gz \u0026\u0026     mv phpredis-$PHPREDIS_VERSION /usr/src/php/ext/redis \u0026\u0026         git clone https://github.com/php-memcached-dev/php-memcached.git /usr/src/php/ext/memcached/ \u0026\u0026         docker-php-ext-configure memcached \u0026\u0026         docker-php-ext-configure gd         --with-freetype-dir=/usr/include/         --with-jpeg-dir=/usr/include/ \u0026\u0026         docker-php-ext-install -j\"$(getconf _NPROCESSORS_ONLN)\"         intl         bcmath         xsl         zip         soap         mysqli         pdo         pdo_mysql         pdo_pgsql         gmp         redis         iconv         gd         memcached \u0026\u0026         tar -xvzf /tmp/ioncube_loaders_lin_x86-64.tar.gz -C /tmp/ \u0026\u0026         mkdir -p /usr/local/php/ext/ioncube \u0026\u0026         cp  /tmp/ioncube/ioncube_loader_lin_${PHP_VERSION%.*}.so /usr/local/php/ext/ioncube/ioncube_loader.so \u0026\u0026         docker-php-ext-configure opcache --enable-opcache \u0026\u0026         docker-php-ext-install opcache \u0026\u0026         pecl install         apcu         imagick         ssh2-1 \u0026\u0026         docker-php-ext-enable         apcu         imagick         ssh2 \u0026\u0026         sed -i -e 's/listen.*/listen = 0.0.0.0:9000/' /usr/local/etc/php-fpm.conf \u0026\u0026         echo \"expose_php=0\" \u003e /usr/local/etc/php/php.ini \u0026\u0026         apk del .build-dependencies \u0026\u0026         docker-php-source delete \u0026\u0026         rm -rf /tmp/* /var/cache/apk/*"
          ],
          "Name": "run",
          "PrependShell": true
        },
        {
          "Chown": "",
          "From": "",
          "Name": "copy",
          "SourcesAndDest": [
            "conf.d/*",
            "/usr/local/etc/php/conf.d/"
          ]
        },
        {
          "CmdLine": [
            "php-fpm"
          ],
          "Name": "cmd",
          "PrependShell": false
        }
      ]
    }
  ]
}