MetaArgs: null
Stages:
- BaseName: krallin/ubuntu-tini:14.04
  Commands:
  - Labels:
    - Key: maintainer
      Value: '"seti@setadesign.net"'
    Name: label
  - Env:
    - Key: DEBIAN_FRONTEND
      Value: noninteractive
    Name: env
  - Env:
    - Key: AUTOMX_VERSION
      Value: 1.1.2
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - assets/init.sh
    - /init.sh
  - CmdLine:
    - "apt-get update && \tapt-get dist-upgrade -y && \tapt-get install -y wget apache2
      libapache2-mod-wsgi-py3 python3-dateutil python-ipaddr openssl python3-lxml
      bsdmainutils dnsutils && \tmkdir -p /usr/lib/automx && \ta2enmod wsgi && a2dissite
      000-default && \twget https://github.com/sys4/automx/archive/v$AUTOMX_VERSION.tar.gz
      && \ttar -xf v$AUTOMX_VERSION.tar.gz && \tcp automx-$AUTOMX_VERSION/src/automx_wsgi.py
      /usr/lib/automx/ && \tcp -r automx-$AUTOMX_VERSION/src/automx /usr/lib/python3.4/
      && \tcp automx-$AUTOMX_VERSION/src/automx-test /usr/bin/automx-test && \trm
      -f /var/www/html/index.html && \tcp -r automx-$AUTOMX_VERSION/src/html /var/www/
      && \tmv /var/www/html/index.html.en /var/www/html/index.html && \tapt-get clean
      && \trm -rf automx-$AUTOMX_VERSION v$AUTOMX_VERSION.tar.gz \t\t/var/lib/apt/lists/*
      /tmp/* /var/tmp/* && \tchmod 0755 /init.sh"
    Name: run
    PrependShell: true
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - assets/automx.conf
    - /etc/automx.conf
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - assets/vhost.conf
    - /etc/apache2/sites-enabled/automx.conf
  - Name: expose
    Ports:
    - "80"
  - CmdLine:
    - /init.sh
    Name: cmd
    PrependShell: true
  From:
    Image: krallin/ubuntu-tini:14.04
  Name: ""
  Platform: ""
  SourceCode: FROM krallin/ubuntu-tini:14.04
