MetaArgs: null
Stages:
- BaseName: debian:stretch
  Commands:
  - CmdLine:
    - sed -i 's/deb.debian.org/mirrors.kernel.org/g' /etc/apt/sources.list
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update -qq && apt-get install -qy   curl   gnupg2   texlive-full
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -sL https://deb.nodesource.com/setup_8.x | bash -
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add -
    Name: run
    PrependShell: true
  - CmdLine:
    - echo "deb https://dl.yarnpkg.com/debian/ stable main" | tee /etc/apt/sources.list.d/yarn.list
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update -qq && apt-get install -qy   ca-certificates   curl   nodejs   git-core   gnupg2   python   python-pip   yarn
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update -qq && apt-get install -qy   libarchive-zip-perl libfile-which-perl
      libimage-size-perl    libio-string-perl libjson-xs-perl libtext-unidecode-perl   libparse-recdescent-perl
      liburi-perl libuuid-tiny-perl libwww-perl   libxml2 libxml-libxml-perl libxslt1.1
      libxml-libxslt-perl    imagemagick libimage-magick-perl perl-doc
    Name: run
    PrependShell: true
  - CmdLine:
    - groupadd -r engrafo && useradd -r -g engrafo -G audio,video engrafo     && mkdir
      -p /home/engrafo/Downloads     && chown -R engrafo:engrafo /home/engrafo
    Name: run
    PrependShell: true
  - CmdLine:
    - apt-get update && apt-get install -yq libgconf-2-4
    Name: run
    PrependShell: true
  - CmdLine:
    - curl -sSL https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add
      -     && sh -c 'echo "deb [arch=amd64] http://dl.google.com/linux/chrome/deb/
      stable main" >> /etc/apt/sources.list.d/google.list'     && apt-get update -qq     &&
      apt-get install -yq google-chrome-unstable fonts-ipafont-gothic fonts-wqy-zenhei
      fonts-thai-tlwg fonts-kacst ttf-freefont --no-install-recommends     && rm -rf
      /var/lib/apt/lists/*     && rm -rf /src/*.deb
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /usr/src/latexml
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /usr/src/latexml
  - Env:
    - Key: LATEXML_COMMIT
      Value: d33e9a32d18407fa9488857d4100b532b1548884
    Name: env
  - CmdLine:
    - curl -L https://github.com/brucemiller/LaTeXML/tarball/$LATEXML_COMMIT | tar
      --strip-components 1 -zxf -
    Name: run
    PrependShell: true
  - CmdLine:
    - perl Makefile.PL; make; make install
    Name: run
    PrependShell: true
  - CmdLine:
    - mkdir -p /app
    Name: run
    PrependShell: true
  - CmdLine:
    - chown engrafo:engrafo /app
    Name: run
    PrependShell: true
  - Name: workdir
    Path: /app
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - server/requirements.txt
    - /app/server/
  - CmdLine:
    - pip install -r server/requirements.txt
    Name: run
    PrependShell: true
  - Name: user
    User: engrafo
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - package.json
    - yarn.lock
    - /app/
  - CmdLine:
    - yarn
    Name: run
    PrependShell: true
  - Env:
    - Key: PYTHONUNBUFFERED
      Value: "1"
    Name: env
  - Env:
    - Key: PATH
      Value: '"/app/bin:${PATH}"'
    Name: env
  - Chown: ""
    From: ""
    Name: copy
    SourcesAndDest:
    - .
    - /app
  From:
    Image: debian:stretch
  Name: ""
  Platform: ""
  SourceCode: FROM debian:stretch
